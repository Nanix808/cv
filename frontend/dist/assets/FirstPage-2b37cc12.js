var Ui=Object.defineProperty;var ji=(bt,d,nt)=>d in bt?Ui(bt,d,{enumerable:!0,configurable:!0,writable:!0,value:nt}):bt[d]=nt;var Yt=(bt,d,nt)=>(ji(bt,typeof d!="symbol"?d+"":d,nt),nt),Te=(bt,d,nt)=>{if(!d.has(bt))throw TypeError("Cannot "+nt)};var t=(bt,d,nt)=>(Te(bt,d,"read from private field"),nt?nt.call(bt):d.get(bt)),W=(bt,d,nt)=>{if(d.has(bt))throw TypeError("Cannot add the same private member more than once");d instanceof WeakSet?d.add(bt):d.set(bt,nt)},rt=(bt,d,nt,c)=>(Te(bt,d,"write to private field"),c?c.call(bt,nt):d.set(bt,nt),nt),ie=(bt,d,nt,c)=>({set _(x){rt(bt,d,x,nt)},get _(){return t(bt,d,c)}}),Q=(bt,d,nt)=>(Te(bt,d,"access private method"),nt);import{_ as _export_sfc,u as useStore,r as ref,c as computed,o as openBlock,a as createElementBlock,b as createCommentVNode,d as createBaseVNode,e as createTextVNode,t as toDisplayString,w as withDirectives,v as vShow,n as normalizeClass,f as useRouter,g as resolveComponent,h as createVNode,i as withCtx}from"./index-f182a6e6.js";import{g as getAugmentedNamespace,T as TableWithStore,V as VuePdfEmbed}from"./Table_with_store-be3ccd4a.js";import{B as ButtonNextPrev}from"./ButtonNextPrev-605fa937.js";function commonjsRequire(bt){throw new Error('Could not dynamically require "'+bt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(d,nt){module.exports=nt()})(globalThis,()=>(()=>{var __webpack_modules__=[,(bt,d)=>{var Ut;Object.defineProperty(d,"__esModule",{value:!0}),d.VerbosityLevel=d.Util=d.UnknownErrorException=d.UnexpectedResponseException=d.TextRenderingMode=d.RenderingIntentFlag=d.PromiseCapability=d.PermissionFlag=d.PasswordResponses=d.PasswordException=d.PageActionEventType=d.OPS=d.MissingPDFException=d.MAX_IMAGE_SIZE_TO_CACHE=d.LINE_FACTOR=d.LINE_DESCENT_FACTOR=d.InvalidPDFException=d.ImageKind=d.IDENTITY_MATRIX=d.FormatError=d.FeatureTest=d.FONT_IDENTITY_MATRIX=d.DocumentActionEventType=d.CMapCompressionType=d.BaseException=d.BASELINE_FACTOR=d.AnnotationType=d.AnnotationReplyType=d.AnnotationMode=d.AnnotationFlag=d.AnnotationFieldFlag=d.AnnotationEditorType=d.AnnotationEditorPrefix=d.AnnotationEditorParamsType=d.AnnotationBorderStyleType=d.AnnotationActionEventType=d.AbortException=void 0,d.assert=$,d.bytesToString=Y,d.createValidAbsoluteUrl=pt,d.getModificationDate=Ft,d.getUuid=Wt,d.getVerbosityLevel=_,d.info=G,d.isArrayBuffer=gt,d.isArrayEqual=yt,d.isNodeJS=void 0,d.normalizeUnicode=Xt,d.objectFromMap=ft,d.objectSize=ht,d.setVerbosityLevel=V,d.shadow=_t,d.string32=at,d.stringToBytes=dt,d.stringToPDFString=vt,d.stringToUTF8String=st,d.unreachable=k,d.utf8StringToString=tt,d.warn=M;const nt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");d.isNodeJS=nt;const c=[1,0,0,1,0,0];d.IDENTITY_MATRIX=c;const x=[.001,0,0,.001,0,0];d.FONT_IDENTITY_MATRIX=x;const et=1e7;d.MAX_IMAGE_SIZE_TO_CACHE=et;const J=1.35;d.LINE_FACTOR=J;const lt=.35;d.LINE_DESCENT_FACTOR=lt;const j=lt/J;d.BASELINE_FACTOR=j;const R={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};d.RenderingIntentFlag=R;const p={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};d.AnnotationMode=p;const L="pdfjs_internal_editor_";d.AnnotationEditorPrefix=L;const B={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};d.AnnotationEditorType=B;const w={RESIZE:1,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};d.AnnotationEditorParamsType=w;const y={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};d.PermissionFlag=y;const A={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};d.TextRenderingMode=A;const f={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};d.ImageKind=f;const v={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};d.AnnotationType=v;const E={GROUP:"Group",REPLY:"R"};d.AnnotationReplyType=E;const P={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};d.AnnotationFlag=P;const g={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};d.AnnotationFieldFlag=g;const n={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};d.AnnotationBorderStyleType=n;const o={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};d.AnnotationActionEventType=o;const F={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};d.DocumentActionEventType=F;const b={O:"PageOpen",C:"PageClose"};d.PageActionEventType=b;const s={ERRORS:0,WARNINGS:1,INFOS:5};d.VerbosityLevel=s;const l={NONE:0,BINARY:1};d.CMapCompressionType=l;const r={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};d.OPS=r;const I={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};d.PasswordResponses=I;let O=s.WARNINGS;function V(ct){Number.isInteger(ct)&&(O=ct)}function _(){return O}function G(ct){O>=s.INFOS&&console.log(`Info: ${ct}`)}function M(ct){O>=s.WARNINGS&&console.log(`Warning: ${ct}`)}function k(ct){throw new Error(ct)}function $(ct,q){ct||k(q)}function it(ct){switch(ct==null?void 0:ct.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function pt(ct,q=null,K=null){if(!ct)return null;try{if(K&&typeof ct=="string"){if(K.addDefaultProtocol&&ct.startsWith("www.")){const jt=ct.match(/\./g);(jt==null?void 0:jt.length)>=2&&(ct=`http://${ct}`)}if(K.tryConvertEncoding)try{ct=st(ct)}catch{}}const wt=q?new URL(ct,q):new URL(ct);if(it(wt))return wt}catch{}return null}function _t(ct,q,K,wt=!1){return Object.defineProperty(ct,q,{value:K,enumerable:!wt,configurable:!0,writable:!1}),K}const D=function(){function q(K,wt){this.constructor===q&&k("Cannot initialize BaseException."),this.message=K,this.name=wt}return q.prototype=new Error,q.constructor=q,q}();d.BaseException=D;class i extends D{constructor(q,K){super(q,"PasswordException"),this.code=K}}d.PasswordException=i;class e extends D{constructor(q,K){super(q,"UnknownErrorException"),this.details=K}}d.UnknownErrorException=e;class m extends D{constructor(q){super(q,"InvalidPDFException")}}d.InvalidPDFException=m;class N extends D{constructor(q){super(q,"MissingPDFException")}}d.MissingPDFException=N;class T extends D{constructor(q,K){super(q,"UnexpectedResponseException"),this.status=K}}d.UnexpectedResponseException=T;class H extends D{constructor(q){super(q,"FormatError")}}d.FormatError=H;class z extends D{constructor(q){super(q,"AbortException")}}d.AbortException=z;function Y(ct){(typeof ct!="object"||(ct==null?void 0:ct.length)===void 0)&&k("Invalid argument for bytesToString");const q=ct.length,K=8192;if(q<K)return String.fromCharCode.apply(null,ct);const wt=[];for(let jt=0;jt<q;jt+=K){const Lt=Math.min(jt+K,q),$t=ct.subarray(jt,Lt);wt.push(String.fromCharCode.apply(null,$t))}return wt.join("")}function dt(ct){typeof ct!="string"&&k("Invalid argument for stringToBytes");const q=ct.length,K=new Uint8Array(q);for(let wt=0;wt<q;++wt)K[wt]=ct.charCodeAt(wt)&255;return K}function at(ct){return String.fromCharCode(ct>>24&255,ct>>16&255,ct>>8&255,ct&255)}function ht(ct){return Object.keys(ct).length}function ft(ct){const q=Object.create(null);for(const[K,wt]of ct)q[K]=wt;return q}function Ct(){const ct=new Uint8Array(4);return ct[0]=1,new Uint32Array(ct.buffer,0,1)[0]===1}function At(){try{return new Function(""),!0}catch{return!1}}class Rt{static get isLittleEndian(){return _t(this,"isLittleEndian",Ct())}static get isEvalSupported(){return _t(this,"isEvalSupported",At())}static get isOffscreenCanvasSupported(){return _t(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?_t(this,"platform",{isWin:!1,isMac:!1}):_t(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}d.FeatureTest=Rt;const Ht=[...Array(256).keys()].map(ct=>ct.toString(16).padStart(2,"0"));class St{static makeHexColor(q,K,wt){return`#${Ht[q]}${Ht[K]}${Ht[wt]}`}static scaleMinMax(q,K){let wt;q[0]?(q[0]<0&&(wt=K[0],K[0]=K[1],K[1]=wt),K[0]*=q[0],K[1]*=q[0],q[3]<0&&(wt=K[2],K[2]=K[3],K[3]=wt),K[2]*=q[3],K[3]*=q[3]):(wt=K[0],K[0]=K[2],K[2]=wt,wt=K[1],K[1]=K[3],K[3]=wt,q[1]<0&&(wt=K[2],K[2]=K[3],K[3]=wt),K[2]*=q[1],K[3]*=q[1],q[2]<0&&(wt=K[0],K[0]=K[1],K[1]=wt),K[0]*=q[2],K[1]*=q[2]),K[0]+=q[4],K[1]+=q[4],K[2]+=q[5],K[3]+=q[5]}static transform(q,K){return[q[0]*K[0]+q[2]*K[1],q[1]*K[0]+q[3]*K[1],q[0]*K[2]+q[2]*K[3],q[1]*K[2]+q[3]*K[3],q[0]*K[4]+q[2]*K[5]+q[4],q[1]*K[4]+q[3]*K[5]+q[5]]}static applyTransform(q,K){const wt=q[0]*K[0]+q[1]*K[2]+K[4],jt=q[0]*K[1]+q[1]*K[3]+K[5];return[wt,jt]}static applyInverseTransform(q,K){const wt=K[0]*K[3]-K[1]*K[2],jt=(q[0]*K[3]-q[1]*K[2]+K[2]*K[5]-K[4]*K[3])/wt,Lt=(-q[0]*K[1]+q[1]*K[0]+K[4]*K[1]-K[5]*K[0])/wt;return[jt,Lt]}static getAxialAlignedBoundingBox(q,K){const wt=this.applyTransform(q,K),jt=this.applyTransform(q.slice(2,4),K),Lt=this.applyTransform([q[0],q[3]],K),$t=this.applyTransform([q[2],q[1]],K);return[Math.min(wt[0],jt[0],Lt[0],$t[0]),Math.min(wt[1],jt[1],Lt[1],$t[1]),Math.max(wt[0],jt[0],Lt[0],$t[0]),Math.max(wt[1],jt[1],Lt[1],$t[1])]}static inverseTransform(q){const K=q[0]*q[3]-q[1]*q[2];return[q[3]/K,-q[1]/K,-q[2]/K,q[0]/K,(q[2]*q[5]-q[4]*q[3])/K,(q[4]*q[1]-q[5]*q[0])/K]}static singularValueDecompose2dScale(q){const K=[q[0],q[2],q[1],q[3]],wt=q[0]*K[0]+q[1]*K[2],jt=q[0]*K[1]+q[1]*K[3],Lt=q[2]*K[0]+q[3]*K[2],$t=q[2]*K[1]+q[3]*K[3],Kt=(wt+$t)/2,h=Math.sqrt((wt+$t)**2-4*(wt*$t-Lt*jt))/2,X=Kt+h||1,ut=Kt-h||1;return[Math.sqrt(X),Math.sqrt(ut)]}static normalizeRect(q){const K=q.slice(0);return q[0]>q[2]&&(K[0]=q[2],K[2]=q[0]),q[1]>q[3]&&(K[1]=q[3],K[3]=q[1]),K}static intersect(q,K){const wt=Math.max(Math.min(q[0],q[2]),Math.min(K[0],K[2])),jt=Math.min(Math.max(q[0],q[2]),Math.max(K[0],K[2]));if(wt>jt)return null;const Lt=Math.max(Math.min(q[1],q[3]),Math.min(K[1],K[3])),$t=Math.min(Math.max(q[1],q[3]),Math.max(K[1],K[3]));return Lt>$t?null:[wt,Lt,jt,$t]}static bezierBoundingBox(q,K,wt,jt,Lt,$t,Kt,h){const X=[],ut=[[],[]];let ot,u,a,C,S,U,Z,mt;for(let Ot=0;Ot<2;++Ot){if(Ot===0?(u=6*q-12*wt+6*Lt,ot=-3*q+9*wt-9*Lt+3*Kt,a=3*wt-3*q):(u=6*K-12*jt+6*$t,ot=-3*K+9*jt-9*$t+3*h,a=3*jt-3*K),Math.abs(ot)<1e-12){if(Math.abs(u)<1e-12)continue;C=-a/u,0<C&&C<1&&X.push(C);continue}Z=u*u-4*a*ot,mt=Math.sqrt(Z),!(Z<0)&&(S=(-u+mt)/(2*ot),0<S&&S<1&&X.push(S),U=(-u-mt)/(2*ot),0<U&&U<1&&X.push(U))}let Pt=X.length,kt;const Et=Pt;for(;Pt--;)C=X[Pt],kt=1-C,ut[0][Pt]=kt*kt*kt*q+3*kt*kt*C*wt+3*kt*C*C*Lt+C*C*C*Kt,ut[1][Pt]=kt*kt*kt*K+3*kt*kt*C*jt+3*kt*C*C*$t+C*C*C*h;return ut[0][Et]=q,ut[1][Et]=K,ut[0][Et+1]=Kt,ut[1][Et+1]=h,ut[0].length=ut[1].length=Et+2,[Math.min(...ut[0]),Math.min(...ut[1]),Math.max(...ut[0]),Math.max(...ut[1])]}}d.Util=St;const Nt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function vt(ct){if(ct[0]>="ï"){let K;if(ct[0]==="þ"&&ct[1]==="ÿ"?K="utf-16be":ct[0]==="ÿ"&&ct[1]==="þ"?K="utf-16le":ct[0]==="ï"&&ct[1]==="»"&&ct[2]==="¿"&&(K="utf-8"),K)try{const wt=new TextDecoder(K,{fatal:!0}),jt=dt(ct);return wt.decode(jt)}catch(wt){M(`stringToPDFString: "${wt}".`)}}const q=[];for(let K=0,wt=ct.length;K<wt;K++){const jt=Nt[ct.charCodeAt(K)];q.push(jt?String.fromCharCode(jt):ct.charAt(K))}return q.join("")}function st(ct){return decodeURIComponent(escape(ct))}function tt(ct){return unescape(encodeURIComponent(ct))}function gt(ct){return typeof ct=="object"&&(ct==null?void 0:ct.byteLength)!==void 0}function yt(ct,q){if(ct.length!==q.length)return!1;for(let K=0,wt=ct.length;K<wt;K++)if(ct[K]!==q[K])return!1;return!0}function Ft(ct=new Date){return[ct.getUTCFullYear().toString(),(ct.getUTCMonth()+1).toString().padStart(2,"0"),ct.getUTCDate().toString().padStart(2,"0"),ct.getUTCHours().toString().padStart(2,"0"),ct.getUTCMinutes().toString().padStart(2,"0"),ct.getUTCSeconds().toString().padStart(2,"0")].join("")}class Mt{constructor(){W(this,Ut,!1);this.promise=new Promise((q,K)=>{this.resolve=wt=>{rt(this,Ut,!0),q(wt)},this.reject=wt=>{rt(this,Ut,!0),K(wt)}})}get settled(){return t(this,Ut)}}Ut=new WeakMap,d.PromiseCapability=Mt;let zt=null,It=null;function Xt(ct){return zt||(zt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,It=new Map([["ﬅ","ſt"]])),ct.replaceAll(zt,(q,K,wt)=>K?K.normalize("NFKC"):It.get(wt))}function Wt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ct=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ct);else for(let q=0;q<32;q++)ct[q]=Math.floor(Math.random()*255);return Y(ct)}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var bt,nt,c,x,ae,J,be,j,R,p,L,B,w,y,A,f,xe,E,P,Pe,n,o;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(b){if(typeof b=="string"||b instanceof URL?b={url:b}:(0,_util.isArrayBuffer)(b)&&(b={data:b}),typeof b!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!b.url&&!b.data&&!b.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const s=new PDFDocumentLoadingTask,{docId:l}=s,r=b.url?getUrlProp(b.url):null,I=b.data?getDataProp(b.data):null,O=b.httpHeaders||null,V=b.withCredentials===!0,_=b.password??null,G=b.range instanceof PDFDataRangeTransport?b.range:null,M=Number.isInteger(b.rangeChunkSize)&&b.rangeChunkSize>0?b.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let k=b.worker instanceof PDFWorker?b.worker:null;const $=b.verbosity,it=typeof b.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(b.docBaseUrl)?b.docBaseUrl:null,pt=typeof b.cMapUrl=="string"?b.cMapUrl:null,_t=b.cMapPacked!==!1,D=b.CMapReaderFactory||DefaultCMapReaderFactory,i=typeof b.standardFontDataUrl=="string"?b.standardFontDataUrl:null,e=b.StandardFontDataFactory||DefaultStandardFontDataFactory,m=b.stopAtErrors!==!0,N=Number.isInteger(b.maxImageSize)&&b.maxImageSize>-1?b.maxImageSize:-1,T=b.isEvalSupported!==!1,H=typeof b.isOffscreenCanvasSupported=="boolean"?b.isOffscreenCanvasSupported:!_util.isNodeJS,z=Number.isInteger(b.canvasMaxAreaInBytes)?b.canvasMaxAreaInBytes:-1,Y=typeof b.disableFontFace=="boolean"?b.disableFontFace:_util.isNodeJS,dt=b.fontExtraProperties===!0,at=b.enableXfa===!0,ht=b.ownerDocument||globalThis.document,ft=b.disableRange===!0,Ct=b.disableStream===!0,At=b.disableAutoFetch===!0,Rt=b.pdfBug===!0,Ht=G?G.length:b.length??NaN,St=typeof b.useSystemFonts=="boolean"?b.useSystemFonts:!_util.isNodeJS&&!Y,Nt=typeof b.useWorkerFetch=="boolean"?b.useWorkerFetch:D===_display_utils.DOMCMapReaderFactory&&e===_display_utils.DOMStandardFontDataFactory&&pt&&i&&(0,_display_utils.isValidFetchUrl)(pt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(i,document.baseURI),vt=b.canvasFactory||new DefaultCanvasFactory({ownerDocument:ht}),st=b.filterFactory||new DefaultFilterFactory({docId:l,ownerDocument:ht}),tt=null;(0,_util.setVerbosityLevel)($);const gt={canvasFactory:vt,filterFactory:st};if(Nt||(gt.cMapReaderFactory=new D({baseUrl:pt,isCompressed:_t}),gt.standardFontDataFactory=new e({baseUrl:i})),!k){const Mt={verbosity:$,port:_worker_options.GlobalWorkerOptions.workerPort};k=Mt.port?PDFWorker.fromPort(Mt):new PDFWorker(Mt),s._worker=k}const yt={docId:l,apiVersion:"3.9.179",data:I,password:_,disableAutoFetch:At,rangeChunkSize:M,length:Ht,docBaseUrl:it,enableXfa:at,evaluatorOptions:{maxImageSize:N,disableFontFace:Y,ignoreErrors:m,isEvalSupported:T,isOffscreenCanvasSupported:H,canvasMaxAreaInBytes:z,fontExtraProperties:dt,useSystemFonts:St,cMapUrl:Nt?pt:null,standardFontDataUrl:Nt?i:null}},Ft={ignoreErrors:m,isEvalSupported:T,disableFontFace:Y,fontExtraProperties:dt,enableXfa:at,ownerDocument:ht,disableAutoFetch:At,pdfBug:Rt,styleElement:tt};return k.promise.then(function(){if(s.destroyed)throw new Error("Loading aborted");const Mt=_fetchDocument(k,yt),zt=new Promise(function(It){let Xt;G?Xt=new _transport_stream.PDFDataTransportStream({length:Ht,initialData:G.initialData,progressiveDone:G.progressiveDone,contentDispositionFilename:G.contentDispositionFilename,disableRange:ft,disableStream:Ct},G):I||(Xt=(Ut=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Ut):(0,_display_utils.isValidFetchUrl)(Ut.url)?new _displayFetch_stream.PDFFetchStream(Ut):new _displayNetwork.PDFNetworkStream(Ut))({url:r,length:Ht,httpHeaders:O,withCredentials:V,rangeChunkSize:M,disableRange:ft,disableStream:Ct})),It(Xt)});return Promise.all([Mt,zt]).then(function([It,Xt]){if(s.destroyed)throw new Error("Loading aborted");const Wt=new _message_handler.MessageHandler(l,It,k.port),Ut=new WorkerTransport(Wt,s,Xt,Ft,gt);s._transport=Ut,Wt.send("Ready",null)})}).catch(s._capability.reject),s}async function _fetchDocument(b,s){if(b.destroyed)throw new Error("Worker was destroyed");const l=await b.messageHandler.sendWithPromise("GetDocRequest",s,s.data?[s.data.buffer]:null);if(b.destroyed)throw new Error("Worker was destroyed");return l}function getUrlProp(b){if(b instanceof URL)return b.href;try{return new URL(b,window.location).href}catch{if(_util.isNodeJS&&typeof b=="string")return b}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(b){if(_util.isNodeJS&&typeof Buffer<"u"&&b instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(b instanceof Uint8Array&&b.byteLength===b.buffer.byteLength)return b;if(typeof b=="string")return(0,_util.stringToBytes)(b);if(typeof b=="object"&&!isNaN(b==null?void 0:b.length)||(0,_util.isArrayBuffer)(b))return new Uint8Array(b);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const d=class{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ie(d,bt)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var s;this.destroyed=!0,await((s=this._transport)==null?void 0:s.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=d;bt=new WeakMap,W(PDFDocumentLoadingTask,bt,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(s,l,r=!1,I=null){this.length=s,this.initialData=l,this.progressiveDone=r,this.contentDispositionFilename=I,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(s){this._rangeListeners.push(s)}addProgressListener(s){this._progressListeners.push(s)}addProgressiveReadListener(s){this._progressiveReadListeners.push(s)}addProgressiveDoneListener(s){this._progressiveDoneListeners.push(s)}onDataRange(s,l){for(const r of this._rangeListeners)r(s,l)}onDataProgress(s,l){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(s,l)})}onDataProgressiveRead(s){this._readyCapability.promise.then(()=>{for(const l of this._progressiveReadListeners)l(s)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const s of this._progressiveDoneListeners)s()})}transportReady(){this._readyCapability.resolve()}requestDataRange(s,l){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(s,l){this._pdfInfo=s,this._transport=l}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(s){return this._transport.getPage(s)}getPageIndex(s){return this._transport.getPageIndex(s)}getDestinations(){return this._transport.getDestinations()}getDestination(s){return this._transport.getDestination(s)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(s=!1){return this._transport.startCleanup(s||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(s,l,r,I=!1){W(this,x);W(this,J);W(this,nt,null);W(this,c,!1);this._pageIndex=s,this._pageInfo=l,this._transport=r,this._stats=I?new _display_utils.StatTimer:null,this._pdfBug=I,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:s,rotation:l=this.rotate,offsetX:r=0,offsetY:I=0,dontFlip:O=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:s,rotation:l,offsetX:r,offsetY:I,dontFlip:O})}getAnnotations({intent:s="display"}={}){const l=this._transport.getRenderingIntent(s);return this._transport.getAnnotations(this._pageIndex,l.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var s;return((s=this._transport._htmlForXfa)==null?void 0:s.children[this._pageIndex])||null}render({canvasContext:s,viewport:l,intent:r="display",annotationMode:I=_util.AnnotationMode.ENABLE,transform:O=null,background:V=null,optionalContentConfigPromise:_=null,annotationCanvasMap:G=null,pageColors:M=null,printAnnotationStorage:k=null}){var e,m;(e=this._stats)==null||e.time("Overall");const $=this._transport.getRenderingIntent(r,I,k);rt(this,c,!1),Q(this,J,be).call(this),_||(_=this._transport.getOptionalContentConfig());let it=this._intentStates.get($.cacheKey);it||(it=Object.create(null),this._intentStates.set($.cacheKey,it)),it.streamReaderCancelTimeout&&(clearTimeout(it.streamReaderCancelTimeout),it.streamReaderCancelTimeout=null);const pt=!!($.renderingIntent&_util.RenderingIntentFlag.PRINT);it.displayReadyCapability||(it.displayReadyCapability=new _util.PromiseCapability,it.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(m=this._stats)==null||m.time("Page Request"),this._pumpOperatorList($));const _t=N=>{var T,H;it.renderTasks.delete(D),(this._maybeCleanupAfterRender||pt)&&rt(this,c,!0),Q(this,x,ae).call(this,!pt),N?(D.capability.reject(N),this._abortOperatorList({intentState:it,reason:N instanceof Error?N:new Error(N)})):D.capability.resolve(),(T=this._stats)==null||T.timeEnd("Rendering"),(H=this._stats)==null||H.timeEnd("Overall")},D=new InternalRenderTask({callback:_t,params:{canvasContext:s,viewport:l,transform:O,background:V},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:G,operatorList:it.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!pt,pdfBug:this._pdfBug,pageColors:M});(it.renderTasks||(it.renderTasks=new Set)).add(D);const i=D.task;return Promise.all([it.displayReadyCapability.promise,_]).then(([N,T])=>{var H;if(this.destroyed){_t();return}(H=this._stats)==null||H.time("Rendering"),D.initializeGraphics({transparency:N,optionalContentConfig:T}),D.operatorListChanged()}).catch(_t),i}getOperatorList({intent:s="display",annotationMode:l=_util.AnnotationMode.ENABLE,printAnnotationStorage:r=null}={}){var G;function I(){V.operatorList.lastChunk&&(V.opListReadCapability.resolve(V.operatorList),V.renderTasks.delete(_))}const O=this._transport.getRenderingIntent(s,l,r,!0);let V=this._intentStates.get(O.cacheKey);V||(V=Object.create(null),this._intentStates.set(O.cacheKey,V));let _;return V.opListReadCapability||(_=Object.create(null),_.operatorListChanged=I,V.opListReadCapability=new _util.PromiseCapability,(V.renderTasks||(V.renderTasks=new Set)).add(_),V.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(G=this._stats)==null||G.time("Page Request"),this._pumpOperatorList(O)),V.opListReadCapability.promise}streamTextContent({includeMarkedContent:s=!1,disableNormalization:l=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:s===!0,disableNormalization:l===!0},{highWaterMark:100,size(I){return I.items.length}})}getTextContent(s={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_xfa_text.XfaText.textContent(r));const l=this.streamTextContent(s);return new Promise(function(r,I){function O(){V.read().then(function({value:G,done:M}){if(M){r(_);return}Object.assign(_.styles,G.styles),_.items.push(...G.items),O()},I)}const V=l.getReader(),_={items:[],styles:Object.create(null)};O()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const s=[];for(const l of this._intentStates.values())if(this._abortOperatorList({intentState:l,reason:new Error("Page was destroyed."),force:!0}),!l.opListReadCapability)for(const r of l.renderTasks)s.push(r.completed),r.cancel();return this.objs.clear(),rt(this,c,!1),Q(this,J,be).call(this),Promise.all(s)}cleanup(s=!1){rt(this,c,!0);const l=Q(this,x,ae).call(this,!1);return s&&l&&this._stats&&(this._stats=new _display_utils.StatTimer),l}_startRenderPage(s,l){var I,O;const r=this._intentStates.get(l);r&&((I=this._stats)==null||I.timeEnd("Page Request"),(O=r.displayReadyCapability)==null||O.resolve(s))}_renderPageChunk(s,l){for(let r=0,I=s.length;r<I;r++)l.operatorList.fnArray.push(s.fnArray[r]),l.operatorList.argsArray.push(s.argsArray[r]);l.operatorList.lastChunk=s.lastChunk,l.operatorList.separateAnnots=s.separateAnnots;for(const r of l.renderTasks)r.operatorListChanged();s.lastChunk&&Q(this,x,ae).call(this,!0)}_pumpOperatorList({renderingIntent:s,cacheKey:l,annotationStorageSerializable:r}){const{map:I,transfers:O}=r,_=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:s,cacheKey:l,annotationStorage:I},O).getReader(),G=this._intentStates.get(l);G.streamReader=_;const M=()=>{_.read().then(({value:k,done:$})=>{if($){G.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(k,G),M())},k=>{if(G.streamReader=null,!this._transport.destroyed){if(G.operatorList){G.operatorList.lastChunk=!0;for(const $ of G.renderTasks)$.operatorListChanged();Q(this,x,ae).call(this,!0)}if(G.displayReadyCapability)G.displayReadyCapability.reject(k);else if(G.opListReadCapability)G.opListReadCapability.reject(k);else throw k}})};M()}_abortOperatorList({intentState:s,reason:l,force:r=!1}){if(s.streamReader){if(s.streamReaderCancelTimeout&&(clearTimeout(s.streamReaderCancelTimeout),s.streamReaderCancelTimeout=null),!r){if(s.renderTasks.size>0)return;if(l instanceof _display_utils.RenderingCancelledException){let I=RENDERING_CANCELLED_TIMEOUT;l.extraDelay>0&&l.extraDelay<1e3&&(I+=l.extraDelay),s.streamReaderCancelTimeout=setTimeout(()=>{s.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:s,reason:l,force:!0})},I);return}}if(s.streamReader.cancel(new _util.AbortException(l.message)).catch(()=>{}),s.streamReader=null,!this._transport.destroyed){for(const[I,O]of this._intentStates)if(O===s){this._intentStates.delete(I);break}this.cleanup()}}}get stats(){return this._stats}}nt=new WeakMap,c=new WeakMap,x=new WeakSet,ae=function(s=!1){if(Q(this,J,be).call(this),!t(this,c)||this.destroyed)return!1;if(s)return rt(this,nt,setTimeout(()=>{rt(this,nt,null),Q(this,x,ae).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:l,operatorList:r}of this._intentStates.values())if(l.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),rt(this,c,!1),!0},J=new WeakSet,be=function(){t(this,nt)&&(clearTimeout(t(this,nt)),rt(this,nt,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){W(this,j,new Set);W(this,R,Promise.resolve())}postMessage(s,l){const r={data:structuredClone(s,l?{transfer:l}:null)};t(this,R).then(()=>{for(const I of t(this,j))I.call(this,r)})}addEventListener(s,l){t(this,j).add(l)}removeEventListener(s,l){t(this,j).delete(l)}terminate(){t(this,j).clear()}}j=new WeakMap,R=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const b=(p=document==null?void 0:document.currentScript)==null?void 0:p.src;b&&(PDFWorkerUtil.fallbackWorkerSrc=b.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(b,s){let l;try{if(l=new URL(b),!l.origin||l.origin==="null")return!1}catch{return!1}const r=new URL(s,l);return l.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(b){const s=`importScripts("${b}");`;return URL.createObjectURL(new Blob([s]))}}const _PDFWorker=class{constructor({name:b=null,port:s=null,verbosity:l=(0,_util.getVerbosityLevel)()}={}){if(s&&t(_PDFWorker,L).has(s))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=b,this.destroyed=!1,this.verbosity=l,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,s){t(_PDFWorker,L).set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(b){this._port=b,this._messageHandler=new _message_handler.MessageHandler("main","worker",b),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:b}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,b)||(b=PDFWorkerUtil.createCDNWrapper(new URL(b,window.location).href));const s=new Worker(b),l=new _message_handler.MessageHandler("main","worker",s),r=()=>{s.removeEventListener("error",I),l.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},I=()=>{this._webWorker||r()};s.addEventListener("error",I),l.on("test",V=>{if(s.removeEventListener("error",I),this.destroyed){r();return}V?(this._messageHandler=l,this._port=s,this._webWorker=s,this._readyCapability.resolve(),l.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),l.destroy(),s.terminate())}),l.on("ready",V=>{if(s.removeEventListener("error",I),this.destroyed){r();return}try{O()}catch{this._setupFakeWorker()}});const O=()=>{const V=new Uint8Array;l.send("test",V,[V.buffer])};O();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(b=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const s=new LoopbackPort;this._port=s;const l=`fake${PDFWorkerUtil.fakeWorkerId++}`,r=new _message_handler.MessageHandler(l+"_worker",l,s);b.setup(r,s);const I=new _message_handler.MessageHandler(l,l+"_worker",s);this._messageHandler=I,this._readyCapability.resolve(),I.send("configure",{verbosity:this.verbosity})}).catch(b=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${b.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),t(_PDFWorker,L).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(b){if(!(b!=null&&b.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return t(this,L).has(b.port)?t(this,L).get(b.port):new _PDFWorker(b)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var b;try{return((b=globalThis.pdfjsWorker)==null?void 0:b.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;L=new WeakMap,W(PDFWorker,L,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(s,l,r,I,O){W(this,f);W(this,B,new Map);W(this,w,new Map);W(this,y,new Map);W(this,A,null);this.messageHandler=s,this.loadingTask=l,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:I.ownerDocument,styleElement:I.styleElement}),this._params=I,this.canvasFactory=O.canvasFactory,this.filterFactory=O.filterFactory,this.cMapReaderFactory=O.cMapReaderFactory,this.standardFontDataFactory=O.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(s,l=_util.AnnotationMode.ENABLE,r=null,I=!1){let O=_util.RenderingIntentFlag.DISPLAY,V=_annotation_storage.SerializableEmpty;switch(s){case"any":O=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":O=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${s}`)}switch(l){case _util.AnnotationMode.DISABLE:O+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:O+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:O+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,V=(O&_util.RenderingIntentFlag.PRINT&&r instanceof _annotation_storage.PrintAnnotationStorage?r:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${l}`)}return I&&(O+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:O,cacheKey:`${O}_${V.hash}`,annotationStorageSerializable:V}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(r=t(this,A))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const s=[];for(const I of t(this,w).values())s.push(I._destroy());t(this,w).clear(),t(this,y).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const l=this.messageHandler.sendWithPromise("Terminate",null);return s.push(l),Promise.all(s).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),t(this,B).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:s,loadingTask:l}=this;s.on("GetReader",(r,I)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=O=>{this._lastProgress={loaded:O.loaded,total:O.total}},I.onPull=()=>{this._fullReader.read().then(function({value:O,done:V}){if(V){I.close();return}(0,_util.assert)(O instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),I.enqueue(new Uint8Array(O),1,[O])}).catch(O=>{I.error(O)})},I.onCancel=O=>{this._fullReader.cancel(O),I.ready.catch(V=>{if(!this.destroyed)throw V})}}),s.on("ReaderHeadersReady",r=>{const I=new _util.PromiseCapability,O=this._fullReader;return O.headersReady.then(()=>{var V;(!O.isStreamingSupported||!O.isRangeSupported)&&(this._lastProgress&&((V=l.onProgress)==null||V.call(l,this._lastProgress)),O.onProgress=_=>{var G;(G=l.onProgress)==null||G.call(l,{loaded:_.loaded,total:_.total})}),I.resolve({isStreamingSupported:O.isStreamingSupported,isRangeSupported:O.isRangeSupported,contentLength:O.contentLength})},I.reject),I.promise}),s.on("GetRangeReader",(r,I)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const O=this._networkStream.getRangeReader(r.begin,r.end);if(!O){I.close();return}I.onPull=()=>{O.read().then(function({value:V,done:_}){if(_){I.close();return}(0,_util.assert)(V instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),I.enqueue(new Uint8Array(V),1,[V])}).catch(V=>{I.error(V)})},I.onCancel=V=>{O.cancel(V),I.ready.catch(_=>{if(!this.destroyed)throw _})}}),s.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,l._capability.resolve(new PDFDocumentProxy(r,this))}),s.on("DocException",function(r){let I;switch(r.name){case"PasswordException":I=new _util.PasswordException(r.message,r.code);break;case"InvalidPDFException":I=new _util.InvalidPDFException(r.message);break;case"MissingPDFException":I=new _util.MissingPDFException(r.message);break;case"UnexpectedResponseException":I=new _util.UnexpectedResponseException(r.message,r.status);break;case"UnknownErrorException":I=new _util.UnknownErrorException(r.message,r.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}l._capability.reject(I)}),s.on("PasswordRequest",r=>{if(rt(this,A,new _util.PromiseCapability),l.onPassword){const I=O=>{O instanceof Error?t(this,A).reject(O):t(this,A).resolve({password:O})};try{l.onPassword(I,r.code)}catch(O){t(this,A).reject(O)}}else t(this,A).reject(new _util.PasswordException(r.message,r.code));return t(this,A).promise}),s.on("DataLoaded",r=>{var I;(I=l.onProgress)==null||I.call(l,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),s.on("StartRenderPage",r=>{if(this.destroyed)return;t(this,w).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),s.on("commonobj",([r,I,O])=>{var V;if(!this.destroyed&&!this.commonObjs.has(r))switch(I){case"Font":const _=this._params;if("error"in O){const k=O.error;(0,_util.warn)(`Error during font loading: ${k}`),this.commonObjs.resolve(r,k);break}const G=_.pdfBug&&((V=globalThis.FontInspector)!=null&&V.enabled)?(k,$)=>globalThis.FontInspector.fontAdded(k,$):null,M=new _font_loader.FontFaceObject(O,{isEvalSupported:_.isEvalSupported,disableFontFace:_.disableFontFace,ignoreErrors:_.ignoreErrors,inspectFont:G});this.fontLoader.bind(M).catch(k=>s.sendWithPromise("FontFallback",{id:r})).finally(()=>{!_.fontExtraProperties&&M.data&&(M.data=null),this.commonObjs.resolve(r,M)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,O);break;default:throw new Error(`Got unknown common object type ${I}`)}}),s.on("obj",([r,I,O,V])=>{var G;if(this.destroyed)return;const _=t(this,w).get(I);if(!_.objs.has(r))switch(O){case"Image":if(_.objs.resolve(r,V),V){let M;if(V.bitmap){const{width:k,height:$}=V;M=k*$*4}else M=((G=V.data)==null?void 0:G.length)||0;M>_util.MAX_IMAGE_SIZE_TO_CACHE&&(_._maybeCleanupAfterRender=!0)}break;case"Pattern":_.objs.resolve(r,V);break;default:throw new Error(`Got unknown object type ${O}`)}}),s.on("DocProgress",r=>{var I;this.destroyed||(I=l.onProgress)==null||I.call(l,{loaded:r.loaded,total:r.total})}),s.on("FetchBuiltInCMap",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(r):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),s.on("FetchStandardFontData",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(r):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:s,transfers:l}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:s,filename:((r=this._fullReader)==null?void 0:r.filename)??null},l).finally(()=>{this.annotationStorage.resetModified()})}getPage(s){if(!Number.isInteger(s)||s<=0||s>this._numPages)return Promise.reject(new Error("Invalid page request."));const l=s-1,r=t(this,y).get(l);if(r)return r;const I=this.messageHandler.sendWithPromise("GetPage",{pageIndex:l}).then(O=>{if(this.destroyed)throw new Error("Transport destroyed");const V=new PDFPageProxy(l,O,this,this._params.pdfBug);return t(this,w).set(l,V),V});return t(this,y).set(l,I),I}getPageIndex(s){return typeof s!="object"||s===null||!Number.isInteger(s.num)||s.num<0||!Number.isInteger(s.gen)||s.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:s.num,gen:s.gen})}getAnnotations(s,l){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:s,intent:l})}getFieldObjects(){return Q(this,f,xe).call(this,"GetFieldObjects")}hasJSActions(){return Q(this,f,xe).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(s){return typeof s!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:s})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(s){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:s})}getStructTree(s){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:s})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(s=>new _optional_content_config.OptionalContentConfig(s))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const s="GetMetadata",l=t(this,B).get(s);if(l)return l;const r=this.messageHandler.sendWithPromise(s,null).then(I=>{var O,V;return{info:I[0],metadata:I[1]?new _metadata.Metadata(I[1]):null,contentDispositionFilename:((O=this._fullReader)==null?void 0:O.filename)??null,contentLength:((V=this._fullReader)==null?void 0:V.contentLength)??null}});return t(this,B).set(s,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(s=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const l of t(this,w).values())if(!l.cleanup())throw new Error(`startCleanup: Page ${l.pageNumber} is currently rendering.`);this.commonObjs.clear(),s||this.fontLoader.clear(),t(this,B).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:s,enableXfa:l}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:s,enableXfa:l})}}B=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakMap,f=new WeakSet,xe=function(s,l=null){const r=t(this,B).get(s);if(r)return r;const I=this.messageHandler.sendWithPromise(s,l);return t(this,B).set(s,I),I};class PDFObjects{constructor(){W(this,P);W(this,E,Object.create(null))}get(s,l=null){if(l){const I=Q(this,P,Pe).call(this,s);return I.capability.promise.then(()=>l(I.data)),null}const r=t(this,E)[s];if(!(r!=null&&r.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${s}.`);return r.data}has(s){const l=t(this,E)[s];return(l==null?void 0:l.capability.settled)||!1}resolve(s,l=null){const r=Q(this,P,Pe).call(this,s);r.data=l,r.capability.resolve()}clear(){var s;for(const l in t(this,E)){const{data:r}=t(this,E)[l];(s=r==null?void 0:r.bitmap)==null||s.close()}rt(this,E,Object.create(null))}}E=new WeakMap,P=new WeakSet,Pe=function(s){const l=t(this,E)[s];return l||(t(this,E)[s]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(s){W(this,n,null);rt(this,n,s),this.onContinue=null}get promise(){return t(this,n).capability.promise}cancel(s=0){t(this,n).cancel(null,s)}get separateAnnots(){const{separateAnnots:s}=t(this,n).operatorList;if(!s)return!1;const{annotationCanvasMap:l}=t(this,n);return s.form||s.canvas&&(l==null?void 0:l.size)>0}}n=new WeakMap,exports.RenderTask=RenderTask;const F=class{constructor({callback:s,params:l,objs:r,commonObjs:I,annotationCanvasMap:O,operatorList:V,pageIndex:_,canvasFactory:G,filterFactory:M,useRequestAnimationFrame:k=!1,pdfBug:$=!1,pageColors:it=null}){this.callback=s,this.params=l,this.objs=r,this.commonObjs=I,this.annotationCanvasMap=O,this.operatorListIdx=null,this.operatorList=V,this._pageIndex=_,this.canvasFactory=G,this.filterFactory=M,this._pdfBug=$,this.pageColors=it,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=k===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=l.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:s=!1,optionalContentConfig:l}){var _,G;if(this.cancelled)return;if(this._canvas){if(t(F,o).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(F,o).add(this._canvas)}this._pdfBug&&((_=globalThis.StepperManager)!=null&&_.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:I,transform:O,background:V}=this.params;this.gfx=new _canvas.CanvasGraphics(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:l},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:O,viewport:I,transparency:s,background:V}),this.operatorListIdx=0,this.graphicsReady=!0,(G=this.graphicsReadyCallback)==null||G.call(this)}cancel(s=null,l=0){var r;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),this._canvas&&t(F,o).delete(this._canvas),this.callback(s||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,l))}operatorListChanged(){var s;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(s=this.stepper)==null||s.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&t(F,o).delete(this._canvas),this.callback())))}};let InternalRenderTask=F;o=new WeakMap,W(InternalRenderTask,o,new WeakSet);const version="3.9.179";exports.version=version;const build="1ef6fbc52";exports.build=build},(bt,d,nt)=>{var R,p,L,si,w;Object.defineProperty(d,"__esModule",{value:!0}),d.SerializableEmpty=d.PrintAnnotationStorage=d.AnnotationStorage=void 0;var c=nt(1),x=nt(4),et=nt(8);const J=Object.freeze({map:null,hash:"",transfers:void 0});d.SerializableEmpty=J;class lt{constructor(){W(this,L);W(this,R,!1);W(this,p,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(A,f){const v=t(this,p).get(A);return v===void 0?f:Object.assign(f,v)}getRawValue(A){return t(this,p).get(A)}remove(A){if(t(this,p).delete(A),t(this,p).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of t(this,p).values())if(f instanceof x.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(A,f){const v=t(this,p).get(A);let E=!1;if(v!==void 0)for(const[P,g]of Object.entries(f))v[P]!==g&&(E=!0,v[P]=g);else E=!0,t(this,p).set(A,f);E&&Q(this,L,si).call(this),f instanceof x.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(A){return t(this,p).has(A)}getAll(){return t(this,p).size>0?(0,c.objectFromMap)(t(this,p)):null}setAll(A){for(const[f,v]of Object.entries(A))this.setValue(f,v)}get size(){return t(this,p).size}resetModified(){t(this,R)&&(rt(this,R,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new j(this)}get serializable(){if(t(this,p).size===0)return J;const A=new Map,f=new et.MurmurHash3_64,v=[],E=Object.create(null);let P=!1;for(const[g,n]of t(this,p)){const o=n instanceof x.AnnotationEditor?n.serialize(!1,E):n;o&&(A.set(g,o),f.update(`${g}:${JSON.stringify(o)}`),P||(P=!!o.bitmap))}if(P)for(const g of A.values())g.bitmap&&v.push(g.bitmap);return A.size>0?{map:A,hash:f.hexdigest(),transfers:v}:J}}R=new WeakMap,p=new WeakMap,L=new WeakSet,si=function(){t(this,R)||(rt(this,R,!0),typeof this.onSetModified=="function"&&this.onSetModified())},d.AnnotationStorage=lt;class j extends lt{constructor(f){super();W(this,w,void 0);const{map:v,hash:E,transfers:P}=f.serializable,g=structuredClone(v,P?{transfer:P}:null);rt(this,w,{map:g,hash:E,transfers:P})}get print(){(0,c.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,w)}}w=new WeakMap,d.PrintAnnotationStorage=j},(bt,d,nt)=>{var lt,j,R,p,L,B,w,y,A,f,ke,E,ni,g,ri,o,ai;Object.defineProperty(d,"__esModule",{value:!0}),d.AnnotationEditor=void 0;var c=nt(1),x=nt(5);const b=class{constructor(l){W(this,f);W(this,E);W(this,g);W(this,o);W(this,lt,!1);W(this,j,null);W(this,R,null);W(this,p,this.focusin.bind(this));W(this,L,this.focusout.bind(this));W(this,B,!1);W(this,w,!1);W(this,y,!1);Yt(this,"_uiManager",null);W(this,A,b._zIndex++);this.constructor===b&&(0,c.unreachable)("Cannot initialize AnnotationEditor."),this.parent=l.parent,this.id=l.id,this.width=this.height=null,this.pageIndex=l.parent.pageIndex,this.name=l.name,this.div=null,this._uiManager=l.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1;const{rotation:r,rawDims:{pageWidth:I,pageHeight:O,pageX:V,pageY:_}}=this.parent.viewport;this.rotation=r,this.pageRotation=(360+r-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[I,O],this.pageTranslation=[V,_];const[G,M]=this.parentDimensions;this.x=l.x/G,this.y=l.y/M,this.isAttachedToDOM=!1,this.deleted=!1}static get _defaultLineColor(){return(0,c.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(l){const r=new J({id:l.parent.getNextId(),parent:l.parent,uiManager:l._uiManager});r.annotationElementId=l.annotationElementId,r.deleted=!0,r._uiManager.addToAnnotationStorage(r)}static initialize(l){}static updateDefaultParams(l,r){}static get defaultPropertiesToUpdate(){return[]}get propertiesToUpdate(){return[]}addCommands(l){this._uiManager.addCommands(l)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,A)}setParent(l){l!==null&&(this.pageIndex=l.pageIndex,this.pageDimensions=l.pageDimensions),this.parent=l}focusin(l){t(this,B)?rt(this,B,!1):this.parent.setSelected(this)}focusout(l){var I;if(!this.isAttachedToDOM)return;const r=l.relatedTarget;r!=null&&r.closest(`#${this.id}`)||(l.preventDefault(),(I=this.parent)!=null&&I.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(l){const r=this.parent.div.getBoundingClientRect();this.startX=l.clientX-r.x,this.startY=l.clientY-r.y,l.dataTransfer.setData("text/plain",this.id),l.dataTransfer.effectAllowed="move"}setAt(l,r,I,O){const[V,_]=this.parentDimensions;[I,O]=this.screenToPageTranslation(I,O),this.x=(l+I)/V,this.y=(r+O)/_,this.fixAndSetPosition()}translate(l,r){Q(this,f,ke).call(this,this.parentDimensions,l,r)}translateInPage(l,r){Q(this,f,ke).call(this,this.pageDimensions,l,r),this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[l,r]=this.pageDimensions;let{x:I,y:O,width:V,height:_}=this;switch(V*=l,_*=r,I*=l,O*=r,this.rotation){case 0:I=Math.max(0,Math.min(l-V,I)),O=Math.max(0,Math.min(r-_,O));break;case 90:I=Math.max(0,Math.min(l-_,I)),O=Math.min(r,Math.max(V,O));break;case 180:I=Math.min(l,Math.max(V,I)),O=Math.min(r,Math.max(_,O));break;case 270:I=Math.min(l,Math.max(_,I)),O=Math.max(0,Math.min(r-V,O));break}this.x=I/l,this.y=O/r,this.div.style.left=`${(100*this.x).toFixed(2)}%`,this.div.style.top=`${(100*this.y).toFixed(2)}%`}screenToPageTranslation(l,r){switch(this.parentRotation){case 90:return[r,-l];case 180:return[-l,-r];case 270:return[-r,l];default:return[l,r]}}pageTranslationToScreen(l,r){switch(this.parentRotation){case 90:return[-r,l];case 180:return[-l,-r];case 270:return[r,-l];default:return[l,r]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:l}=this._uiManager.viewParameters,[r,I]=this.pageDimensions;return[r*l,I*l]}setDims(l,r){const[I,O]=this.parentDimensions;this.div.style.width=`${(100*l/I).toFixed(2)}%`,t(this,lt)||(this.div.style.height=`${(100*r/O).toFixed(2)}%`)}fixDims(){const{style:l}=this.div,{height:r,width:I}=l,O=I.endsWith("%"),V=!t(this,lt)&&r.endsWith("%");if(O&&V)return;const[_,G]=this.parentDimensions;O||(l.width=`${(100*parseFloat(I)/_).toFixed(2)}%`),!t(this,lt)&&!V&&(l.height=`${(100*parseFloat(r)/G).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,p)),this.div.addEventListener("focusout",t(this,L));const[l,r]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*r/l).toFixed(2)}%`,this.div.style.maxHeight=`${(100*l/r).toFixed(2)}%`);const[I,O]=this.getInitialTranslation();return this.translate(I,O),(0,x.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(l){const{isMac:r}=c.FeatureTest.platform;if(l.button!==0||l.ctrlKey&&r){l.preventDefault();return}l.ctrlKey&&!r||l.shiftKey||l.metaKey&&r?this.parent.toggleSelected(this):this.parent.setSelected(this),rt(this,B,!0)}getRect(l,r){const I=this.parentScale,[O,V]=this.pageDimensions,[_,G]=this.pageTranslation,M=l/I,k=r/I,$=this.x*O,it=this.y*V,pt=this.width*O,_t=this.height*V;switch(this.rotation){case 0:return[$+M+_,V-it-k-_t+G,$+M+pt+_,V-it-k+G];case 90:return[$+k+_,V-it+M+G,$+k+_t+_,V-it+M+pt+G];case 180:return[$-M-pt+_,V-it+k+G,$-M+_,V-it+k+_t+G];case 270:return[$-k-_t+_,V-it-M-pt+G,$-k+_,V-it-M+G];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(l,r){const[I,O,V,_]=l,G=V-I,M=_-O;switch(this.rotation){case 0:return[I,r-_,G,M];case 90:return[I,r-O,M,G];case 180:return[V,r-O,G,M];case 270:return[V,r-_,M,G];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){rt(this,y,!0)}disableEditMode(){rt(this,y,!1)}isInEditMode(){return t(this,y)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var l,r;(l=this.div)==null||l.addEventListener("focusin",t(this,p)),(r=this.div)==null||r.addEventListener("focusout",t(this,L))}serialize(l=!1,r=null){(0,c.unreachable)("An editor must be serializable")}static deserialize(l,r,I){const O=new this.prototype.constructor({parent:r,id:r.getNextId(),uiManager:I});O.rotation=l.rotation;const[V,_]=O.pageDimensions,[G,M,k,$]=O.getRectInCurrentCoords(l.rect,_);return O.x=G/V,O.y=M/_,O.width=k/V,O.height=$/_,O}remove(){this.div.removeEventListener("focusin",t(this,p)),this.div.removeEventListener("focusout",t(this,L)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Q(this,E,ni).call(this),t(this,j).classList.remove("hidden"))}select(){var l;this.makeResizable(),(l=this.div)==null||l.classList.add("selectedEditor")}unselect(){var l,r,I;(l=t(this,j))==null||l.classList.add("hidden"),(r=this.div)==null||r.classList.remove("selectedEditor"),(I=this.div)!=null&&I.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(l,r){}disableEditing(){}enableEditing(){}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,w)}set isEditing(l){rt(this,w,l),this.parent&&(l?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(l,r){rt(this,lt,!0);const I=l/r,{style:O}=this.div;O.aspectRatio=I,O.height="auto"}static get MIN_SIZE(){return 16}};let et=b;lt=new WeakMap,j=new WeakMap,R=new WeakMap,p=new WeakMap,L=new WeakMap,B=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakMap,f=new WeakSet,ke=function([l,r],I,O){[I,O]=this.screenToPageTranslation(I,O),this.x+=I/l,this.y+=O/r,this.fixAndSetPosition()},E=new WeakSet,ni=function(){if(t(this,j))return;rt(this,j,document.createElement("div")),t(this,j).classList.add("resizers");const l=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||l.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const r of l){const I=document.createElement("div");t(this,j).append(I),I.classList.add("resizer",r),I.addEventListener("pointerdown",Q(this,g,ri).bind(this,r))}this.div.prepend(t(this,j))},g=new WeakSet,ri=function(l,r){r.preventDefault(),rt(this,R,[r.clientX,r.clientY]);const I=Q(this,o,ai).bind(this,l),O=this.div.draggable;this.div.draggable=!1;const V=`resizing${l.charAt(0).toUpperCase()}${l.slice(1)}`;this.parent.div.classList.add(V);const _={passive:!0,capture:!0};window.addEventListener("pointermove",I,_);const G=()=>{this._uiManager.stopUndoAccumulation(),this.div.draggable=O,this.parent.div.classList.remove(V),window.removeEventListener("pointermove",I,_)};window.addEventListener("pointerup",G,{once:!0})},o=new WeakSet,ai=function(l,r){const{clientX:I,clientY:O}=r,V=I-t(this,R)[0],_=O-t(this,R)[1];t(this,R)[0]=I,t(this,R)[1]=O;const[G,M]=this.parentDimensions,k=this.x,$=this.y,it=this.width,pt=this.height,_t=b.MIN_SIZE/G,D=b.MIN_SIZE/M;let i;const e=T=>Math.round(T*1e4)/1e4,m=(T,H)=>{const[z,Y]=this.parentDimensions;this.setDims(z*T,Y*H),this.fixAndSetPosition()},N=()=>{this.width=it,this.height=pt,this.x=k,this.y=$,m(it,pt)};switch(l){case"topLeft":{if(Math.sign(V)*Math.sign(_)<0)return;const T=Math.hypot(V,_),H=Math.hypot(it*G,pt*M),z=e(k+it),Y=e($+pt),dt=Math.max(Math.min(1-Math.sign(V)*(T/H),1/it,1/pt),_t/it,D/pt),at=e(it*dt),ht=e(pt*dt),ft=z-at,Ct=Y-ht;i=()=>{this.width=at,this.height=ht,this.x=ft,this.y=Ct,m(at,ht)};break}case"topMiddle":{const T=e(this.y+pt),H=e(Math.max(D,Math.min(1,pt-_/M))),z=T-H;i=()=>{this.height=H,this.y=z,m(it,H)};break}case"topRight":{if(Math.sign(V)*Math.sign(_)>0)return;const T=Math.hypot(V,_),H=Math.hypot(this.width*G,this.height*M),z=e($+this.height),Y=Math.max(Math.min(1+Math.sign(V)*(T/H),1/it,1/pt),_t/it,D/pt),dt=e(it*Y),at=e(pt*Y),ht=z-at;i=()=>{this.width=dt,this.height=at,this.y=ht,m(dt,at)};break}case"middleRight":{const T=e(Math.max(_t,Math.min(1,it+V/G)));i=()=>{this.width=T,m(T,pt)};break}case"bottomRight":{if(Math.sign(V)*Math.sign(_)<0)return;const T=Math.hypot(V,_),H=Math.hypot(this.width*G,this.height*M),z=Math.max(Math.min(1+Math.sign(V)*(T/H),1/it,1/pt),_t/it,D/pt),Y=e(it*z),dt=e(pt*z);i=()=>{this.width=Y,this.height=dt,m(Y,dt)};break}case"bottomMiddle":{const T=e(Math.max(D,Math.min(1,pt+_/M)));i=()=>{this.height=T,m(it,T)};break}case"bottomLeft":{if(Math.sign(V)*Math.sign(_)>0)return;const T=Math.hypot(V,_),H=Math.hypot(this.width*G,this.height*M),z=e(k+this.width),Y=Math.max(Math.min(1-Math.sign(V)*(T/H),1/it,1/pt),_t/it,D/pt),dt=e(it*Y),at=e(pt*Y),ht=z-dt;i=()=>{this.width=dt,this.height=at,this.x=ht,m(dt,at)};break}case"middleLeft":{const T=e(k+it),H=e(Math.max(_t,Math.min(1,it-V/G))),z=T-H;i=()=>{this.width=H,this.x=z,m(H,pt)};break}}this.addCommands({cmd:i,undo:N,mustExec:!0,type:c.AnnotationEditorParamsType.RESIZE,overwriteIfSameType:!0,keepUndo:!0})},Yt(et,"_colorManager",new x.ColorManager),Yt(et,"_zIndex",1),d.AnnotationEditor=et;class J extends et{constructor(l){super(l),this.annotationElementId=l.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(bt,d,nt)=>{var w,y,A,f,v,Fe,P,g,n,o,F,oi,l,r,I,O,V,_,G,M,k,$,it,pt,_t,D,i,e,m,N,T,H,z,Y,dt,at,ht,ft,Ct,At,Rt,li,St,Re,vt,ci,tt,hi,yt,ee,Mt,de,It,di,Wt,ui,ct,Me,K,ue,jt,De;Object.defineProperty(d,"__esModule",{value:!0}),d.KeyboardManager=d.CommandManager=d.ColorManager=d.AnnotationEditorUIManager=void 0,d.bindEvents=et,d.opacityToHex=J;var c=nt(1),x=nt(6);function et(Kt,h,X){for(const ut of X)h.addEventListener(ut,Kt[ut].bind(Kt))}function J(Kt){return Math.round(Math.min(255,Math.max(1,255*Kt))).toString(16).padStart(2,"0")}class lt{constructor(){W(this,w,0)}getId(){return`${c.AnnotationEditorPrefix}${ie(this,w)._++}`}}w=new WeakMap;class j{constructor(){W(this,v);W(this,y,(0,c.getUuid)());W(this,A,0);W(this,f,null)}async getFromFile(h){const{lastModified:X,name:ut,size:ot,type:u}=h;return Q(this,v,Fe).call(this,`${X}_${ut}_${ot}_${u}`,h)}async getFromUrl(h){return Q(this,v,Fe).call(this,h,h)}async getFromId(h){t(this,f)||rt(this,f,new Map);const X=t(this,f).get(h);return X?X.bitmap?(X.refCounter+=1,X):X.file?this.getFromFile(X.file):this.getFromUrl(X.url):null}getSvgUrl(h){const X=t(this,f).get(h);return X!=null&&X.isSvg?X.svgUrl:null}deleteId(h){t(this,f)||rt(this,f,new Map);const X=t(this,f).get(h);X&&(X.refCounter-=1,X.refCounter===0&&(X.bitmap=null))}isValidId(h){return h.startsWith(`image_${t(this,y)}_`)}}y=new WeakMap,A=new WeakMap,f=new WeakMap,v=new WeakSet,Fe=async function(h,X){t(this,f)||rt(this,f,new Map);let ut=t(this,f).get(h);if(ut===null)return null;if(ut!=null&&ut.bitmap)return ut.refCounter+=1,ut;try{ut||(ut={bitmap:null,id:`image_${t(this,y)}_${ie(this,A)._++}`,refCounter:0,isSvg:!1});let ot;if(typeof X=="string"){ut.url=X;const u=await fetch(X);if(!u.ok)throw new Error(u.statusText);ot=await u.blob()}else ot=ut.file=X;if(ot.type==="image/svg+xml"){const u=new FileReader,a=new Image,C=new Promise((S,U)=>{a.onload=()=>{ut.bitmap=a,ut.isSvg=!0,S()},u.onload=()=>{a.src=ut.svgUrl=u.result},a.onerror=u.onerror=U});u.readAsDataURL(ot),await C}else ut.bitmap=await createImageBitmap(ot);ut.refCounter=1}catch(ot){console.error(ot),ut=null}return t(this,f).set(h,ut),ut&&t(this,f).set(ut.id,ut),ut};class R{constructor(h=128){W(this,P,[]);W(this,g,!1);W(this,n,void 0);W(this,o,-1);rt(this,n,h)}add({cmd:h,undo:X,mustExec:ut,type:ot=NaN,overwriteIfSameType:u=!1,keepUndo:a=!1}){if(ut&&h(),t(this,g))return;const C={cmd:h,undo:X,type:ot};if(t(this,o)===-1){t(this,P).length>0&&(t(this,P).length=0),rt(this,o,0),t(this,P).push(C);return}if(u&&t(this,P)[t(this,o)].type===ot){a&&(C.undo=t(this,P)[t(this,o)].undo),t(this,P)[t(this,o)]=C;return}const S=t(this,o)+1;S===t(this,n)?t(this,P).splice(0,1):(rt(this,o,S),S<t(this,P).length&&t(this,P).splice(S)),t(this,P).push(C)}stopUndoAccumulation(){t(this,o)!==-1&&(t(this,P)[t(this,o)].type=NaN)}undo(){t(this,o)!==-1&&(rt(this,g,!0),t(this,P)[t(this,o)].undo(),rt(this,g,!1),rt(this,o,t(this,o)-1))}redo(){t(this,o)<t(this,P).length-1&&(rt(this,o,t(this,o)+1),rt(this,g,!0),t(this,P)[t(this,o)].cmd(),rt(this,g,!1))}hasSomethingToUndo(){return t(this,o)!==-1}hasSomethingToRedo(){return t(this,o)<t(this,P).length-1}destroy(){rt(this,P,null)}}P=new WeakMap,g=new WeakMap,n=new WeakMap,o=new WeakMap,d.CommandManager=R;class p{constructor(h){W(this,F);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:X}=c.FeatureTest.platform;for(const[ut,ot,u={}]of h)for(const a of ut){const C=a.startsWith("mac+");X&&C?(this.callbacks.set(a.slice(4),{callback:ot,options:u}),this.allKeys.add(a.split("+").at(-1))):!X&&!C&&(this.callbacks.set(a,{callback:ot,options:u}),this.allKeys.add(a.split("+").at(-1)))}}exec(h,X){if(!this.allKeys.has(X.key))return;const ut=this.callbacks.get(Q(this,F,oi).call(this,X));if(!ut)return;const{callback:ot,options:{bubbles:u=!1,args:a=[],checker:C=null}}=ut;C&&!C(h,X)||(ot.bind(h,...a)(),u||(X.stopPropagation(),X.preventDefault()))}}F=new WeakSet,oi=function(h){h.altKey&&this.buffer.push("alt"),h.ctrlKey&&this.buffer.push("ctrl"),h.metaKey&&this.buffer.push("meta"),h.shiftKey&&this.buffer.push("shift"),this.buffer.push(h.key);const X=this.buffer.join("+");return this.buffer.length=0,X},d.KeyboardManager=p;const s=class{get _colors(){const h=new Map([["CanvasText",null],["Canvas",null]]);return(0,x.getColorValues)(h),(0,c.shadow)(this,"_colors",h)}convert(h){const X=(0,x.getRGB)(h);if(!window.matchMedia("(forced-colors: active)").matches)return X;for(const[ut,ot]of this._colors)if(ot.every((u,a)=>u===X[a]))return s._colorsMapping.get(ut);return X}getHexCode(h){const X=this._colors.get(h);return X?c.Util.makeHexColor(...X):h}};let L=s;Yt(L,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),d.ColorManager=L;const $t=class{constructor(h,X,ut,ot){W(this,Rt);W(this,St);W(this,vt);W(this,tt);W(this,yt);W(this,Mt);W(this,It);W(this,Wt);W(this,ct);W(this,K);W(this,jt);W(this,l,null);W(this,r,new Map);W(this,I,new Map);W(this,O,null);W(this,V,new R);W(this,_,0);W(this,G,new Set);W(this,M,null);W(this,k,new Set);W(this,$,null);W(this,it,null);W(this,pt,new lt);W(this,_t,!1);W(this,D,c.AnnotationEditorType.NONE);W(this,i,new Set);W(this,e,null);W(this,m,this.copy.bind(this));W(this,N,this.cut.bind(this));W(this,T,this.paste.bind(this));W(this,H,this.keydown.bind(this));W(this,z,this.onEditingAction.bind(this));W(this,Y,this.onPageChanging.bind(this));W(this,dt,this.onScaleChanging.bind(this));W(this,at,this.onRotationChanging.bind(this));W(this,ht,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});W(this,ft,[0,0]);W(this,Ct,null);W(this,At,null);rt(this,At,h),rt(this,$,X),t(this,$)._on("editingaction",t(this,z)),t(this,$)._on("pagechanging",t(this,Y)),t(this,$)._on("scalechanging",t(this,dt)),t(this,$)._on("rotationchanging",t(this,at)),rt(this,O,ut.annotationStorage),rt(this,it,ut.filterFactory),rt(this,e,ot),this.viewParameters={realScale:x.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const h=$t.prototype,X=u=>{const{activeElement:a}=document;return a&&t(u,At).contains(a)&&u.hasSomethingToControl()},ut=this.TRANSLATE_SMALL,ot=this.TRANSLATE_BIG;return(0,c.shadow)(this,"_keyboardManager",new p([[["ctrl+a","mac+meta+a"],h.selectAll],[["ctrl+z","mac+meta+z"],h.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],h.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],h.delete],[["Escape","mac+Escape"],h.unselectAll],[["ArrowLeft","mac+ArrowLeft"],h.translateSelectedEditors,{args:[-ut,0],checker:X}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],h.translateSelectedEditors,{args:[-ot,0],checker:X}],[["ArrowRight","mac+ArrowRight"],h.translateSelectedEditors,{args:[ut,0],checker:X}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],h.translateSelectedEditors,{args:[ot,0],checker:X}],[["ArrowUp","mac+ArrowUp"],h.translateSelectedEditors,{args:[0,-ut],checker:X}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],h.translateSelectedEditors,{args:[0,-ot],checker:X}],[["ArrowDown","mac+ArrowDown"],h.translateSelectedEditors,{args:[0,ut],checker:X}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],h.translateSelectedEditors,{args:[0,ot],checker:X}]]))}destroy(){Q(this,St,Re).call(this),t(this,$)._off("editingaction",t(this,z)),t(this,$)._off("pagechanging",t(this,Y)),t(this,$)._off("scalechanging",t(this,dt)),t(this,$)._off("rotationchanging",t(this,at));for(const h of t(this,I).values())h.destroy();t(this,I).clear(),t(this,r).clear(),t(this,k).clear(),rt(this,l,null),t(this,i).clear(),t(this,V).destroy()}get hcmFilter(){return(0,c.shadow)(this,"hcmFilter",t(this,e)?t(this,it).addHCMFilter(t(this,e).foreground,t(this,e).background):"none")}onPageChanging({pageNumber:h}){rt(this,_,h-1)}focusMainContainer(){t(this,At).focus()}addShouldRescale(h){t(this,k).add(h)}removeShouldRescale(h){t(this,k).delete(h)}onScaleChanging({scale:h}){this.commitOrRemove(),this.viewParameters.realScale=h*x.PixelsPerInch.PDF_TO_CSS_UNITS;for(const X of t(this,k))X.onScaleChanging()}onRotationChanging({pagesRotation:h}){this.commitOrRemove(),this.viewParameters.rotation=h}addToAnnotationStorage(h){!h.isEmpty()&&t(this,O)&&!t(this,O).has(h.id)&&t(this,O).setValue(h.id,h)}copy(h){if(h.preventDefault(),t(this,l)&&t(this,l).commitOrRemove(),!this.hasSelection)return;const X=[];for(const ut of t(this,i)){const ot=ut.serialize(!0);ot&&X.push(ot)}X.length!==0&&h.clipboardData.setData("application/pdfjs",JSON.stringify(X))}cut(h){this.copy(h),this.delete()}paste(h){h.preventDefault();let X=h.clipboardData.getData("application/pdfjs");if(!X)return;try{X=JSON.parse(X)}catch(ot){(0,c.warn)(`paste: "${ot.message}".`);return}if(!Array.isArray(X))return;this.unselectAll();const ut=this.currentLayer;try{const ot=[];for(const C of X){const S=ut.deserialize(C);if(!S)return;ot.push(S)}const u=()=>{for(const C of ot)Q(this,ct,Me).call(this,C);Q(this,jt,De).call(this,ot)},a=()=>{for(const C of ot)C.remove()};this.addCommands({cmd:u,undo:a,mustExec:!0})}catch(ot){(0,c.warn)(`paste: "${ot.message}".`)}}keydown(h){var X;(X=this.getActive())!=null&&X.shouldGetKeyboardEvents()||$t._keyboardManager.exec(this,h)}onEditingAction(h){["undo","redo","delete","selectAll"].includes(h.name)&&this[h.name]()}setEditingState(h){h?(Q(this,Rt,li).call(this),Q(this,vt,ci).call(this),Q(this,yt,ee).call(this,{isEditing:t(this,D)!==c.AnnotationEditorType.NONE,isEmpty:Q(this,K,ue).call(this),hasSomethingToUndo:t(this,V).hasSomethingToUndo(),hasSomethingToRedo:t(this,V).hasSomethingToRedo(),hasSelectedEditor:!1})):(Q(this,St,Re).call(this),Q(this,tt,hi).call(this),Q(this,yt,ee).call(this,{isEditing:!1}))}registerEditorTypes(h){if(!t(this,M)){rt(this,M,h);for(const X of t(this,M))Q(this,Mt,de).call(this,X.defaultPropertiesToUpdate)}}getId(){return t(this,pt).getId()}get currentLayer(){return t(this,I).get(t(this,_))}get currentPageIndex(){return t(this,_)}addLayer(h){t(this,I).set(h.pageIndex,h),t(this,_t)?h.enable():h.disable()}removeLayer(h){t(this,I).delete(h.pageIndex)}updateMode(h,X=null){if(rt(this,D,h),h===c.AnnotationEditorType.NONE){this.setEditingState(!1),Q(this,Wt,ui).call(this);return}this.setEditingState(!0),Q(this,It,di).call(this);for(const ut of t(this,I).values())ut.updateMode(h);if(X){for(const ut of t(this,r).values())if(ut.annotationElementId===X){this.setSelected(ut),ut.enterInEditMode();break}}}updateToolbar(h){h!==t(this,D)&&t(this,$).dispatch("switchannotationeditormode",{source:this,mode:h})}updateParams(h,X){if(t(this,M)){for(const ut of t(this,i))ut.updateParams(h,X);for(const ut of t(this,M))ut.updateDefaultParams(h,X)}}getEditors(h){const X=[];for(const ut of t(this,r).values())ut.pageIndex===h&&X.push(ut);return X}getEditor(h){return t(this,r).get(h)}addEditor(h){t(this,r).set(h.id,h)}removeEditor(h){var X;t(this,r).delete(h.id),this.unselect(h),(!h.annotationElementId||!t(this,G).has(h.annotationElementId))&&((X=t(this,O))==null||X.remove(h.id))}addDeletedAnnotationElement(h){t(this,G).add(h.annotationElementId),h.deleted=!0}isDeletedAnnotationElement(h){return t(this,G).has(h)}removeDeletedAnnotationElement(h){t(this,G).delete(h.annotationElementId),h.deleted=!1}setActiveEditor(h){t(this,l)!==h&&(rt(this,l,h),h&&Q(this,Mt,de).call(this,h.propertiesToUpdate))}toggleSelected(h){if(t(this,i).has(h)){t(this,i).delete(h),h.unselect(),Q(this,yt,ee).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,i).add(h),h.select(),Q(this,Mt,de).call(this,h.propertiesToUpdate),Q(this,yt,ee).call(this,{hasSelectedEditor:!0})}setSelected(h){for(const X of t(this,i))X!==h&&X.unselect();t(this,i).clear(),t(this,i).add(h),h.select(),Q(this,Mt,de).call(this,h.propertiesToUpdate),Q(this,yt,ee).call(this,{hasSelectedEditor:!0})}isSelected(h){return t(this,i).has(h)}unselect(h){h.unselect(),t(this,i).delete(h),Q(this,yt,ee).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,i).size!==0}stopUndoAccumulation(){t(this,V).stopUndoAccumulation()}undo(){t(this,V).undo(),Q(this,yt,ee).call(this,{hasSomethingToUndo:t(this,V).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Q(this,K,ue).call(this)})}redo(){t(this,V).redo(),Q(this,yt,ee).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,V).hasSomethingToRedo(),isEmpty:Q(this,K,ue).call(this)})}addCommands(h){t(this,V).add(h),Q(this,yt,ee).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Q(this,K,ue).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const h=[...t(this,i)],X=()=>{for(const ot of h)ot.remove()},ut=()=>{for(const ot of h)Q(this,ct,Me).call(this,ot)};this.addCommands({cmd:X,undo:ut,mustExec:!0})}commitOrRemove(){var h;(h=t(this,l))==null||h.commitOrRemove()}hasSomethingToControl(){return t(this,l)||this.hasSelection}selectAll(){for(const h of t(this,i))h.commit();Q(this,jt,De).call(this,t(this,r).values())}unselectAll(){if(t(this,l)){t(this,l).commitOrRemove();return}if(this.hasSelection){for(const h of t(this,i))h.unselect();t(this,i).clear(),Q(this,yt,ee).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(h,X,ut=!1){if(ut||this.commitOrRemove(),!this.hasSelection)return;t(this,ft)[0]+=h,t(this,ft)[1]+=X;const[ot,u]=t(this,ft),a=[...t(this,i)],C=1e3;t(this,Ct)&&clearTimeout(t(this,Ct)),rt(this,Ct,setTimeout(()=>{rt(this,Ct,null),t(this,ft)[0]=t(this,ft)[1]=0,this.addCommands({cmd:()=>{for(const S of a)t(this,r).has(S.id)&&S.translateInPage(ot,u)},undo:()=>{for(const S of a)t(this,r).has(S.id)&&S.translateInPage(-ot,-u)},mustExec:!1})},C));for(const S of a)S.translateInPage(h,X)}isActive(h){return t(this,l)===h}getActive(){return t(this,l)}getMode(){return t(this,D)}get imageManager(){return(0,c.shadow)(this,"imageManager",new j)}};let B=$t;l=new WeakMap,r=new WeakMap,I=new WeakMap,O=new WeakMap,V=new WeakMap,_=new WeakMap,G=new WeakMap,M=new WeakMap,k=new WeakMap,$=new WeakMap,it=new WeakMap,pt=new WeakMap,_t=new WeakMap,D=new WeakMap,i=new WeakMap,e=new WeakMap,m=new WeakMap,N=new WeakMap,T=new WeakMap,H=new WeakMap,z=new WeakMap,Y=new WeakMap,dt=new WeakMap,at=new WeakMap,ht=new WeakMap,ft=new WeakMap,Ct=new WeakMap,At=new WeakMap,Rt=new WeakSet,li=function(){window.addEventListener("keydown",t(this,H),{capture:!0})},St=new WeakSet,Re=function(){window.removeEventListener("keydown",t(this,H),{capture:!0})},vt=new WeakSet,ci=function(){document.addEventListener("copy",t(this,m)),document.addEventListener("cut",t(this,N)),document.addEventListener("paste",t(this,T))},tt=new WeakSet,hi=function(){document.removeEventListener("copy",t(this,m)),document.removeEventListener("cut",t(this,N)),document.removeEventListener("paste",t(this,T))},yt=new WeakSet,ee=function(h){Object.entries(h).some(([ut,ot])=>t(this,ht)[ut]!==ot)&&t(this,$).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,ht),h)})},Mt=new WeakSet,de=function(h){t(this,$).dispatch("annotationeditorparamschanged",{source:this,details:h})},It=new WeakSet,di=function(){if(!t(this,_t)){rt(this,_t,!0);for(const h of t(this,I).values())h.enable()}},Wt=new WeakSet,ui=function(){if(this.unselectAll(),t(this,_t)){rt(this,_t,!1);for(const h of t(this,I).values())h.disable()}},ct=new WeakSet,Me=function(h){const X=t(this,I).get(h.pageIndex);X?X.addOrRebuild(h):this.addEditor(h)},K=new WeakSet,ue=function(){if(t(this,r).size===0)return!0;if(t(this,r).size===1)for(const h of t(this,r).values())return h.isEmpty();return!1},jt=new WeakSet,De=function(h){t(this,i).clear();for(const X of h)X.isEmpty()||(t(this,i).add(X),X.select());Q(this,yt,ee).call(this,{hasSelectedEditor:!0})},Yt(B,"TRANSLATE_SMALL",1),Yt(B,"TRANSLATE_BIG",10),d.AnnotationEditorUIManager=B},(bt,d,nt)=>{var M,k,$,it,pt,_t,D,i,e,m,N,T,oe,z,le,dt,Ie,ht,_e,Ct,Ae,Rt,fe,St,pe;Object.defineProperty(d,"__esModule",{value:!0}),d.StatTimer=d.RenderingCancelledException=d.PixelsPerInch=d.PageViewport=d.PDFDateString=d.DOMStandardFontDataFactory=d.DOMSVGFactory=d.DOMFilterFactory=d.DOMCanvasFactory=d.DOMCMapReaderFactory=d.AnnotationPrefix=void 0,d.deprecated=F,d.getColorValues=I,d.getCurrentTransform=O,d.getCurrentTransformInverse=V,d.getFilenameFromUrl=E,d.getPdfFilenameFromUrl=P,d.getRGB=r,d.getXfaPageViewport=l,d.isDataScheme=f,d.isPdfFile=v,d.isValidFetchUrl=n,d.loadScript=o,d.setLayerDimensions=_;var c=nt(7),x=nt(1);const et="http://www.w3.org/2000/svg",J="pdfjs_internal_id_";d.AnnotationPrefix=J;const G=class{};let lt=G;Yt(lt,"CSS",96),Yt(lt,"PDF",72),Yt(lt,"PDF_TO_CSS_UNITS",G.CSS/G.PDF),d.PixelsPerInch=lt;class j extends c.BaseFilterFactory{constructor({docId:tt,ownerDocument:gt=globalThis.document}={}){super();W(this,T);W(this,z);W(this,dt);W(this,ht);W(this,Ct);W(this,Rt);W(this,St);W(this,M,void 0);W(this,k,void 0);W(this,$,void 0);W(this,it,void 0);W(this,pt,void 0);W(this,_t,void 0);W(this,D,void 0);W(this,i,void 0);W(this,e,void 0);W(this,m,void 0);W(this,N,0);rt(this,$,tt),rt(this,it,gt)}addFilter(tt){if(!tt)return"none";let gt=t(this,T,oe).get(tt);if(gt)return gt;let yt,Ft,Mt,zt;if(tt.length===1){const Ut=tt[0],ct=new Array(256);for(let q=0;q<256;q++)ct[q]=Ut[q]/255;zt=yt=Ft=Mt=ct.join(",")}else{const[Ut,ct,q]=tt,K=new Array(256),wt=new Array(256),jt=new Array(256);for(let Lt=0;Lt<256;Lt++)K[Lt]=Ut[Lt]/255,wt[Lt]=ct[Lt]/255,jt[Lt]=q[Lt]/255;yt=K.join(","),Ft=wt.join(","),Mt=jt.join(","),zt=`${yt}${Ft}${Mt}`}if(gt=t(this,T,oe).get(zt),gt)return t(this,T,oe).set(tt,gt),gt;const It=`g_${t(this,$)}_transfer_map_${ie(this,N)._++}`,Xt=`url(#${It})`;t(this,T,oe).set(tt,Xt),t(this,T,oe).set(zt,Xt);const Wt=Q(this,ht,_e).call(this,It);return Q(this,Rt,fe).call(this,yt,Ft,Mt,Wt),Xt}addHCMFilter(tt,gt){var ct;const yt=`${tt}-${gt}`;if(t(this,_t)===yt)return t(this,D);if(rt(this,_t,yt),rt(this,D,"none"),(ct=t(this,pt))==null||ct.remove(),!tt||!gt)return t(this,D);const Ft=Q(this,St,pe).call(this,tt);tt=x.Util.makeHexColor(...Ft);const Mt=Q(this,St,pe).call(this,gt);if(gt=x.Util.makeHexColor(...Mt),t(this,z,le).style.color="",tt==="#000000"&&gt==="#ffffff"||tt===gt)return t(this,D);const zt=new Array(256);for(let q=0;q<=255;q++){const K=q/255;zt[q]=K<=.03928?K/12.92:((K+.055)/1.055)**2.4}const It=zt.join(","),Xt=`g_${t(this,$)}_hcm_filter`,Wt=rt(this,i,Q(this,ht,_e).call(this,Xt));Q(this,Rt,fe).call(this,It,It,It,Wt),Q(this,dt,Ie).call(this,Wt);const Ut=(q,K)=>{const wt=Ft[q]/255,jt=Mt[q]/255,Lt=new Array(K+1);for(let $t=0;$t<=K;$t++)Lt[$t]=wt+$t/K*(jt-wt);return Lt.join(",")};return Q(this,Rt,fe).call(this,Ut(0,5),Ut(1,5),Ut(2,5),Wt),rt(this,D,`url(#${Xt})`),t(this,D)}addHighlightHCMFilter(tt,gt,yt,Ft){var jt;const Mt=`${tt}-${gt}-${yt}-${Ft}`;if(t(this,e)===Mt)return t(this,m);if(rt(this,e,Mt),rt(this,m,"none"),(jt=t(this,i))==null||jt.remove(),!tt||!gt)return t(this,m);const[zt,It]=[tt,gt].map(Q(this,St,pe).bind(this));let Xt=Math.round(.2126*zt[0]+.7152*zt[1]+.0722*zt[2]),Wt=Math.round(.2126*It[0]+.7152*It[1]+.0722*It[2]),[Ut,ct]=[yt,Ft].map(Q(this,St,pe).bind(this));Wt<Xt&&([Xt,Wt,Ut,ct]=[Wt,Xt,ct,Ut]),t(this,z,le).style.color="";const q=(Lt,$t,Kt)=>{const h=new Array(256),X=(Wt-Xt)/Kt,ut=Lt/255,ot=($t-Lt)/(255*Kt);let u=0;for(let a=0;a<=Kt;a++){const C=Math.round(Xt+a*X),S=ut+a*ot;for(let U=u;U<=C;U++)h[U]=S;u=C+1}for(let a=u;a<256;a++)h[a]=h[u-1];return h.join(",")},K=`g_${t(this,$)}_hcm_highlight_filter`,wt=rt(this,i,Q(this,ht,_e).call(this,K));return Q(this,dt,Ie).call(this,wt),Q(this,Rt,fe).call(this,q(Ut[0],ct[0],5),q(Ut[1],ct[1],5),q(Ut[2],ct[2],5),wt),rt(this,m,`url(#${K})`),t(this,m)}destroy(tt=!1){tt&&(t(this,D)||t(this,m))||(t(this,k)&&(t(this,k).parentNode.parentNode.remove(),rt(this,k,null)),t(this,M)&&(t(this,M).clear(),rt(this,M,null)),rt(this,N,0))}}M=new WeakMap,k=new WeakMap,$=new WeakMap,it=new WeakMap,pt=new WeakMap,_t=new WeakMap,D=new WeakMap,i=new WeakMap,e=new WeakMap,m=new WeakMap,N=new WeakMap,T=new WeakSet,oe=function(){return t(this,M)||rt(this,M,new Map)},z=new WeakSet,le=function(){if(!t(this,k)){const tt=t(this,it).createElement("div"),{style:gt}=tt;gt.visibility="hidden",gt.contain="strict",gt.width=gt.height=0,gt.position="absolute",gt.top=gt.left=0,gt.zIndex=-1;const yt=t(this,it).createElementNS(et,"svg");yt.setAttribute("width",0),yt.setAttribute("height",0),rt(this,k,t(this,it).createElementNS(et,"defs")),tt.append(yt),yt.append(t(this,k)),t(this,it).body.append(tt)}return t(this,k)},dt=new WeakSet,Ie=function(tt){const gt=t(this,it).createElementNS(et,"feColorMatrix");gt.setAttribute("type","matrix"),gt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),tt.append(gt)},ht=new WeakSet,_e=function(tt){const gt=t(this,it).createElementNS(et,"filter");return gt.setAttribute("color-interpolation-filters","sRGB"),gt.setAttribute("id",tt),t(this,z,le).append(gt),gt},Ct=new WeakSet,Ae=function(tt,gt,yt){const Ft=t(this,it).createElementNS(et,gt);Ft.setAttribute("type","discrete"),Ft.setAttribute("tableValues",yt),tt.append(Ft)},Rt=new WeakSet,fe=function(tt,gt,yt,Ft){const Mt=t(this,it).createElementNS(et,"feComponentTransfer");Ft.append(Mt),Q(this,Ct,Ae).call(this,Mt,"feFuncR",tt),Q(this,Ct,Ae).call(this,Mt,"feFuncG",gt),Q(this,Ct,Ae).call(this,Mt,"feFuncB",yt)},St=new WeakSet,pe=function(tt){return t(this,z,le).style.color=tt,r(getComputedStyle(t(this,z,le)).getPropertyValue("color"))},d.DOMFilterFactory=j;class R extends c.BaseCanvasFactory{constructor({ownerDocument:st=globalThis.document}={}){super(),this._document=st}_createCanvas(st,tt){const gt=this._document.createElement("canvas");return gt.width=st,gt.height=tt,gt}}d.DOMCanvasFactory=R;async function p(vt,st=!1){if(n(vt,document.baseURI)){const tt=await fetch(vt);if(!tt.ok)throw new Error(tt.statusText);return st?new Uint8Array(await tt.arrayBuffer()):(0,x.stringToBytes)(await tt.text())}return new Promise((tt,gt)=>{const yt=new XMLHttpRequest;yt.open("GET",vt,!0),st&&(yt.responseType="arraybuffer"),yt.onreadystatechange=()=>{if(yt.readyState===XMLHttpRequest.DONE){if(yt.status===200||yt.status===0){let Ft;if(st&&yt.response?Ft=new Uint8Array(yt.response):!st&&yt.responseText&&(Ft=(0,x.stringToBytes)(yt.responseText)),Ft){tt(Ft);return}}gt(new Error(yt.statusText))}},yt.send(null)})}class L extends c.BaseCMapReaderFactory{_fetchData(st,tt){return p(st,this.isCompressed).then(gt=>({cMapData:gt,compressionType:tt}))}}d.DOMCMapReaderFactory=L;class B extends c.BaseStandardFontDataFactory{_fetchData(st){return p(st,!0)}}d.DOMStandardFontDataFactory=B;class w extends c.BaseSVGFactory{_createSVG(st){return document.createElementNS(et,st)}}d.DOMSVGFactory=w;class y{constructor({viewBox:st,scale:tt,rotation:gt,offsetX:yt=0,offsetY:Ft=0,dontFlip:Mt=!1}){this.viewBox=st,this.scale=tt,this.rotation=gt,this.offsetX=yt,this.offsetY=Ft;const zt=(st[2]+st[0])/2,It=(st[3]+st[1])/2;let Xt,Wt,Ut,ct;switch(gt%=360,gt<0&&(gt+=360),gt){case 180:Xt=-1,Wt=0,Ut=0,ct=1;break;case 90:Xt=0,Wt=1,Ut=1,ct=0;break;case 270:Xt=0,Wt=-1,Ut=-1,ct=0;break;case 0:Xt=1,Wt=0,Ut=0,ct=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Mt&&(Ut=-Ut,ct=-ct);let q,K,wt,jt;Xt===0?(q=Math.abs(It-st[1])*tt+yt,K=Math.abs(zt-st[0])*tt+Ft,wt=(st[3]-st[1])*tt,jt=(st[2]-st[0])*tt):(q=Math.abs(zt-st[0])*tt+yt,K=Math.abs(It-st[1])*tt+Ft,wt=(st[2]-st[0])*tt,jt=(st[3]-st[1])*tt),this.transform=[Xt*tt,Wt*tt,Ut*tt,ct*tt,q-Xt*tt*zt-Ut*tt*It,K-Wt*tt*zt-ct*tt*It],this.width=wt,this.height=jt}get rawDims(){const{viewBox:st}=this;return(0,x.shadow)(this,"rawDims",{pageWidth:st[2]-st[0],pageHeight:st[3]-st[1],pageX:st[0],pageY:st[1]})}clone({scale:st=this.scale,rotation:tt=this.rotation,offsetX:gt=this.offsetX,offsetY:yt=this.offsetY,dontFlip:Ft=!1}={}){return new y({viewBox:this.viewBox.slice(),scale:st,rotation:tt,offsetX:gt,offsetY:yt,dontFlip:Ft})}convertToViewportPoint(st,tt){return x.Util.applyTransform([st,tt],this.transform)}convertToViewportRectangle(st){const tt=x.Util.applyTransform([st[0],st[1]],this.transform),gt=x.Util.applyTransform([st[2],st[3]],this.transform);return[tt[0],tt[1],gt[0],gt[1]]}convertToPdfPoint(st,tt){return x.Util.applyInverseTransform([st,tt],this.transform)}}d.PageViewport=y;class A extends x.BaseException{constructor(st,tt=0){super(st,"RenderingCancelledException"),this.extraDelay=tt}}d.RenderingCancelledException=A;function f(vt){const st=vt.length;let tt=0;for(;tt<st&&vt[tt].trim()==="";)tt++;return vt.substring(tt,tt+5).toLowerCase()==="data:"}function v(vt){return typeof vt=="string"&&/\.pdf$/i.test(vt)}function E(vt,st=!1){return st||([vt]=vt.split(/[#?]/,1)),vt.substring(vt.lastIndexOf("/")+1)}function P(vt,st="document.pdf"){if(typeof vt!="string")return st;if(f(vt))return(0,x.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),st;const tt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,gt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,yt=tt.exec(vt);let Ft=gt.exec(yt[1])||gt.exec(yt[2])||gt.exec(yt[3]);if(Ft&&(Ft=Ft[0],Ft.includes("%")))try{Ft=gt.exec(decodeURIComponent(Ft))[0]}catch{}return Ft||st}class g{constructor(){Yt(this,"started",Object.create(null));Yt(this,"times",[])}time(st){st in this.started&&(0,x.warn)(`Timer is already running for ${st}`),this.started[st]=Date.now()}timeEnd(st){st in this.started||(0,x.warn)(`Timer has not been started for ${st}`),this.times.push({name:st,start:this.started[st],end:Date.now()}),delete this.started[st]}toString(){const st=[];let tt=0;for(const{name:gt}of this.times)tt=Math.max(gt.length,tt);for(const{name:gt,start:yt,end:Ft}of this.times)st.push(`${gt.padEnd(tt)} ${Ft-yt}ms
`);return st.join("")}}d.StatTimer=g;function n(vt,st){try{const{protocol:tt}=st?new URL(vt,st):new URL(vt);return tt==="http:"||tt==="https:"}catch{return!1}}function o(vt,st=!1){return new Promise((tt,gt)=>{const yt=document.createElement("script");yt.src=vt,yt.onload=function(Ft){st&&yt.remove(),tt(Ft)},yt.onerror=function(){gt(new Error(`Cannot load script at: ${yt.src}`))},(document.head||document.documentElement).append(yt)})}function F(vt){console.log("Deprecated API usage: "+vt)}let b;class s{static toDateObject(st){if(!st||typeof st!="string")return null;b||(b=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const tt=b.exec(st);if(!tt)return null;const gt=parseInt(tt[1],10);let yt=parseInt(tt[2],10);yt=yt>=1&&yt<=12?yt-1:0;let Ft=parseInt(tt[3],10);Ft=Ft>=1&&Ft<=31?Ft:1;let Mt=parseInt(tt[4],10);Mt=Mt>=0&&Mt<=23?Mt:0;let zt=parseInt(tt[5],10);zt=zt>=0&&zt<=59?zt:0;let It=parseInt(tt[6],10);It=It>=0&&It<=59?It:0;const Xt=tt[7]||"Z";let Wt=parseInt(tt[8],10);Wt=Wt>=0&&Wt<=23?Wt:0;let Ut=parseInt(tt[9],10)||0;return Ut=Ut>=0&&Ut<=59?Ut:0,Xt==="-"?(Mt+=Wt,zt+=Ut):Xt==="+"&&(Mt-=Wt,zt-=Ut),new Date(Date.UTC(gt,yt,Ft,Mt,zt,It))}}d.PDFDateString=s;function l(vt,{scale:st=1,rotation:tt=0}){const{width:gt,height:yt}=vt.attributes.style,Ft=[0,0,parseInt(gt),parseInt(yt)];return new y({viewBox:Ft,scale:st,rotation:tt})}function r(vt){if(vt.startsWith("#")){const st=parseInt(vt.slice(1),16);return[(st&16711680)>>16,(st&65280)>>8,st&255]}return vt.startsWith("rgb(")?vt.slice(4,-1).split(",").map(st=>parseInt(st)):vt.startsWith("rgba(")?vt.slice(5,-1).split(",").map(st=>parseInt(st)).slice(0,3):((0,x.warn)(`Not a valid color format: "${vt}"`),[0,0,0])}function I(vt){const st=document.createElement("span");st.style.visibility="hidden",document.body.append(st);for(const tt of vt.keys()){st.style.color=tt;const gt=window.getComputedStyle(st).color;vt.set(tt,r(gt))}st.remove()}function O(vt){const{a:st,b:tt,c:gt,d:yt,e:Ft,f:Mt}=vt.getTransform();return[st,tt,gt,yt,Ft,Mt]}function V(vt){const{a:st,b:tt,c:gt,d:yt,e:Ft,f:Mt}=vt.getTransform().invertSelf();return[st,tt,gt,yt,Ft,Mt]}function _(vt,st,tt=!1,gt=!0){if(st instanceof y){const{pageWidth:yt,pageHeight:Ft}=st.rawDims,{style:Mt}=vt,zt=`calc(var(--scale-factor) * ${yt}px)`,It=`calc(var(--scale-factor) * ${Ft}px)`;!tt||st.rotation%180===0?(Mt.width=zt,Mt.height=It):(Mt.width=It,Mt.height=zt)}gt&&vt.setAttribute("data-main-rotation",st.rotation)}},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.BaseStandardFontDataFactory=d.BaseSVGFactory=d.BaseFilterFactory=d.BaseCanvasFactory=d.BaseCMapReaderFactory=void 0;var c=nt(1);class x{constructor(){this.constructor===x&&(0,c.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(p){return"none"}addHCMFilter(p,L){return"none"}addHighlightHCMFilter(p,L,B,w){return"none"}destroy(p=!1){}}d.BaseFilterFactory=x;class et{constructor(){this.constructor===et&&(0,c.unreachable)("Cannot initialize BaseCanvasFactory.")}create(p,L){if(p<=0||L<=0)throw new Error("Invalid canvas size");const B=this._createCanvas(p,L);return{canvas:B,context:B.getContext("2d")}}reset(p,L,B){if(!p.canvas)throw new Error("Canvas is not specified");if(L<=0||B<=0)throw new Error("Invalid canvas size");p.canvas.width=L,p.canvas.height=B}destroy(p){if(!p.canvas)throw new Error("Canvas is not specified");p.canvas.width=0,p.canvas.height=0,p.canvas=null,p.context=null}_createCanvas(p,L){(0,c.unreachable)("Abstract method `_createCanvas` called.")}}d.BaseCanvasFactory=et;class J{constructor({baseUrl:p=null,isCompressed:L=!0}){this.constructor===J&&(0,c.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=p,this.isCompressed=L}async fetch({name:p}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!p)throw new Error("CMap name must be specified.");const L=this.baseUrl+p+(this.isCompressed?".bcmap":""),B=this.isCompressed?c.CMapCompressionType.BINARY:c.CMapCompressionType.NONE;return this._fetchData(L,B).catch(w=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${L}`)})}_fetchData(p,L){(0,c.unreachable)("Abstract method `_fetchData` called.")}}d.BaseCMapReaderFactory=J;class lt{constructor({baseUrl:p=null}){this.constructor===lt&&(0,c.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=p}async fetch({filename:p}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!p)throw new Error("Font filename must be specified.");const L=`${this.baseUrl}${p}`;return this._fetchData(L).catch(B=>{throw new Error(`Unable to load font data at: ${L}`)})}_fetchData(p){(0,c.unreachable)("Abstract method `_fetchData` called.")}}d.BaseStandardFontDataFactory=lt;class j{constructor(){this.constructor===j&&(0,c.unreachable)("Cannot initialize BaseSVGFactory.")}create(p,L,B=!1){if(p<=0||L<=0)throw new Error("Invalid SVG dimensions");const w=this._createSVG("svg:svg");return w.setAttribute("version","1.1"),B||(w.setAttribute("width",`${p}px`),w.setAttribute("height",`${L}px`)),w.setAttribute("preserveAspectRatio","none"),w.setAttribute("viewBox",`0 0 ${p} ${L}`),w}createElement(p){if(typeof p!="string")throw new Error("Invalid SVG element type");return this._createSVG(p)}_createSVG(p){(0,c.unreachable)("Abstract method `_createSVG` called.")}}d.BaseSVGFactory=j},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.MurmurHash3_64=void 0;var c=nt(1);const x=3285377520,et=4294901760,J=65535;class lt{constructor(R){this.h1=R?R&4294967295:x,this.h2=R?R&4294967295:x}update(R){let p,L;if(typeof R=="string"){p=new Uint8Array(R.length*2),L=0;for(let F=0,b=R.length;F<b;F++){const s=R.charCodeAt(F);s<=255?p[L++]=s:(p[L++]=s>>>8,p[L++]=s&255)}}else if((0,c.isArrayBuffer)(R))p=R.slice(),L=p.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const B=L>>2,w=L-B*4,y=new Uint32Array(p.buffer,0,B);let A=0,f=0,v=this.h1,E=this.h2;const P=3432918353,g=461845907,n=P&J,o=g&J;for(let F=0;F<B;F++)F&1?(A=y[F],A=A*P&et|A*n&J,A=A<<15|A>>>17,A=A*g&et|A*o&J,v^=A,v=v<<13|v>>>19,v=v*5+3864292196):(f=y[F],f=f*P&et|f*n&J,f=f<<15|f>>>17,f=f*g&et|f*o&J,E^=f,E=E<<13|E>>>19,E=E*5+3864292196);switch(A=0,w){case 3:A^=p[B*4+2]<<16;case 2:A^=p[B*4+1]<<8;case 1:A^=p[B*4],A=A*P&et|A*n&J,A=A<<15|A>>>17,A=A*g&et|A*o&J,B&1?v^=A:E^=A}this.h1=v,this.h2=E}hexdigest(){let R=this.h1,p=this.h2;return R^=p>>>1,R=R*3981806797&et|R*36045&J,p=p*4283543511&et|((p<<16|R>>>16)*2950163797&et)>>>16,R^=p>>>1,R=R*444984403&et|R*60499&J,p=p*3301882366&et|((p<<16|R>>>16)*3120437893&et)>>>16,R^=p>>>1,(R>>>0).toString(16).padStart(8,"0")+(p>>>0).toString(16).padStart(8,"0")}}d.MurmurHash3_64=lt},(bt,d,nt)=>{var J;Object.defineProperty(d,"__esModule",{value:!0}),d.FontLoader=d.FontFaceObject=void 0;var c=nt(1);class x{constructor({ownerDocument:j=globalThis.document,styleElement:R=null}){W(this,J,new Set);this._document=j,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(j){this.nativeFontFaces.add(j),this._document.fonts.add(j)}removeNativeFontFace(j){this.nativeFontFaces.delete(j),this._document.fonts.delete(j)}insertRule(j){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const R=this.styleElement.sheet;R.insertRule(j,R.cssRules.length)}clear(){for(const j of this.nativeFontFaces)this._document.fonts.delete(j);this.nativeFontFaces.clear(),t(this,J).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(j){if(!(!j||t(this,J).has(j.loadedName))){if((0,c.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:R,src:p,style:L}=j,B=new FontFace(R,p,L);this.addNativeFontFace(B);try{await B.load(),t(this,J).add(R)}catch{(0,c.warn)(`Cannot load system font: ${j.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(B)}return}(0,c.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(j){if(j.attached||j.missingFile&&!j.systemFontInfo)return;if(j.attached=!0,j.systemFontInfo){await this.loadSystemFont(j.systemFontInfo);return}if(this.isFontLoadingAPISupported){const p=j.createNativeFontFace();if(p){this.addNativeFontFace(p);try{await p.loaded}catch(L){throw(0,c.warn)(`Failed to load font '${p.family}': '${L}'.`),j.disableFontFace=!0,L}}return}const R=j.createFontFaceRule();if(R){if(this.insertRule(R),this.isSyncFontLoadingSupported)return;await new Promise(p=>{const L=this._queueLoadingCallback(p);this._prepareFontLoadEvent(j,L)})}}get isFontLoadingAPISupported(){var R;const j=!!((R=this._document)!=null&&R.fonts);return(0,c.shadow)(this,"isFontLoadingAPISupported",j)}get isSyncFontLoadingSupported(){let j=!1;return(c.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(j=!0),(0,c.shadow)(this,"isSyncFontLoadingSupported",j)}_queueLoadingCallback(j){function R(){for((0,c.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;p.length>0&&p[0].done;){const B=p.shift();setTimeout(B.callback,0)}}const{loadingRequests:p}=this,L={done:!1,complete:R,callback:j};return p.push(L),L}get _loadTestFont(){const j=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,c.shadow)(this,"_loadTestFont",j)}_prepareFontLoadEvent(j,R){function p(r,I){return r.charCodeAt(I)<<24|r.charCodeAt(I+1)<<16|r.charCodeAt(I+2)<<8|r.charCodeAt(I+3)&255}function L(r,I,O,V){const _=r.substring(0,I),G=r.substring(I+O);return _+V+G}let B,w;const y=this._document.createElement("canvas");y.width=1,y.height=1;const A=y.getContext("2d");let f=0;function v(r,I){if(++f>30){(0,c.warn)("Load test font never loaded."),I();return}if(A.font="30px "+r,A.fillText(".",0,20),A.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(v.bind(null,r,I))}const E=`lt${Date.now()}${this.loadTestFontId++}`;let P=this._loadTestFont;P=L(P,976,E.length,E);const n=16,o=1482184792;let F=p(P,n);for(B=0,w=E.length-3;B<w;B+=4)F=F-o+p(E,B)|0;B<E.length&&(F=F-o+p(E+"XXX",B)|0),P=L(P,n,4,(0,c.string32)(F));const b=`url(data:font/opentype;base64,${btoa(P)});`,s=`@font-face {font-family:"${E}";src:${b}}`;this.insertRule(s);const l=this._document.createElement("div");l.style.visibility="hidden",l.style.width=l.style.height="10px",l.style.position="absolute",l.style.top=l.style.left="0px";for(const r of[j.loadedName,E]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=r,l.append(I)}this._document.body.append(l),v(E,()=>{l.remove(),R.complete()})}}J=new WeakMap,d.FontLoader=x;class et{constructor(j,{isEvalSupported:R=!0,disableFontFace:p=!1,ignoreErrors:L=!1,inspectFont:B=null}){this.compiledGlyphs=Object.create(null);for(const w in j)this[w]=j[w];this.isEvalSupported=R!==!1,this.disableFontFace=p===!0,this.ignoreErrors=L===!0,this._inspectFont=B}createNativeFontFace(){var R;if(!this.data||this.disableFontFace)return null;let j;if(!this.cssFontInfo)j=new FontFace(this.loadedName,this.data,{});else{const p={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(p.style=`oblique ${this.cssFontInfo.italicAngle}deg`),j=new FontFace(this.cssFontInfo.fontFamily,this.data,p)}return(R=this._inspectFont)==null||R.call(this,this),j}createFontFaceRule(){var L;if(!this.data||this.disableFontFace)return null;const j=(0,c.bytesToString)(this.data),R=`url(data:${this.mimetype};base64,${btoa(j)});`;let p;if(!this.cssFontInfo)p=`@font-face {font-family:"${this.loadedName}";src:${R}}`;else{let B=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(B+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),p=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${B}src:${R}}`}return(L=this._inspectFont)==null||L.call(this,this,R),p}getPathGenerator(j,R){if(this.compiledGlyphs[R]!==void 0)return this.compiledGlyphs[R];let p;try{p=j.get(this.loadedName+"_path_"+R)}catch(L){if(!this.ignoreErrors)throw L;return(0,c.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[R]=function(B,w){}}if(this.isEvalSupported&&c.FeatureTest.isEvalSupported){const L=[];for(const B of p){const w=B.args!==void 0?B.args.join(","):"";L.push("c.",B.cmd,"(",w,`);
`)}return this.compiledGlyphs[R]=new Function("c","size",L.join(""))}return this.compiledGlyphs[R]=function(L,B){for(const w of p)w.cmd==="scale"&&(w.args=[B,-B]),L[w.cmd].apply(L,w.args)}}}d.FontFaceObject=et},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NodeStandardFontDataFactory=d.NodeFilterFactory=d.NodeCanvasFactory=d.NodeCMapReaderFactory=void 0;var c=nt(7);nt(1);const x=function(R){return new Promise((p,L)=>{require$$5.readFile(R,(w,y)=>{if(w||!y){L(new Error(w));return}p(new Uint8Array(y))})})};class et extends c.BaseFilterFactory{}d.NodeFilterFactory=et;class J extends c.BaseCanvasFactory{_createCanvas(p,L){return require$$5.createCanvas(p,L)}}d.NodeCanvasFactory=J;class lt extends c.BaseCMapReaderFactory{_fetchData(p,L){return x(p).then(B=>({cMapData:B,compressionType:L}))}}d.NodeCMapReaderFactory=lt;class j extends c.BaseStandardFontDataFactory{_fetchData(p){return x(p)}}d.NodeStandardFontDataFactory=j},(bt,d,nt)=>{var k,Oe,it,Le;Object.defineProperty(d,"__esModule",{value:!0}),d.CanvasGraphics=void 0;var c=nt(1),x=nt(6),et=nt(12),J=nt(13);const lt=16,j=100,R=4096,p=15,L=10,B=1e3,w=16;function y(D,i){if(D._removeMirroring)throw new Error("Context is already forwarding operations.");D.__originalSave=D.save,D.__originalRestore=D.restore,D.__originalRotate=D.rotate,D.__originalScale=D.scale,D.__originalTranslate=D.translate,D.__originalTransform=D.transform,D.__originalSetTransform=D.setTransform,D.__originalResetTransform=D.resetTransform,D.__originalClip=D.clip,D.__originalMoveTo=D.moveTo,D.__originalLineTo=D.lineTo,D.__originalBezierCurveTo=D.bezierCurveTo,D.__originalRect=D.rect,D.__originalClosePath=D.closePath,D.__originalBeginPath=D.beginPath,D._removeMirroring=()=>{D.save=D.__originalSave,D.restore=D.__originalRestore,D.rotate=D.__originalRotate,D.scale=D.__originalScale,D.translate=D.__originalTranslate,D.transform=D.__originalTransform,D.setTransform=D.__originalSetTransform,D.resetTransform=D.__originalResetTransform,D.clip=D.__originalClip,D.moveTo=D.__originalMoveTo,D.lineTo=D.__originalLineTo,D.bezierCurveTo=D.__originalBezierCurveTo,D.rect=D.__originalRect,D.closePath=D.__originalClosePath,D.beginPath=D.__originalBeginPath,delete D._removeMirroring},D.save=function(){i.save(),this.__originalSave()},D.restore=function(){i.restore(),this.__originalRestore()},D.translate=function(m,N){i.translate(m,N),this.__originalTranslate(m,N)},D.scale=function(m,N){i.scale(m,N),this.__originalScale(m,N)},D.transform=function(m,N,T,H,z,Y){i.transform(m,N,T,H,z,Y),this.__originalTransform(m,N,T,H,z,Y)},D.setTransform=function(m,N,T,H,z,Y){i.setTransform(m,N,T,H,z,Y),this.__originalSetTransform(m,N,T,H,z,Y)},D.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},D.rotate=function(m){i.rotate(m),this.__originalRotate(m)},D.clip=function(m){i.clip(m),this.__originalClip(m)},D.moveTo=function(e,m){i.moveTo(e,m),this.__originalMoveTo(e,m)},D.lineTo=function(e,m){i.lineTo(e,m),this.__originalLineTo(e,m)},D.bezierCurveTo=function(e,m,N,T,H,z){i.bezierCurveTo(e,m,N,T,H,z),this.__originalBezierCurveTo(e,m,N,T,H,z)},D.rect=function(e,m,N,T){i.rect(e,m,N,T),this.__originalRect(e,m,N,T)},D.closePath=function(){i.closePath(),this.__originalClosePath()},D.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class A{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,e,m){let N;return this.cache[i]!==void 0?(N=this.cache[i],this.canvasFactory.reset(N,e,m)):(N=this.canvasFactory.create(e,m),this.cache[i]=N),N}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const e=this.cache[i];this.canvasFactory.destroy(e),delete this.cache[i]}}}function f(D,i,e,m,N,T,H,z,Y,dt){const[at,ht,ft,Ct,At,Rt]=(0,x.getCurrentTransform)(D);if(ht===0&&ft===0){const Nt=H*at+At,vt=Math.round(Nt),st=z*Ct+Rt,tt=Math.round(st),gt=(H+Y)*at+At,yt=Math.abs(Math.round(gt)-vt)||1,Ft=(z+dt)*Ct+Rt,Mt=Math.abs(Math.round(Ft)-tt)||1;return D.setTransform(Math.sign(at),0,0,Math.sign(Ct),vt,tt),D.drawImage(i,e,m,N,T,0,0,yt,Mt),D.setTransform(at,ht,ft,Ct,At,Rt),[yt,Mt]}if(at===0&&Ct===0){const Nt=z*ft+At,vt=Math.round(Nt),st=H*ht+Rt,tt=Math.round(st),gt=(z+dt)*ft+At,yt=Math.abs(Math.round(gt)-vt)||1,Ft=(H+Y)*ht+Rt,Mt=Math.abs(Math.round(Ft)-tt)||1;return D.setTransform(0,Math.sign(ht),Math.sign(ft),0,vt,tt),D.drawImage(i,e,m,N,T,0,0,Mt,yt),D.setTransform(at,ht,ft,Ct,At,Rt),[Mt,yt]}D.drawImage(i,e,m,N,T,H,z,Y,dt);const Ht=Math.hypot(at,ht),St=Math.hypot(ft,Ct);return[Ht*Y,St*dt]}function v(D){const{width:i,height:e}=D;if(i>B||e>B)return null;const m=1e3,N=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),T=i+1;let H=new Uint8Array(T*(e+1)),z,Y,dt;const at=i+7&-8;let ht=new Uint8Array(at*e),ft=0;for(const St of D.data){let Nt=128;for(;Nt>0;)ht[ft++]=St&Nt?0:255,Nt>>=1}let Ct=0;for(ft=0,ht[ft]!==0&&(H[0]=1,++Ct),Y=1;Y<i;Y++)ht[ft]!==ht[ft+1]&&(H[Y]=ht[ft]?2:1,++Ct),ft++;for(ht[ft]!==0&&(H[Y]=2,++Ct),z=1;z<e;z++){ft=z*at,dt=z*T,ht[ft-at]!==ht[ft]&&(H[dt]=ht[ft]?1:8,++Ct);let St=(ht[ft]?4:0)+(ht[ft-at]?8:0);for(Y=1;Y<i;Y++)St=(St>>2)+(ht[ft+1]?4:0)+(ht[ft-at+1]?8:0),N[St]&&(H[dt+Y]=N[St],++Ct),ft++;if(ht[ft-at]!==ht[ft]&&(H[dt+Y]=ht[ft]?2:4,++Ct),Ct>m)return null}for(ft=at*(e-1),dt=z*T,ht[ft]!==0&&(H[dt]=8,++Ct),Y=1;Y<i;Y++)ht[ft]!==ht[ft+1]&&(H[dt+Y]=ht[ft]?4:8,++Ct),ft++;if(ht[ft]!==0&&(H[dt+Y]=4,++Ct),Ct>m)return null;const At=new Int32Array([0,T,-1,0,-T,0,0,0,1]),Rt=new Path2D;for(z=0;Ct&&z<=e;z++){let St=z*T;const Nt=St+i;for(;St<Nt&&!H[St];)St++;if(St===Nt)continue;Rt.moveTo(St%T,z);const vt=St;let st=H[St];do{const tt=At[st];do St+=tt;while(!H[St]);const gt=H[St];gt!==5&&gt!==10?(st=gt,H[St]=0):(st=gt&51*st>>4,H[St]&=st>>2|st<<2),Rt.lineTo(St%T,St/T|0),H[St]||--Ct}while(vt!==St);--z}return ht=null,H=null,function(St){St.save(),St.scale(1/i,-1/e),St.translate(0,-e),St.fill(Rt),St.beginPath(),St.restore()}}class E{constructor(i,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=c.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=c.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,e])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,e){this.x=i,this.y=e}updatePathMinMax(i,e,m){[e,m]=c.Util.applyTransform([e,m],i),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,m),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,m)}updateRectMinMax(i,e){const m=c.Util.applyTransform(e,i),N=c.Util.applyTransform(e.slice(2),i);this.minX=Math.min(this.minX,m[0],N[0]),this.minY=Math.min(this.minY,m[1],N[1]),this.maxX=Math.max(this.maxX,m[0],N[0]),this.maxY=Math.max(this.maxY,m[1],N[1])}updateScalingPathMinMax(i,e){c.Util.scaleMinMax(i,e),this.minX=Math.min(this.minX,e[0]),this.maxX=Math.max(this.maxX,e[1]),this.minY=Math.min(this.minY,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(i,e,m,N,T,H,z,Y,dt,at){const ht=c.Util.bezierBoundingBox(e,m,N,T,H,z,Y,dt);if(at){at[0]=Math.min(at[0],ht[0],ht[2]),at[1]=Math.max(at[1],ht[0],ht[2]),at[2]=Math.min(at[2],ht[1],ht[3]),at[3]=Math.max(at[3],ht[1],ht[3]);return}this.updateRectMinMax(i,ht)}getPathBoundingBox(i=et.PathType.FILL,e=null){const m=[this.minX,this.minY,this.maxX,this.maxY];if(i===et.PathType.STROKE){e||(0,c.unreachable)("Stroke bounding box must include transform.");const N=c.Util.singularValueDecompose2dScale(e),T=N[0]*this.lineWidth/2,H=N[1]*this.lineWidth/2;m[0]-=T,m[1]-=H,m[2]+=T,m[3]+=H}return m}updateClipFromPath(){const i=c.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=et.PathType.FILL,e=null){return c.Util.intersect(this.clipBox,this.getPathBoundingBox(i,e))}}function P(D,i){if(typeof ImageData<"u"&&i instanceof ImageData){D.putImageData(i,0,0);return}const e=i.height,m=i.width,N=e%w,T=(e-N)/w,H=N===0?T:T+1,z=D.createImageData(m,w);let Y=0,dt;const at=i.data,ht=z.data;let ft,Ct,At,Rt;if(i.kind===c.ImageKind.GRAYSCALE_1BPP){const Ht=at.byteLength,St=new Uint32Array(ht.buffer,0,ht.byteLength>>2),Nt=St.length,vt=m+7>>3,st=4294967295,tt=c.FeatureTest.isLittleEndian?4278190080:255;for(ft=0;ft<H;ft++){for(At=ft<T?w:N,dt=0,Ct=0;Ct<At;Ct++){const gt=Ht-Y;let yt=0;const Ft=gt>vt?m:gt*8-7,Mt=Ft&-8;let zt=0,It=0;for(;yt<Mt;yt+=8)It=at[Y++],St[dt++]=It&128?st:tt,St[dt++]=It&64?st:tt,St[dt++]=It&32?st:tt,St[dt++]=It&16?st:tt,St[dt++]=It&8?st:tt,St[dt++]=It&4?st:tt,St[dt++]=It&2?st:tt,St[dt++]=It&1?st:tt;for(;yt<Ft;yt++)zt===0&&(It=at[Y++],zt=128),St[dt++]=It&zt?st:tt,zt>>=1}for(;dt<Nt;)St[dt++]=0;D.putImageData(z,0,ft*w)}}else if(i.kind===c.ImageKind.RGBA_32BPP){for(Ct=0,Rt=m*w*4,ft=0;ft<T;ft++)ht.set(at.subarray(Y,Y+Rt)),Y+=Rt,D.putImageData(z,0,Ct),Ct+=w;ft<H&&(Rt=m*N*4,ht.set(at.subarray(Y,Y+Rt)),D.putImageData(z,0,Ct))}else if(i.kind===c.ImageKind.RGB_24BPP)for(At=w,Rt=m*At,ft=0;ft<H;ft++){for(ft>=T&&(At=N,Rt=m*At),dt=0,Ct=Rt;Ct--;)ht[dt++]=at[Y++],ht[dt++]=at[Y++],ht[dt++]=at[Y++],ht[dt++]=255;D.putImageData(z,0,ft*w)}else throw new Error(`bad image kind: ${i.kind}`)}function g(D,i){if(i.bitmap){D.drawImage(i.bitmap,0,0);return}const e=i.height,m=i.width,N=e%w,T=(e-N)/w,H=N===0?T:T+1,z=D.createImageData(m,w);let Y=0;const dt=i.data,at=z.data;for(let ht=0;ht<H;ht++){const ft=ht<T?w:N;({srcPos:Y}=(0,J.convertBlackAndWhiteToRGBA)({src:dt,srcPos:Y,dest:at,width:m,height:ft,nonBlackColor:0})),D.putImageData(z,0,ht*w)}}function n(D,i){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const m of e)D[m]!==void 0&&(i[m]=D[m]);D.setLineDash!==void 0&&(i.setLineDash(D.getLineDash()),i.lineDashOffset=D.lineDashOffset)}function o(D){if(D.strokeStyle=D.fillStyle="#000000",D.fillRule="nonzero",D.globalAlpha=1,D.lineWidth=1,D.lineCap="butt",D.lineJoin="miter",D.miterLimit=10,D.globalCompositeOperation="source-over",D.font="10px sans-serif",D.setLineDash!==void 0&&(D.setLineDash([]),D.lineDashOffset=0),!c.isNodeJS){const{filter:i}=D;i!=="none"&&i!==""&&(D.filter="none")}}function F(D,i,e,m){const N=D.length;for(let T=3;T<N;T+=4){const H=D[T];if(H===0)D[T-3]=i,D[T-2]=e,D[T-1]=m;else if(H<255){const z=255-H;D[T-3]=D[T-3]*H+i*z>>8,D[T-2]=D[T-2]*H+e*z>>8,D[T-1]=D[T-1]*H+m*z>>8}}}function b(D,i,e){const m=D.length,N=1/255;for(let T=3;T<m;T+=4){const H=e?e[D[T]]:D[T];i[T]=i[T]*H*N|0}}function s(D,i,e){const m=D.length;for(let N=3;N<m;N+=4){const T=D[N-3]*77+D[N-2]*152+D[N-1]*28;i[N]=e?i[N]*e[T>>8]>>8:i[N]*T>>16}}function l(D,i,e,m,N,T,H,z,Y,dt,at){const ht=!!T,ft=ht?T[0]:0,Ct=ht?T[1]:0,At=ht?T[2]:0,Rt=N==="Luminosity"?s:b,St=Math.min(m,Math.ceil(1048576/e));for(let Nt=0;Nt<m;Nt+=St){const vt=Math.min(St,m-Nt),st=D.getImageData(z-dt,Nt+(Y-at),e,vt),tt=i.getImageData(z,Nt+Y,e,vt);ht&&F(st.data,ft,Ct,At),Rt(st.data,tt.data,H),i.putImageData(tt,z,Nt+Y)}}function r(D,i,e,m){const N=m[0],T=m[1],H=m[2]-N,z=m[3]-T;H===0||z===0||(l(i.context,e,H,z,i.subtype,i.backdrop,i.transferMap,N,T,i.offsetX,i.offsetY),D.save(),D.globalAlpha=1,D.globalCompositeOperation="source-over",D.setTransform(1,0,0,1,0,0),D.drawImage(e.canvas,0,0),D.restore())}function I(D,i){const e=c.Util.singularValueDecompose2dScale(D);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const m=Math.fround((globalThis.devicePixelRatio||1)*x.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:e[0]<=m||e[1]<=m}const O=["butt","round","square"],V=["miter","round","bevel"],_={},G={},_t=class{constructor(i,e,m,N,T,{optionalContentConfig:H,markedContentStack:z=null},Y,dt){W(this,k);W(this,it);this.ctx=i,this.current=new E(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=m,this.canvasFactory=N,this.filterFactory=T,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=z||[],this.optionalContentConfig=H,this.cachedCanvases=new A(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Y,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=dt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,e=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):e}beginDrawing({transform:i,viewport:e,transparency:m=!1,background:N=null}){const T=this.ctx.canvas.width,H=this.ctx.canvas.height,z=this.ctx.fillStyle;if(this.ctx.fillStyle=N||"#ffffff",this.ctx.fillRect(0,0,T,H),this.ctx.fillStyle=z,m){const Y=this.cachedCanvases.getCanvas("transparent",T,H);this.compositeCtx=this.ctx,this.transparentCanvas=Y.canvas,this.ctx=Y.context,this.ctx.save(),this.ctx.transform(...(0,x.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),o(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=(0,x.getCurrentTransform)(this.ctx)}executeOperatorList(i,e,m,N){const T=i.argsArray,H=i.fnArray;let z=e||0;const Y=T.length;if(Y===z)return z;const dt=Y-z>L&&typeof m=="function",at=dt?Date.now()+p:0;let ht=0;const ft=this.commonObjs,Ct=this.objs;let At;for(;;){if(N!==void 0&&z===N.nextBreakPoint)return N.breakIt(z,m),z;if(At=H[z],At!==c.OPS.dependency)this[At].apply(this,T[z]);else for(const Rt of T[z]){const Ht=Rt.startsWith("g_")?ft:Ct;if(!Ht.has(Rt))return Ht.get(Rt,m),z}if(z++,z===Y)return z;if(dt&&++ht>L){if(Date.now()>at)return m(),z;ht=0}}}endDrawing(){Q(this,k,Oe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const e of i.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);i.clear()}this._cachedBitmapsMap.clear(),Q(this,it,Le).call(this)}_scaleImage(i,e){const m=i.width,N=i.height;let T=Math.max(Math.hypot(e[0],e[1]),1),H=Math.max(Math.hypot(e[2],e[3]),1),z=m,Y=N,dt="prescale1",at,ht;for(;T>2&&z>1||H>2&&Y>1;){let ft=z,Ct=Y;T>2&&z>1&&(ft=z>=16384?Math.floor(z/2)-1||1:Math.ceil(z/2),T/=z/ft),H>2&&Y>1&&(Ct=Y>=16384?Math.floor(Y/2)-1||1:Math.ceil(Y)/2,H/=Y/Ct),at=this.cachedCanvases.getCanvas(dt,ft,Ct),ht=at.context,ht.clearRect(0,0,ft,Ct),ht.drawImage(i,0,0,z,Y,0,0,ft,Ct),i=at.canvas,z=ft,Y=Ct,dt=dt==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:z,paintHeight:Y}}_createMaskCanvas(i){const e=this.ctx,{width:m,height:N}=i,T=this.current.fillColor,H=this.current.patternFill,z=(0,x.getCurrentTransform)(e);let Y,dt,at,ht;if((i.bitmap||i.data)&&i.count>1){const yt=i.bitmap||i.data.buffer;dt=JSON.stringify(H?z:[z.slice(0,4),T]),Y=this._cachedBitmapsMap.get(yt),Y||(Y=new Map,this._cachedBitmapsMap.set(yt,Y));const Ft=Y.get(dt);if(Ft&&!H){const Mt=Math.round(Math.min(z[0],z[2])+z[4]),zt=Math.round(Math.min(z[1],z[3])+z[5]);return{canvas:Ft,offsetX:Mt,offsetY:zt}}at=Ft}at||(ht=this.cachedCanvases.getCanvas("maskCanvas",m,N),g(ht.context,i));let ft=c.Util.transform(z,[1/m,0,0,-1/N,0,0]);ft=c.Util.transform(ft,[1,0,0,1,0,-N]);const Ct=c.Util.applyTransform([0,0],ft),At=c.Util.applyTransform([m,N],ft),Rt=c.Util.normalizeRect([Ct[0],Ct[1],At[0],At[1]]),Ht=Math.round(Rt[2]-Rt[0])||1,St=Math.round(Rt[3]-Rt[1])||1,Nt=this.cachedCanvases.getCanvas("fillCanvas",Ht,St),vt=Nt.context,st=Math.min(Ct[0],At[0]),tt=Math.min(Ct[1],At[1]);vt.translate(-st,-tt),vt.transform(...ft),at||(at=this._scaleImage(ht.canvas,(0,x.getCurrentTransformInverse)(vt)),at=at.img,Y&&H&&Y.set(dt,at)),vt.imageSmoothingEnabled=I((0,x.getCurrentTransform)(vt),i.interpolate),f(vt,at,0,0,at.width,at.height,0,0,m,N),vt.globalCompositeOperation="source-in";const gt=c.Util.transform((0,x.getCurrentTransformInverse)(vt),[1,0,0,1,-st,-tt]);return vt.fillStyle=H?T.getPattern(e,this,gt,et.PathType.FILL):T,vt.fillRect(0,0,m,N),Y&&!H&&(this.cachedCanvases.delete("fillCanvas"),Y.set(dt,Nt.canvas)),{canvas:Nt.canvas,offsetX:Math.round(st),offsetY:Math.round(tt)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=O[i]}setLineJoin(i){this.ctx.lineJoin=V[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,e){const m=this.ctx;m.setLineDash!==void 0&&(m.setLineDash(i),m.lineDashOffset=e)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[e,m]of i)switch(e){case"LW":this.setLineWidth(m);break;case"LC":this.setLineCap(m);break;case"LJ":this.setLineJoin(m);break;case"ML":this.setMiterLimit(m);break;case"D":this.setDash(m[0],m[1]);break;case"RI":this.setRenderingIntent(m);break;case"FL":this.setFlatness(m);break;case"Font":this.setFont(m[0],m[1]);break;case"CA":this.current.strokeAlpha=m;break;case"ca":this.current.fillAlpha=m,this.ctx.globalAlpha=m;break;case"BM":this.ctx.globalCompositeOperation=m;break;case"SMask":this.current.activeSMask=m?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(m);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,e=this.ctx.canvas.height,m="smaskGroupAt"+this.groupLevel,N=this.cachedCanvases.getCanvas(m,i,e);this.suspendedCtx=this.ctx,this.ctx=N.context;const T=this.ctx;T.setTransform(...(0,x.getCurrentTransform)(this.suspendedCtx)),n(this.suspendedCtx,T),y(T,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,m=this.suspendedCtx;r(m,e,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,e,m,N,T,H){this.ctx.transform(i,e,m,N,T,H),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,e,m){const N=this.ctx,T=this.current;let H=T.x,z=T.y,Y,dt;const at=(0,x.getCurrentTransform)(N),ht=at[0]===0&&at[3]===0||at[1]===0&&at[2]===0,ft=ht?m.slice(0):null;for(let Ct=0,At=0,Rt=i.length;Ct<Rt;Ct++)switch(i[Ct]|0){case c.OPS.rectangle:H=e[At++],z=e[At++];const Ht=e[At++],St=e[At++],Nt=H+Ht,vt=z+St;N.moveTo(H,z),Ht===0||St===0?N.lineTo(Nt,vt):(N.lineTo(Nt,z),N.lineTo(Nt,vt),N.lineTo(H,vt)),ht||T.updateRectMinMax(at,[H,z,Nt,vt]),N.closePath();break;case c.OPS.moveTo:H=e[At++],z=e[At++],N.moveTo(H,z),ht||T.updatePathMinMax(at,H,z);break;case c.OPS.lineTo:H=e[At++],z=e[At++],N.lineTo(H,z),ht||T.updatePathMinMax(at,H,z);break;case c.OPS.curveTo:Y=H,dt=z,H=e[At+4],z=e[At+5],N.bezierCurveTo(e[At],e[At+1],e[At+2],e[At+3],H,z),T.updateCurvePathMinMax(at,Y,dt,e[At],e[At+1],e[At+2],e[At+3],H,z,ft),At+=6;break;case c.OPS.curveTo2:Y=H,dt=z,N.bezierCurveTo(H,z,e[At],e[At+1],e[At+2],e[At+3]),T.updateCurvePathMinMax(at,Y,dt,H,z,e[At],e[At+1],e[At+2],e[At+3],ft),H=e[At+2],z=e[At+3],At+=4;break;case c.OPS.curveTo3:Y=H,dt=z,H=e[At+2],z=e[At+3],N.bezierCurveTo(e[At],e[At+1],H,z,H,z),T.updateCurvePathMinMax(at,Y,dt,e[At],e[At+1],H,z,H,z,ft),At+=4;break;case c.OPS.closePath:N.closePath();break}ht&&T.updateScalingPathMinMax(at,ft),T.setCurrentPoint(H,z)}closePath(){this.ctx.closePath()}stroke(i=!0){const e=this.ctx,m=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof m=="object"&&(m!=null&&m.getPattern)?(e.save(),e.strokeStyle=m.getPattern(e,this,(0,x.getCurrentTransformInverse)(e),et.PathType.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const e=this.ctx,m=this.current.fillColor,N=this.current.patternFill;let T=!1;N&&(e.save(),e.fillStyle=m.getPattern(e,this,(0,x.getCurrentTransformInverse)(e),et.PathType.FILL),T=!0);const H=this.current.getClippedPathBoundingBox();this.contentVisible&&H!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),T&&e.restore(),i&&this.consumePath(H)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=_}eoClip(){this.pendingClip=G}beginText(){this.current.textMatrix=c.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,e=this.ctx;if(i===void 0){e.beginPath();return}e.save(),e.beginPath();for(const m of i)e.setTransform(...m.transform),e.translate(m.x,m.y),m.addToPath(e,m.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,e){var at;const m=this.commonObjs.get(i),N=this.current;if(!m)throw new Error(`Can't find font for ${i}`);if(N.fontMatrix=m.fontMatrix||c.FONT_IDENTITY_MATRIX,(N.fontMatrix[0]===0||N.fontMatrix[3]===0)&&(0,c.warn)("Invalid font matrix for font "+i),e<0?(e=-e,N.fontDirection=-1):N.fontDirection=1,this.current.font=m,this.current.fontSize=e,m.isType3Font)return;const T=m.loadedName||"sans-serif",H=((at=m.systemFontInfo)==null?void 0:at.css)||`"${T}", ${m.fallbackName}`;let z="normal";m.black?z="900":m.bold&&(z="bold");const Y=m.italic?"italic":"normal";let dt=e;e<lt?dt=lt:e>j&&(dt=j),this.current.fontSizeScale=e/dt,this.ctx.font=`${Y} ${z} ${dt}px ${H}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,e){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=e}setLeadingMoveText(i,e){this.setLeading(-e),this.moveText(i,e)}setTextMatrix(i,e,m,N,T,H){this.current.textMatrix=[i,e,m,N,T,H],this.current.textMatrixScale=Math.hypot(i,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,e,m,N){const T=this.ctx,H=this.current,z=H.font,Y=H.textRenderingMode,dt=H.fontSize/H.fontSizeScale,at=Y&c.TextRenderingMode.FILL_STROKE_MASK,ht=!!(Y&c.TextRenderingMode.ADD_TO_PATH_FLAG),ft=H.patternFill&&!z.missingFile;let Ct;(z.disableFontFace||ht||ft)&&(Ct=z.getPathGenerator(this.commonObjs,i)),z.disableFontFace||ft?(T.save(),T.translate(e,m),T.beginPath(),Ct(T,dt),N&&T.setTransform(...N),(at===c.TextRenderingMode.FILL||at===c.TextRenderingMode.FILL_STROKE)&&T.fill(),(at===c.TextRenderingMode.STROKE||at===c.TextRenderingMode.FILL_STROKE)&&T.stroke(),T.restore()):((at===c.TextRenderingMode.FILL||at===c.TextRenderingMode.FILL_STROKE)&&T.fillText(i,e,m),(at===c.TextRenderingMode.STROKE||at===c.TextRenderingMode.FILL_STROKE)&&T.strokeText(i,e,m)),ht&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,x.getCurrentTransform)(T),x:e,y:m,fontSize:dt,addToPath:Ct})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const e=i.getImageData(0,0,10,10).data;let m=!1;for(let N=3;N<e.length;N+=4)if(e[N]>0&&e[N]<255){m=!0;break}return(0,c.shadow)(this,"isFontSubpixelAAEnabled",m)}showText(i){const e=this.current,m=e.font;if(m.isType3Font)return this.showType3Text(i);const N=e.fontSize;if(N===0)return;const T=this.ctx,H=e.fontSizeScale,z=e.charSpacing,Y=e.wordSpacing,dt=e.fontDirection,at=e.textHScale*dt,ht=i.length,ft=m.vertical,Ct=ft?1:-1,At=m.defaultVMetrics,Rt=N*e.fontMatrix[0],Ht=e.textRenderingMode===c.TextRenderingMode.FILL&&!m.disableFontFace&&!e.patternFill;T.save(),T.transform(...e.textMatrix),T.translate(e.x,e.y+e.textRise),dt>0?T.scale(at,-1):T.scale(at,1);let St;if(e.patternFill){T.save();const gt=e.fillColor.getPattern(T,this,(0,x.getCurrentTransformInverse)(T),et.PathType.FILL);St=(0,x.getCurrentTransform)(T),T.restore(),T.fillStyle=gt}let Nt=e.lineWidth;const vt=e.textMatrixScale;if(vt===0||Nt===0){const gt=e.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;(gt===c.TextRenderingMode.STROKE||gt===c.TextRenderingMode.FILL_STROKE)&&(Nt=this.getSinglePixelWidth())}else Nt/=vt;if(H!==1&&(T.scale(H,H),Nt/=H),T.lineWidth=Nt,m.isInvalidPDFjsFont){const gt=[];let yt=0;for(const Ft of i)gt.push(Ft.unicode),yt+=Ft.width;T.fillText(gt.join(""),0,0),e.x+=yt*Rt*at,T.restore(),this.compose();return}let st=0,tt;for(tt=0;tt<ht;++tt){const gt=i[tt];if(typeof gt=="number"){st+=Ct*gt*N/1e3;continue}let yt=!1;const Ft=(gt.isSpace?Y:0)+z,Mt=gt.fontChar,zt=gt.accent;let It,Xt,Wt=gt.width;if(ft){const ct=gt.vmetric||At,q=-(gt.vmetric?ct[1]:Wt*.5)*Rt,K=ct[2]*Rt;Wt=ct?-ct[0]:Wt,It=q/H,Xt=(st+K)/H}else It=st/H,Xt=0;if(m.remeasure&&Wt>0){const ct=T.measureText(Mt).width*1e3/N*H;if(Wt<ct&&this.isFontSubpixelAAEnabled){const q=Wt/ct;yt=!0,T.save(),T.scale(q,1),It/=q}else Wt!==ct&&(It+=(Wt-ct)/2e3*N/H)}if(this.contentVisible&&(gt.isInFont||m.missingFile)){if(Ht&&!zt)T.fillText(Mt,It,Xt);else if(this.paintChar(Mt,It,Xt,St),zt){const ct=It+N*zt.offset.x/H,q=Xt-N*zt.offset.y/H;this.paintChar(zt.fontChar,ct,q,St)}}const Ut=ft?Wt*Rt-Ft*dt:Wt*Rt+Ft*dt;st+=Ut,yt&&T.restore()}ft?e.y-=st:e.x+=st*at,T.restore(),this.compose()}showType3Text(i){const e=this.ctx,m=this.current,N=m.font,T=m.fontSize,H=m.fontDirection,z=N.vertical?1:-1,Y=m.charSpacing,dt=m.wordSpacing,at=m.textHScale*H,ht=m.fontMatrix||c.FONT_IDENTITY_MATRIX,ft=i.length,Ct=m.textRenderingMode===c.TextRenderingMode.INVISIBLE;let At,Rt,Ht,St;if(!(Ct||T===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...m.textMatrix),e.translate(m.x,m.y),e.scale(at,H),At=0;At<ft;++At){if(Rt=i[At],typeof Rt=="number"){St=z*Rt*T/1e3,this.ctx.translate(St,0),m.x+=St*at;continue}const Nt=(Rt.isSpace?dt:0)+Y,vt=N.charProcOperatorList[Rt.operatorListId];if(!vt){(0,c.warn)(`Type3 character "${Rt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Rt,this.save(),e.scale(T,T),e.transform(...ht),this.executeOperatorList(vt),this.restore()),Ht=c.Util.applyTransform([Rt.width,0],ht)[0]*T+Nt,e.translate(Ht,0),m.x+=Ht*at}e.restore(),this.processingType3=null}}setCharWidth(i,e){}setCharWidthAndBounds(i,e,m,N,T,H){this.ctx.rect(m,N,T-m,H-N),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let e;if(i[0]==="TilingPattern"){const m=i[1],N=this.baseTransform||(0,x.getCurrentTransform)(this.ctx),T={createCanvasGraphics:H=>new _t(H,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new et.TilingPattern(i,m,this.ctx,T,N)}else e=this._getPattern(i[1],i[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,e,m){const N=c.Util.makeHexColor(i,e,m);this.ctx.strokeStyle=N,this.current.strokeColor=N}setFillRGBColor(i,e,m){const N=c.Util.makeHexColor(i,e,m);this.ctx.fillStyle=N,this.current.fillColor=N,this.current.patternFill=!1}_getPattern(i,e=null){let m;return this.cachedPatterns.has(i)?m=this.cachedPatterns.get(i):(m=(0,et.getShadingPattern)(this.getObject(i)),this.cachedPatterns.set(i,m)),e&&(m.matrix=e),m}shadingFill(i){if(!this.contentVisible)return;const e=this.ctx;this.save();const m=this._getPattern(i);e.fillStyle=m.getPattern(e,this,(0,x.getCurrentTransformInverse)(e),et.PathType.SHADING);const N=(0,x.getCurrentTransformInverse)(e);if(N){const{width:T,height:H}=e.canvas,[z,Y,dt,at]=c.Util.getAxialAlignedBoundingBox([0,0,T,H],N);this.ctx.fillRect(z,Y,dt-z,at-Y)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,c.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,c.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,x.getCurrentTransform)(this.ctx),e)){const m=e[2]-e[0],N=e[3]-e[1];this.ctx.rect(e[0],e[1],m,N),this.current.updateRectMinMax((0,x.getCurrentTransform)(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;i.isolated||(0,c.info)("TODO: Support non-isolated groups."),i.knockout&&(0,c.warn)("Knockout groups not supported.");const m=(0,x.getCurrentTransform)(e);if(i.matrix&&e.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let N=c.Util.getAxialAlignedBoundingBox(i.bbox,(0,x.getCurrentTransform)(e));const T=[0,0,e.canvas.width,e.canvas.height];N=c.Util.intersect(N,T)||[0,0,0,0];const H=Math.floor(N[0]),z=Math.floor(N[1]);let Y=Math.max(Math.ceil(N[2])-H,1),dt=Math.max(Math.ceil(N[3])-z,1),at=1,ht=1;Y>R&&(at=Y/R,Y=R),dt>R&&(ht=dt/R,dt=R),this.current.startNewPathAndClipBox([0,0,Y,dt]);let ft="groupAt"+this.groupLevel;i.smask&&(ft+="_smask_"+this.smaskCounter++%2);const Ct=this.cachedCanvases.getCanvas(ft,Y,dt),At=Ct.context;At.scale(1/at,1/ht),At.translate(-H,-z),At.transform(...m),i.smask?this.smaskStack.push({canvas:Ct.canvas,context:At,offsetX:H,offsetY:z,scaleX:at,scaleY:ht,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(H,z),e.scale(at,ht),e.save()),n(e,At),this.ctx=At,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,m=this.groupStack.pop();if(this.ctx=m,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const N=(0,x.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...N);const T=c.Util.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],N);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(T)}}beginAnnotation(i,e,m,N,T){if(Q(this,k,Oe).call(this),o(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(e)&&e.length===4){const H=e[2]-e[0],z=e[3]-e[1];if(T&&this.annotationCanvasMap){m=m.slice(),m[4]-=e[0],m[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=H,e[3]=z;const[Y,dt]=c.Util.singularValueDecompose2dScale((0,x.getCurrentTransform)(this.ctx)),{viewportScale:at}=this,ht=Math.ceil(H*this.outputScaleX*at),ft=Math.ceil(z*this.outputScaleY*at);this.annotationCanvas=this.canvasFactory.create(ht,ft);const{canvas:Ct,context:At}=this.annotationCanvas;this.annotationCanvasMap.set(i,Ct),this.annotationCanvas.savedCtx=this.ctx,this.ctx=At,this.ctx.save(),this.ctx.setTransform(Y,0,0,-dt,0,z*dt),o(this.ctx)}else o(this.ctx),this.ctx.rect(e[0],e[1],H,z),this.ctx.clip(),this.endPath()}this.current=new E(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...m),this.transform(...N)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Q(this,it,Le).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const e=i.count;i=this.getObject(i.data,i),i.count=e;const m=this.ctx,N=this.processingType3;if(N&&(N.compiled===void 0&&(N.compiled=v(i)),N.compiled)){N.compiled(m);return}const T=this._createMaskCanvas(i),H=T.canvas;m.save(),m.setTransform(1,0,0,1,0,0),m.drawImage(H,T.offsetX,T.offsetY),m.restore(),this.compose()}paintImageMaskXObjectRepeat(i,e,m=0,N=0,T,H){if(!this.contentVisible)return;i=this.getObject(i.data,i);const z=this.ctx;z.save();const Y=(0,x.getCurrentTransform)(z);z.transform(e,m,N,T,0,0);const dt=this._createMaskCanvas(i);z.setTransform(1,0,0,1,dt.offsetX-Y[4],dt.offsetY-Y[5]);for(let at=0,ht=H.length;at<ht;at+=2){const ft=c.Util.transform(Y,[e,m,N,T,H[at],H[at+1]]),[Ct,At]=c.Util.applyTransform([0,0],ft);z.drawImage(dt.canvas,Ct,At)}z.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const e=this.ctx,m=this.current.fillColor,N=this.current.patternFill;for(const T of i){const{data:H,width:z,height:Y,transform:dt}=T,at=this.cachedCanvases.getCanvas("maskCanvas",z,Y),ht=at.context;ht.save();const ft=this.getObject(H,T);g(ht,ft),ht.globalCompositeOperation="source-in",ht.fillStyle=N?m.getPattern(ht,this,(0,x.getCurrentTransformInverse)(e),et.PathType.FILL):m,ht.fillRect(0,0,z,Y),ht.restore(),e.save(),e.transform(...dt),e.scale(1,-1),f(e,at.canvas,0,0,z,Y,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const e=this.getObject(i);if(!e){(0,c.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(i,e,m,N){if(!this.contentVisible)return;const T=this.getObject(i);if(!T){(0,c.warn)("Dependent image isn't ready yet");return}const H=T.width,z=T.height,Y=[];for(let dt=0,at=N.length;dt<at;dt+=2)Y.push({transform:[e,0,0,m,N[dt],N[dt+1]],x:0,y:0,w:H,h:z});this.paintInlineImageXObjectGroup(T,Y)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:e,width:m,height:N}=i,T=this.cachedCanvases.getCanvas("inlineImage",m,N),H=T.context;return H.filter=this.current.transferMaps,H.drawImage(e,0,0),H.filter="none",T.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const e=i.width,m=i.height,N=this.ctx;if(this.save(),!c.isNodeJS){const{filter:z}=N;z!=="none"&&z!==""&&(N.filter="none")}N.scale(1/e,-1/m);let T;if(i.bitmap)T=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)T=i;else{const Y=this.cachedCanvases.getCanvas("inlineImage",e,m).context;P(Y,i),T=this.applyTransferMapsToCanvas(Y)}const H=this._scaleImage(T,(0,x.getCurrentTransformInverse)(N));N.imageSmoothingEnabled=I((0,x.getCurrentTransform)(N),i.interpolate),f(N,H.img,0,0,H.paintWidth,H.paintHeight,0,-m,e,m),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,e){if(!this.contentVisible)return;const m=this.ctx;let N;if(i.bitmap)N=i.bitmap;else{const T=i.width,H=i.height,Y=this.cachedCanvases.getCanvas("inlineImage",T,H).context;P(Y,i),N=this.applyTransferMapsToCanvas(Y)}for(const T of e)m.save(),m.transform(...T.transform),m.scale(1,-1),f(m,N,T.x,T.y,T.w,T.h,0,-1,1,1),m.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,e){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,e){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const m=this.ctx;this.pendingClip&&(e||(this.pendingClip===G?m.clip("evenodd"):m.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),m.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,x.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const e=Math.abs(i[0]*i[3]-i[2]*i[1]),m=Math.hypot(i[0],i[2]),N=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(m,N)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:e,b:m,c:N,d:T}=this.ctx.getTransform();let H,z;if(m===0&&N===0){const Y=Math.abs(e),dt=Math.abs(T);if(Y===dt)if(i===0)H=z=1/Y;else{const at=Y*i;H=z=at<1?1/at:1}else if(i===0)H=1/Y,z=1/dt;else{const at=Y*i,ht=dt*i;H=at<1?1/at:1,z=ht<1?1/ht:1}}else{const Y=Math.abs(e*T-m*N),dt=Math.hypot(e,m),at=Math.hypot(N,T);if(i===0)H=at/Y,z=dt/Y;else{const ht=i*Y;H=at>ht?at/ht:1,z=dt>ht?dt/ht:1}}this._cachedScaleForStroking[0]=H,this._cachedScaleForStroking[1]=z}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:e}=this,{lineWidth:m}=this.current,[N,T]=this.getScaleForStroking();if(e.lineWidth=m||1,N===1&&T===1){e.stroke();return}const H=e.getLineDash();if(i&&e.save(),e.scale(N,T),H.length>0){const z=Math.max(N,T);e.setLineDash(H.map(Y=>Y/z)),e.lineDashOffset/=z}e.stroke(),i&&e.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};let M=_t;k=new WeakSet,Oe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},it=new WeakSet,Le=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const e=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},d.CanvasGraphics=M;for(const D in c.OPS)M.prototype[D]!==void 0&&(M.prototype[c.OPS[D]]=M.prototype[D])},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.TilingPattern=d.PathType=void 0,d.getShadingPattern=w;var c=nt(1),x=nt(6);const et={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};d.PathType=et;function J(v,E){if(!E)return;const P=E[2]-E[0],g=E[3]-E[1],n=new Path2D;n.rect(E[0],E[1],P,g),v.clip(n)}class lt{constructor(){this.constructor===lt&&(0,c.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,c.unreachable)("Abstract method `getPattern` called.")}}class j extends lt{constructor(E){super(),this._type=E[1],this._bbox=E[2],this._colorStops=E[3],this._p0=E[4],this._p1=E[5],this._r0=E[6],this._r1=E[7],this.matrix=null}_createGradient(E){let P;this._type==="axial"?P=E.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(P=E.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const g of this._colorStops)P.addColorStop(g[0],g[1]);return P}getPattern(E,P,g,n){let o;if(n===et.STROKE||n===et.FILL){const F=P.current.getClippedPathBoundingBox(n,(0,x.getCurrentTransform)(E))||[0,0,0,0],b=Math.ceil(F[2]-F[0])||1,s=Math.ceil(F[3]-F[1])||1,l=P.cachedCanvases.getCanvas("pattern",b,s,!0),r=l.context;r.clearRect(0,0,r.canvas.width,r.canvas.height),r.beginPath(),r.rect(0,0,r.canvas.width,r.canvas.height),r.translate(-F[0],-F[1]),g=c.Util.transform(g,[1,0,0,1,F[0],F[1]]),r.transform(...P.baseTransform),this.matrix&&r.transform(...this.matrix),J(r,this._bbox),r.fillStyle=this._createGradient(r),r.fill(),o=E.createPattern(l.canvas,"no-repeat");const I=new DOMMatrix(g);o.setTransform(I)}else J(E,this._bbox),o=this._createGradient(E);return o}}function R(v,E,P,g,n,o,F,b){const s=E.coords,l=E.colors,r=v.data,I=v.width*4;let O;s[P+1]>s[g+1]&&(O=P,P=g,g=O,O=o,o=F,F=O),s[g+1]>s[n+1]&&(O=g,g=n,n=O,O=F,F=b,b=O),s[P+1]>s[g+1]&&(O=P,P=g,g=O,O=o,o=F,F=O);const V=(s[P]+E.offsetX)*E.scaleX,_=(s[P+1]+E.offsetY)*E.scaleY,G=(s[g]+E.offsetX)*E.scaleX,M=(s[g+1]+E.offsetY)*E.scaleY,k=(s[n]+E.offsetX)*E.scaleX,$=(s[n+1]+E.offsetY)*E.scaleY;if(_>=$)return;const it=l[o],pt=l[o+1],_t=l[o+2],D=l[F],i=l[F+1],e=l[F+2],m=l[b],N=l[b+1],T=l[b+2],H=Math.round(_),z=Math.round($);let Y,dt,at,ht,ft,Ct,At,Rt;for(let Ht=H;Ht<=z;Ht++){if(Ht<M){const tt=Ht<_?0:(_-Ht)/(_-M);Y=V-(V-G)*tt,dt=it-(it-D)*tt,at=pt-(pt-i)*tt,ht=_t-(_t-e)*tt}else{let tt;Ht>$?tt=1:M===$?tt=0:tt=(M-Ht)/(M-$),Y=G-(G-k)*tt,dt=D-(D-m)*tt,at=i-(i-N)*tt,ht=e-(e-T)*tt}let St;Ht<_?St=0:Ht>$?St=1:St=(_-Ht)/(_-$),ft=V-(V-k)*St,Ct=it-(it-m)*St,At=pt-(pt-N)*St,Rt=_t-(_t-T)*St;const Nt=Math.round(Math.min(Y,ft)),vt=Math.round(Math.max(Y,ft));let st=I*Ht+Nt*4;for(let tt=Nt;tt<=vt;tt++)St=(Y-tt)/(Y-ft),St<0?St=0:St>1&&(St=1),r[st++]=dt-(dt-Ct)*St|0,r[st++]=at-(at-At)*St|0,r[st++]=ht-(ht-Rt)*St|0,r[st++]=255}}function p(v,E,P){const g=E.coords,n=E.colors;let o,F;switch(E.type){case"lattice":const b=E.verticesPerRow,s=Math.floor(g.length/b)-1,l=b-1;for(o=0;o<s;o++){let r=o*b;for(let I=0;I<l;I++,r++)R(v,P,g[r],g[r+1],g[r+b],n[r],n[r+1],n[r+b]),R(v,P,g[r+b+1],g[r+1],g[r+b],n[r+b+1],n[r+1],n[r+b])}break;case"triangles":for(o=0,F=g.length;o<F;o+=3)R(v,P,g[o],g[o+1],g[o+2],n[o],n[o+1],n[o+2]);break;default:throw new Error("illegal figure")}}class L extends lt{constructor(E){super(),this._coords=E[2],this._colors=E[3],this._figures=E[4],this._bounds=E[5],this._bbox=E[7],this._background=E[8],this.matrix=null}_createMeshCanvas(E,P,g){const b=Math.floor(this._bounds[0]),s=Math.floor(this._bounds[1]),l=Math.ceil(this._bounds[2])-b,r=Math.ceil(this._bounds[3])-s,I=Math.min(Math.ceil(Math.abs(l*E[0]*1.1)),3e3),O=Math.min(Math.ceil(Math.abs(r*E[1]*1.1)),3e3),V=l/I,_=r/O,G={coords:this._coords,colors:this._colors,offsetX:-b,offsetY:-s,scaleX:1/V,scaleY:1/_},M=I+2*2,k=O+2*2,$=g.getCanvas("mesh",M,k,!1),it=$.context,pt=it.createImageData(I,O);if(P){const D=pt.data;for(let i=0,e=D.length;i<e;i+=4)D[i]=P[0],D[i+1]=P[1],D[i+2]=P[2],D[i+3]=255}for(const D of this._figures)p(pt,D,G);return it.putImageData(pt,2,2),{canvas:$.canvas,offsetX:b-2*V,offsetY:s-2*_,scaleX:V,scaleY:_}}getPattern(E,P,g,n){J(E,this._bbox);let o;if(n===et.SHADING)o=c.Util.singularValueDecompose2dScale((0,x.getCurrentTransform)(E));else if(o=c.Util.singularValueDecompose2dScale(P.baseTransform),this.matrix){const b=c.Util.singularValueDecompose2dScale(this.matrix);o=[o[0]*b[0],o[1]*b[1]]}const F=this._createMeshCanvas(o,n===et.SHADING?null:this._background,P.cachedCanvases);return n!==et.SHADING&&(E.setTransform(...P.baseTransform),this.matrix&&E.transform(...this.matrix)),E.translate(F.offsetX,F.offsetY),E.scale(F.scaleX,F.scaleY),E.createPattern(F.canvas,"no-repeat")}}class B extends lt{getPattern(){return"hotpink"}}function w(v){switch(v[0]){case"RadialAxial":return new j(v);case"Mesh":return new L(v);case"Dummy":return new B}throw new Error(`Unknown IR type: ${v[0]}`)}const y={COLORED:1,UNCOLORED:2},f=class{constructor(E,P,g,n,o){this.operatorList=E[2],this.matrix=E[3]||[1,0,0,1,0,0],this.bbox=E[4],this.xstep=E[5],this.ystep=E[6],this.paintType=E[7],this.tilingType=E[8],this.color=P,this.ctx=g,this.canvasGraphicsFactory=n,this.baseTransform=o}createPatternCanvas(E){const P=this.operatorList,g=this.bbox,n=this.xstep,o=this.ystep,F=this.paintType,b=this.tilingType,s=this.color,l=this.canvasGraphicsFactory;(0,c.info)("TilingType: "+b);const r=g[0],I=g[1],O=g[2],V=g[3],_=c.Util.singularValueDecompose2dScale(this.matrix),G=c.Util.singularValueDecompose2dScale(this.baseTransform),M=[_[0]*G[0],_[1]*G[1]],k=this.getSizeAndScale(n,this.ctx.canvas.width,M[0]),$=this.getSizeAndScale(o,this.ctx.canvas.height,M[1]),it=E.cachedCanvases.getCanvas("pattern",k.size,$.size,!0),pt=it.context,_t=l.createCanvasGraphics(pt);_t.groupLevel=E.groupLevel,this.setFillAndStrokeStyleToContext(_t,F,s);let D=r,i=I,e=O,m=V;return r<0&&(D=0,e+=Math.abs(r)),I<0&&(i=0,m+=Math.abs(I)),pt.translate(-(k.scale*D),-($.scale*i)),_t.transform(k.scale,0,0,$.scale,0,0),pt.save(),this.clipBbox(_t,D,i,e,m),_t.baseTransform=(0,x.getCurrentTransform)(_t.ctx),_t.executeOperatorList(P),_t.endDrawing(),{canvas:it.canvas,scaleX:k.scale,scaleY:$.scale,offsetX:D,offsetY:i}}getSizeAndScale(E,P,g){E=Math.abs(E);const n=Math.max(f.MAX_PATTERN_SIZE,P);let o=Math.ceil(E*g);return o>=n?o=n:g=o/E,{scale:g,size:o}}clipBbox(E,P,g,n,o){const F=n-P,b=o-g;E.ctx.rect(P,g,F,b),E.current.updateRectMinMax((0,x.getCurrentTransform)(E.ctx),[P,g,n,o]),E.clip(),E.endPath()}setFillAndStrokeStyleToContext(E,P,g){const n=E.ctx,o=E.current;switch(P){case y.COLORED:const F=this.ctx;n.fillStyle=F.fillStyle,n.strokeStyle=F.strokeStyle,o.fillColor=F.fillStyle,o.strokeColor=F.strokeStyle;break;case y.UNCOLORED:const b=c.Util.makeHexColor(g[0],g[1],g[2]);n.fillStyle=b,n.strokeStyle=b,o.fillColor=b,o.strokeColor=b;break;default:throw new c.FormatError(`Unsupported paint type: ${P}`)}}getPattern(E,P,g,n){let o=g;n!==et.SHADING&&(o=c.Util.transform(o,P.baseTransform),this.matrix&&(o=c.Util.transform(o,this.matrix)));const F=this.createPatternCanvas(P);let b=new DOMMatrix(o);b=b.translate(F.offsetX,F.offsetY),b=b.scale(1/F.scaleX,1/F.scaleY);const s=E.createPattern(F.canvas,"repeat");return s.setTransform(b),s}};let A=f;Yt(A,"MAX_PATTERN_SIZE",3e3),d.TilingPattern=A},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.convertBlackAndWhiteToRGBA=et,d.convertToRGBA=x,d.grayToRGBA=lt;var c=nt(1);function x(j){switch(j.kind){case c.ImageKind.GRAYSCALE_1BPP:return et(j);case c.ImageKind.RGB_24BPP:return J(j)}return null}function et({src:j,srcPos:R=0,dest:p,width:L,height:B,nonBlackColor:w=4294967295,inverseDecode:y=!1}){const A=c.FeatureTest.isLittleEndian?4278190080:255,[f,v]=y?[w,A]:[A,w],E=L>>3,P=L&7,g=j.length;p=new Uint32Array(p.buffer);let n=0;for(let o=0;o<B;o++){for(const b=R+E;R<b;R++){const s=R<g?j[R]:255;p[n++]=s&128?v:f,p[n++]=s&64?v:f,p[n++]=s&32?v:f,p[n++]=s&16?v:f,p[n++]=s&8?v:f,p[n++]=s&4?v:f,p[n++]=s&2?v:f,p[n++]=s&1?v:f}if(P===0)continue;const F=R<g?j[R++]:255;for(let b=0;b<P;b++)p[n++]=F&1<<7-b?v:f}return{srcPos:R,destPos:n}}function J({src:j,srcPos:R=0,dest:p,destPos:L=0,width:B,height:w}){let y=0;const A=j.length>>2,f=new Uint32Array(j.buffer,R,A);if(c.FeatureTest.isLittleEndian){for(;y<A-2;y+=3,L+=4){const v=f[y],E=f[y+1],P=f[y+2];p[L]=v|4278190080,p[L+1]=v>>>24|E<<8|4278190080,p[L+2]=E>>>16|P<<16|4278190080,p[L+3]=P>>>8|4278190080}for(let v=y*4,E=j.length;v<E;v+=3)p[L++]=j[v]|j[v+1]<<8|j[v+2]<<16|4278190080}else{for(;y<A-2;y+=3,L+=4){const v=f[y],E=f[y+1],P=f[y+2];p[L]=v|255,p[L+1]=v<<24|E>>>8|255,p[L+2]=E<<16|P>>>16|255,p[L+3]=P<<8|255}for(let v=y*4,E=j.length;v<E;v+=3)p[L++]=j[v]<<24|j[v+1]<<16|j[v+2]<<8|255}return{srcPos:R,destPos:L}}function lt(j,R){if(c.FeatureTest.isLittleEndian)for(let p=0,L=j.length;p<L;p++)R[p]=j[p]*65793|4278190080;else for(let p=0,L=j.length;p<L;p++)R[p]=j[p]*16843008|255}},(bt,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.GlobalWorkerOptions=void 0;const nt=Object.create(null);d.GlobalWorkerOptions=nt,nt.workerPort=null,nt.workerSrc=""},(bt,d,nt)=>{var j,fi,p,pi,B,ye;Object.defineProperty(d,"__esModule",{value:!0}),d.MessageHandler=void 0;var c=nt(1);const x={UNKNOWN:0,DATA:1,ERROR:2},et={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function J(y){switch(y instanceof Error||typeof y=="object"&&y!==null||(0,c.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),y.name){case"AbortException":return new c.AbortException(y.message);case"MissingPDFException":return new c.MissingPDFException(y.message);case"PasswordException":return new c.PasswordException(y.message,y.code);case"UnexpectedResponseException":return new c.UnexpectedResponseException(y.message,y.status);case"UnknownErrorException":return new c.UnknownErrorException(y.message,y.details);default:return new c.UnknownErrorException(y.message,y.toString())}}class lt{constructor(A,f,v){W(this,j);W(this,p);W(this,B);this.sourceName=A,this.targetName=f,this.comObj=v,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=E=>{const P=E.data;if(P.targetName!==this.sourceName)return;if(P.stream){Q(this,p,pi).call(this,P);return}if(P.callback){const n=P.callbackId,o=this.callbackCapabilities[n];if(!o)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],P.callback===x.DATA)o.resolve(P.data);else if(P.callback===x.ERROR)o.reject(J(P.reason));else throw new Error("Unexpected callback case");return}const g=this.actionHandler[P.action];if(!g)throw new Error(`Unknown action from worker: ${P.action}`);if(P.callbackId){const n=this.sourceName,o=P.sourceName;new Promise(function(F){F(g(P.data))}).then(function(F){v.postMessage({sourceName:n,targetName:o,callback:x.DATA,callbackId:P.callbackId,data:F})},function(F){v.postMessage({sourceName:n,targetName:o,callback:x.ERROR,callbackId:P.callbackId,reason:J(F)})});return}if(P.streamId){Q(this,j,fi).call(this,P);return}g(P.data)},v.addEventListener("message",this._onComObjOnMessage)}on(A,f){const v=this.actionHandler;if(v[A])throw new Error(`There is already an actionName called "${A}"`);v[A]=f}send(A,f,v){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,data:f},v)}sendWithPromise(A,f,v){const E=this.callbackId++,P=new c.PromiseCapability;this.callbackCapabilities[E]=P;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,callbackId:E,data:f},v)}catch(g){P.reject(g)}return P.promise}sendWithStream(A,f,v,E){const P=this.streamId++,g=this.sourceName,n=this.targetName,o=this.comObj;return new ReadableStream({start:F=>{const b=new c.PromiseCapability;return this.streamControllers[P]={controller:F,startCall:b,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:g,targetName:n,action:A,streamId:P,data:f,desiredSize:F.desiredSize},E),b.promise},pull:F=>{const b=new c.PromiseCapability;return this.streamControllers[P].pullCall=b,o.postMessage({sourceName:g,targetName:n,stream:et.PULL,streamId:P,desiredSize:F.desiredSize}),b.promise},cancel:F=>{(0,c.assert)(F instanceof Error,"cancel must have a valid reason");const b=new c.PromiseCapability;return this.streamControllers[P].cancelCall=b,this.streamControllers[P].isClosed=!0,o.postMessage({sourceName:g,targetName:n,stream:et.CANCEL,streamId:P,reason:J(F)}),b.promise}},v)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}j=new WeakSet,fi=function(A){const f=A.streamId,v=this.sourceName,E=A.sourceName,P=this.comObj,g=this,n=this.actionHandler[A.action],o={enqueue(F,b=1,s){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=b,l>0&&this.desiredSize<=0&&(this.sinkCapability=new c.PromiseCapability,this.ready=this.sinkCapability.promise),P.postMessage({sourceName:v,targetName:E,stream:et.ENQUEUE,streamId:f,chunk:F},s)},close(){this.isCancelled||(this.isCancelled=!0,P.postMessage({sourceName:v,targetName:E,stream:et.CLOSE,streamId:f}),delete g.streamSinks[f])},error(F){(0,c.assert)(F instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,P.postMessage({sourceName:v,targetName:E,stream:et.ERROR,streamId:f,reason:J(F)}))},sinkCapability:new c.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:A.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[f]=o,new Promise(function(F){F(n(A.data,o))}).then(function(){P.postMessage({sourceName:v,targetName:E,stream:et.START_COMPLETE,streamId:f,success:!0})},function(F){P.postMessage({sourceName:v,targetName:E,stream:et.START_COMPLETE,streamId:f,reason:J(F)})})},p=new WeakSet,pi=function(A){const f=A.streamId,v=this.sourceName,E=A.sourceName,P=this.comObj,g=this.streamControllers[f],n=this.streamSinks[f];switch(A.stream){case et.START_COMPLETE:A.success?g.startCall.resolve():g.startCall.reject(J(A.reason));break;case et.PULL_COMPLETE:A.success?g.pullCall.resolve():g.pullCall.reject(J(A.reason));break;case et.PULL:if(!n){P.postMessage({sourceName:v,targetName:E,stream:et.PULL_COMPLETE,streamId:f,success:!0});break}n.desiredSize<=0&&A.desiredSize>0&&n.sinkCapability.resolve(),n.desiredSize=A.desiredSize,new Promise(function(o){var F;o((F=n.onPull)==null?void 0:F.call(n))}).then(function(){P.postMessage({sourceName:v,targetName:E,stream:et.PULL_COMPLETE,streamId:f,success:!0})},function(o){P.postMessage({sourceName:v,targetName:E,stream:et.PULL_COMPLETE,streamId:f,reason:J(o)})});break;case et.ENQUEUE:if((0,c.assert)(g,"enqueue should have stream controller"),g.isClosed)break;g.controller.enqueue(A.chunk);break;case et.CLOSE:if((0,c.assert)(g,"close should have stream controller"),g.isClosed)break;g.isClosed=!0,g.controller.close(),Q(this,B,ye).call(this,g,f);break;case et.ERROR:(0,c.assert)(g,"error should have stream controller"),g.controller.error(J(A.reason)),Q(this,B,ye).call(this,g,f);break;case et.CANCEL_COMPLETE:A.success?g.cancelCall.resolve():g.cancelCall.reject(J(A.reason)),Q(this,B,ye).call(this,g,f);break;case et.CANCEL:if(!n)break;new Promise(function(o){var F;o((F=n.onCancel)==null?void 0:F.call(n,J(A.reason)))}).then(function(){P.postMessage({sourceName:v,targetName:E,stream:et.CANCEL_COMPLETE,streamId:f,success:!0})},function(o){P.postMessage({sourceName:v,targetName:E,stream:et.CANCEL_COMPLETE,streamId:f,reason:J(o)})}),n.sinkCapability.reject(J(A.reason)),n.isCancelled=!0,delete this.streamSinks[f];break;default:throw new Error("Unexpected stream case")}},B=new WeakSet,ye=async function(A,f){var v,E,P;await Promise.allSettled([(v=A.startCall)==null?void 0:v.promise,(E=A.pullCall)==null?void 0:E.promise,(P=A.cancelCall)==null?void 0:P.promise]),delete this.streamControllers[f]},d.MessageHandler=lt},(bt,d,nt)=>{var et,J;Object.defineProperty(d,"__esModule",{value:!0}),d.Metadata=void 0;var c=nt(1);class x{constructor({parsedData:j,rawData:R}){W(this,et,void 0);W(this,J,void 0);rt(this,et,j),rt(this,J,R)}getRaw(){return t(this,J)}get(j){return t(this,et).get(j)??null}getAll(){return(0,c.objectFromMap)(t(this,et))}has(j){return t(this,et).has(j)}}et=new WeakMap,J=new WeakMap,d.Metadata=x},(bt,d,nt)=>{var j,R,p,L,B,w,Ne;Object.defineProperty(d,"__esModule",{value:!0}),d.OptionalContentConfig=void 0;var c=nt(1),x=nt(8);const et=Symbol("INTERNAL");class J{constructor(f,v){W(this,j,!0);this.name=f,this.intent=v}get visible(){return t(this,j)}_setVisible(f,v){f!==et&&(0,c.unreachable)("Internal method `_setVisible` called."),rt(this,j,v)}}j=new WeakMap;class lt{constructor(f){W(this,w);W(this,R,null);W(this,p,new Map);W(this,L,null);W(this,B,null);if(this.name=null,this.creator=null,f!==null){this.name=f.name,this.creator=f.creator,rt(this,B,f.order);for(const v of f.groups)t(this,p).set(v.id,new J(v.name,v.intent));if(f.baseState==="OFF")for(const v of t(this,p).values())v._setVisible(et,!1);for(const v of f.on)t(this,p).get(v)._setVisible(et,!0);for(const v of f.off)t(this,p).get(v)._setVisible(et,!1);rt(this,L,this.getHash())}}isVisible(f){if(t(this,p).size===0)return!0;if(!f)return(0,c.warn)("Optional content group not defined."),!0;if(f.type==="OCG")return t(this,p).has(f.id)?t(this,p).get(f.id).visible:((0,c.warn)(`Optional content group not found: ${f.id}`),!0);if(f.type==="OCMD"){if(f.expression)return Q(this,w,Ne).call(this,f.expression);if(!f.policy||f.policy==="AnyOn"){for(const v of f.ids){if(!t(this,p).has(v))return(0,c.warn)(`Optional content group not found: ${v}`),!0;if(t(this,p).get(v).visible)return!0}return!1}else if(f.policy==="AllOn"){for(const v of f.ids){if(!t(this,p).has(v))return(0,c.warn)(`Optional content group not found: ${v}`),!0;if(!t(this,p).get(v).visible)return!1}return!0}else if(f.policy==="AnyOff"){for(const v of f.ids){if(!t(this,p).has(v))return(0,c.warn)(`Optional content group not found: ${v}`),!0;if(!t(this,p).get(v).visible)return!0}return!1}else if(f.policy==="AllOff"){for(const v of f.ids){if(!t(this,p).has(v))return(0,c.warn)(`Optional content group not found: ${v}`),!0;if(t(this,p).get(v).visible)return!1}return!0}return(0,c.warn)(`Unknown optional content policy ${f.policy}.`),!0}return(0,c.warn)(`Unknown group type ${f.type}.`),!0}setVisibility(f,v=!0){if(!t(this,p).has(f)){(0,c.warn)(`Optional content group not found: ${f}`);return}t(this,p).get(f)._setVisible(et,!!v),rt(this,R,null)}get hasInitialVisibility(){return this.getHash()===t(this,L)}getOrder(){return t(this,p).size?t(this,B)?t(this,B).slice():[...t(this,p).keys()]:null}getGroups(){return t(this,p).size>0?(0,c.objectFromMap)(t(this,p)):null}getGroup(f){return t(this,p).get(f)||null}getHash(){if(t(this,R)!==null)return t(this,R);const f=new x.MurmurHash3_64;for(const[v,E]of t(this,p))f.update(`${v}:${E.visible}`);return rt(this,R,f.hexdigest())}}R=new WeakMap,p=new WeakMap,L=new WeakMap,B=new WeakMap,w=new WeakSet,Ne=function(f){const v=f.length;if(v<2)return!0;const E=f[0];for(let P=1;P<v;P++){const g=f[P];let n;if(Array.isArray(g))n=Q(this,w,Ne).call(this,g);else if(t(this,p).has(g))n=t(this,p).get(g).visible;else return(0,c.warn)(`Optional content group not found: ${g}`),!0;switch(E){case"And":if(!n)return!1;break;case"Or":if(n)return!0;break;case"Not":return!n;default:return!0}}return E==="And"},d.OptionalContentConfig=lt},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.PDFDataTransportStream=void 0;var c=nt(1),x=nt(6);class et{constructor({length:R,initialData:p,progressiveDone:L=!1,contentDispositionFilename:B=null,disableRange:w=!1,disableStream:y=!1},A){if((0,c.assert)(A,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=L,this._contentDispositionFilename=B,(p==null?void 0:p.length)>0){const f=p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength?p.buffer:new Uint8Array(p).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=A,this._isStreamingSupported=!y,this._isRangeSupported=!w,this._contentLength=R,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((f,v)=>{this._onReceiveData({begin:f,chunk:v})}),this._pdfDataRangeTransport.addProgressListener((f,v)=>{this._onProgress({loaded:f,total:v})}),this._pdfDataRangeTransport.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:R,chunk:p}){const L=p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength?p.buffer:new Uint8Array(p).buffer;if(R===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(L):this._queuedChunks.push(L);else{const B=this._rangeReaders.some(function(w){return w._begin!==R?!1:(w._enqueue(L),!0)});(0,c.assert)(B,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var R;return((R=this._fullRequestReader)==null?void 0:R._loaded)??0}_onProgress(R){var p,L,B,w;R.total===void 0?(L=(p=this._rangeReaders[0])==null?void 0:p.onProgress)==null||L.call(p,{loaded:R.loaded}):(w=(B=this._fullRequestReader)==null?void 0:B.onProgress)==null||w.call(B,{loaded:R.loaded,total:R.total})}_onProgressiveDone(){var R;(R=this._fullRequestReader)==null||R.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(R){const p=this._rangeReaders.indexOf(R);p>=0&&this._rangeReaders.splice(p,1)}getFullReader(){(0,c.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const R=this._queuedChunks;return this._queuedChunks=null,new J(this,R,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(R,p){if(p<=this._progressiveDataLength)return null;const L=new lt(this,R,p);return this._pdfDataRangeTransport.requestDataRange(R,p),this._rangeReaders.push(L),L}cancelAllRequests(R){var p;(p=this._fullRequestReader)==null||p.cancel(R);for(const L of this._rangeReaders.slice(0))L.cancel(R);this._pdfDataRangeTransport.abort()}}d.PDFDataTransportStream=et;class J{constructor(R,p,L=!1,B=null){this._stream=R,this._done=L||!1,this._filename=(0,x.isPdfFile)(B)?B:null,this._queuedChunks=p||[],this._loaded=0;for(const w of this._queuedChunks)this._loaded+=w.byteLength;this._requests=[],this._headersReady=Promise.resolve(),R._fullRequestReader=this,this.onProgress=null}_enqueue(R){this._done||(this._requests.length>0?this._requests.shift().resolve({value:R,done:!1}):this._queuedChunks.push(R),this._loaded+=R.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const R=new c.PromiseCapability;return this._requests.push(R),R.promise}cancel(R){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class lt{constructor(R,p,L){this._stream=R,this._begin=p,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(R){if(!this._done){if(this._requests.length===0)this._queuedChunk=R;else{this._requests.shift().resolve({value:R,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const R=new c.PromiseCapability;return this._requests.push(R),R.promise}cancel(R){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.PDFFetchStream=void 0;var c=nt(1),x=nt(20);function et(L,B,w){return{method:"GET",headers:L,signal:w.signal,mode:"cors",credentials:B?"include":"same-origin",redirect:"follow"}}function J(L){const B=new Headers;for(const w in L){const y=L[w];y!==void 0&&B.append(w,y)}return B}function lt(L){return L instanceof Uint8Array?L.buffer:L instanceof ArrayBuffer?L:((0,c.warn)(`getArrayBuffer - unexpected data format: ${L}`),new Uint8Array(L).buffer)}class j{constructor(B){this.source=B,this.isHttp=/^https?:/i.test(B.url),this.httpHeaders=this.isHttp&&B.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var B;return((B=this._fullRequestReader)==null?void 0:B._loaded)??0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new R(this),this._fullRequestReader}getRangeReader(B,w){if(w<=this._progressiveDataLength)return null;const y=new p(this,B,w);return this._rangeRequestReaders.push(y),y}cancelAllRequests(B){var w;(w=this._fullRequestReader)==null||w.cancel(B);for(const y of this._rangeRequestReaders.slice(0))y.cancel(B)}}d.PDFFetchStream=j;class R{constructor(B){this._stream=B,this._reader=null,this._loaded=0,this._filename=null;const w=B.source;this._withCredentials=w.withCredentials||!1,this._contentLength=w.length,this._headersCapability=new c.PromiseCapability,this._disableRange=w.disableRange||!1,this._rangeChunkSize=w.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!w.disableStream,this._isRangeSupported=!w.disableRange,this._headers=J(this._stream.httpHeaders);const y=w.url;fetch(y,et(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,x.validateResponseStatus)(A.status))throw(0,x.createResponseStatusError)(A.status,y);this._reader=A.body.getReader(),this._headersCapability.resolve();const f=P=>A.headers.get(P),{allowRangeRequests:v,suggestedLength:E}=(0,x.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=v,this._contentLength=E||this._contentLength,this._filename=(0,x.extractFilenameFromHeader)(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new c.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;await this._headersCapability.promise;const{value:B,done:w}=await this._reader.read();return w?{value:B,done:w}:(this._loaded+=B.byteLength,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded,total:this._contentLength}),{value:lt(B),done:!1})}cancel(B){var w;(w=this._reader)==null||w.cancel(B),this._abortController.abort()}}class p{constructor(B,w,y){this._stream=B,this._reader=null,this._loaded=0;const A=B.source;this._withCredentials=A.withCredentials||!1,this._readCapability=new c.PromiseCapability,this._isStreamingSupported=!A.disableStream,this._abortController=new AbortController,this._headers=J(this._stream.httpHeaders),this._headers.append("Range",`bytes=${w}-${y-1}`);const f=A.url;fetch(f,et(this._headers,this._withCredentials,this._abortController)).then(v=>{if(!(0,x.validateResponseStatus)(v.status))throw(0,x.createResponseStatusError)(v.status,f);this._readCapability.resolve(),this._reader=v.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;await this._readCapability.promise;const{value:B,done:w}=await this._reader.read();return w?{value:B,done:w}:(this._loaded+=B.byteLength,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded}),{value:lt(B),done:!1})}cancel(B){var w;(w=this._reader)==null||w.cancel(B),this._abortController.abort()}}},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.createResponseStatusError=j,d.extractFilenameFromHeader=lt,d.validateRangeRequestCapabilities=J,d.validateResponseStatus=R;var c=nt(1),x=nt(21),et=nt(6);function J({getResponseHeader:p,isHttp:L,rangeChunkSize:B,disableRange:w}){const y={allowRangeRequests:!1,suggestedLength:void 0},A=parseInt(p("Content-Length"),10);return!Number.isInteger(A)||(y.suggestedLength=A,A<=2*B)||w||!L||p("Accept-Ranges")!=="bytes"||(p("Content-Encoding")||"identity")!=="identity"||(y.allowRangeRequests=!0),y}function lt(p){const L=p("Content-Disposition");if(L){let B=(0,x.getFilenameFromContentDispositionHeader)(L);if(B.includes("%"))try{B=decodeURIComponent(B)}catch{}if((0,et.isPdfFile)(B))return B}return null}function j(p,L){return p===404||p===0&&L.startsWith("file:")?new c.MissingPDFException('Missing PDF "'+L+'".'):new c.UnexpectedResponseException(`Unexpected server response (${p}) while retrieving PDF "${L}".`,p)}function R(p){return p===200||p===206}},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.getFilenameFromContentDispositionHeader=x;var c=nt(1);function x(et){let J=!0,lt=j("filename\\*","i").exec(et);if(lt){lt=lt[1];let A=B(lt);return A=unescape(A),A=w(A),A=y(A),p(A)}if(lt=L(et),lt){const A=y(lt);return p(A)}if(lt=j("filename","i").exec(et),lt){lt=lt[1];let A=B(lt);return A=y(A),p(A)}function j(A,f){return new RegExp("(?:^|;)\\s*"+A+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function R(A,f){if(A){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const v=new TextDecoder(A,{fatal:!0}),E=(0,c.stringToBytes)(f);f=v.decode(E),J=!1}catch{}}return f}function p(A){return J&&/[\x80-\xff]/.test(A)&&(A=R("utf-8",A),J&&(A=R("iso-8859-1",A))),A}function L(A){const f=[];let v;const E=j("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=E.exec(A))!==null;){let[,g,n,o]=v;if(g=parseInt(g,10),g in f){if(g===0)break;continue}f[g]=[n,o]}const P=[];for(let g=0;g<f.length&&g in f;++g){let[n,o]=f[g];o=B(o),n&&(o=unescape(o),g===0&&(o=w(o))),P.push(o)}return P.join("")}function B(A){if(A.startsWith('"')){const f=A.slice(1).split('\\"');for(let v=0;v<f.length;++v){const E=f[v].indexOf('"');E!==-1&&(f[v]=f[v].slice(0,E),f.length=v+1),f[v]=f[v].replaceAll(/\\(.)/g,"$1")}A=f.join('"')}return A}function w(A){const f=A.indexOf("'");if(f===-1)return A;const v=A.slice(0,f),P=A.slice(f+1).replace(/^[^']*'/,"");return R(v,P)}function y(A){return!A.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(A)?A:A.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,v,E,P){if(E==="q"||E==="Q")return P=P.replaceAll("_"," "),P=P.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,n){return String.fromCharCode(parseInt(n,16))}),R(v,P);try{P=atob(P)}catch{}return R(v,P)})}return""}},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.PDFNetworkStream=void 0;var c=nt(1),x=nt(20);const et=200,J=206;function lt(B){const w=B.response;return typeof w!="string"?w:(0,c.stringToBytes)(w).buffer}class j{constructor(w,y={}){this.url=w,this.isHttp=/^https?:/i.test(w),this.httpHeaders=this.isHttp&&y.httpHeaders||Object.create(null),this.withCredentials=y.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(w,y,A){const f={begin:w,end:y};for(const v in A)f[v]=A[v];return this.request(f)}requestFull(w){return this.request(w)}request(w){const y=new XMLHttpRequest,A=this.currXhrId++,f=this.pendingRequests[A]={xhr:y};y.open("GET",this.url),y.withCredentials=this.withCredentials;for(const v in this.httpHeaders){const E=this.httpHeaders[v];E!==void 0&&y.setRequestHeader(v,E)}return this.isHttp&&"begin"in w&&"end"in w?(y.setRequestHeader("Range",`bytes=${w.begin}-${w.end-1}`),f.expectedStatus=J):f.expectedStatus=et,y.responseType="arraybuffer",w.onError&&(y.onerror=function(v){w.onError(y.status)}),y.onreadystatechange=this.onStateChange.bind(this,A),y.onprogress=this.onProgress.bind(this,A),f.onHeadersReceived=w.onHeadersReceived,f.onDone=w.onDone,f.onError=w.onError,f.onProgress=w.onProgress,y.send(null),A}onProgress(w,y){var f;const A=this.pendingRequests[w];A&&((f=A.onProgress)==null||f.call(A,y))}onStateChange(w,y){var g,n,o;const A=this.pendingRequests[w];if(!A)return;const f=A.xhr;if(f.readyState>=2&&A.onHeadersReceived&&(A.onHeadersReceived(),delete A.onHeadersReceived),f.readyState!==4||!(w in this.pendingRequests))return;if(delete this.pendingRequests[w],f.status===0&&this.isHttp){(g=A.onError)==null||g.call(A,f.status);return}const v=f.status||et;if(!(v===et&&A.expectedStatus===J)&&v!==A.expectedStatus){(n=A.onError)==null||n.call(A,f.status);return}const P=lt(f);if(v===J){const F=f.getResponseHeader("Content-Range"),b=/bytes (\d+)-(\d+)\/(\d+)/.exec(F);A.onDone({begin:parseInt(b[1],10),chunk:P})}else P?A.onDone({begin:0,chunk:P}):(o=A.onError)==null||o.call(A,f.status)}getRequestXhr(w){return this.pendingRequests[w].xhr}isPendingRequest(w){return w in this.pendingRequests}abortRequest(w){const y=this.pendingRequests[w].xhr;delete this.pendingRequests[w],y.abort()}}class R{constructor(w){this._source=w,this._manager=new j(w.url,{httpHeaders:w.httpHeaders,withCredentials:w.withCredentials}),this._rangeChunkSize=w.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(w){const y=this._rangeRequestReaders.indexOf(w);y>=0&&this._rangeRequestReaders.splice(y,1)}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader}getRangeReader(w,y){const A=new L(this._manager,w,y);return A.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(A),A}cancelAllRequests(w){var y;(y=this._fullRequestReader)==null||y.cancel(w);for(const A of this._rangeRequestReaders.slice(0))A.cancel(w)}}d.PDFNetworkStream=R;class p{constructor(w,y){this._manager=w;const A={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=y.url,this._fullRequestId=w.requestFull(A),this._headersReceivedCapability=new c.PromiseCapability,this._disableRange=y.disableRange||!1,this._contentLength=y.length,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const w=this._fullRequestId,y=this._manager.getRequestXhr(w),A=E=>y.getResponseHeader(E),{allowRangeRequests:f,suggestedLength:v}=(0,x.validateRangeRequestCapabilities)({getResponseHeader:A,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});f&&(this._isRangeSupported=!0),this._contentLength=v||this._contentLength,this._filename=(0,x.extractFilenameFromHeader)(A),this._isRangeSupported&&this._manager.abortRequest(w),this._headersReceivedCapability.resolve()}_onDone(w){if(w&&(this._requests.length>0?this._requests.shift().resolve({value:w.chunk,done:!1}):this._cachedChunks.push(w.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(w){this._storedError=(0,x.createResponseStatusError)(w,this._url),this._headersReceivedCapability.reject(this._storedError);for(const y of this._requests)y.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(w){var y;(y=this.onProgress)==null||y.call(this,{loaded:w.loaded,total:w.lengthComputable?w.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const w=new c.PromiseCapability;return this._requests.push(w),w.promise}cancel(w){this._done=!0,this._headersReceivedCapability.reject(w);for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(w,y,A){this._manager=w;const f={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=w.url,this._requestId=w.requestRange(y,A,f),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var w;(w=this.onClosed)==null||w.call(this,this)}_onDone(w){const y=w.chunk;this._requests.length>0?this._requests.shift().resolve({value:y,done:!1}):this._queuedChunk=y,this._done=!0;for(const A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(w){this._storedError=(0,x.createResponseStatusError)(w,this._url);for(const y of this._requests)y.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(w){var y;this.isStreamingSupported||(y=this.onProgress)==null||y.call(this,{loaded:w.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const y=this._queuedChunk;return this._queuedChunk=null,{value:y,done:!1}}if(this._done)return{value:void 0,done:!0};const w=new c.PromiseCapability;return this._requests.push(w),w.promise}cancel(w){this._done=!0;for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.PDFNodeStream=void 0;var c=nt(1),x=nt(20);const et=/^file:\/\/\/[a-zA-Z]:\//;function J(A){const f=require$$5,v=f.parse(A);return v.protocol==="file:"||v.host?v:/^[a-z]:[/\\]/i.test(A)?f.parse(`file:///${A}`):(v.host||(v.protocol="file:"),v)}class lt{constructor(f){this.source=f,this.url=J(f.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new w(this):new L(this),this._fullRequestReader}getRangeReader(f,v){if(v<=this._progressiveDataLength)return null;const E=this.isFsUrl?new y(this,f,v):new B(this,f,v);return this._rangeRequestReaders.push(E),E}cancelAllRequests(f){var v;(v=this._fullRequestReader)==null||v.cancel(f);for(const E of this._rangeRequestReaders.slice(0))E.cancel(f)}}d.PDFNodeStream=lt;class j{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null;const v=f.source;this._contentLength=v.length,this._loaded=0,this._filename=null,this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._readableStream=null,this._readCapability=new c.PromiseCapability,this._headersCapability=new c.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var E;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new c.PromiseCapability,this.read()):(this._loaded+=f.length,(E=this.onProgress)==null||E.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",v=>{this._error(v)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new c.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class R{constructor(f){this._url=f.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new c.PromiseCapability;const v=f.source;this._isStreamingSupported=!v.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var E;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const f=this._readableStream.read();return f===null?(this._readCapability=new c.PromiseCapability,this.read()):(this._loaded+=f.length,(E=this.onProgress)==null||E.call(this,{loaded:this._loaded}),{value:new Uint8Array(f).buffer,done:!1})}cancel(f){if(!this._readableStream){this._error(f);return}this._readableStream.destroy(f)}_error(f){this._storedError=f,this._readCapability.resolve()}_setReadableStream(f){this._readableStream=f,f.on("readable",()=>{this._readCapability.resolve()}),f.on("end",()=>{f.destroy(),this._done=!0,this._readCapability.resolve()}),f.on("error",v=>{this._error(v)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function p(A,f){return{protocol:A.protocol,auth:A.auth,host:A.hostname,port:A.port,path:A.path,method:"GET",headers:f}}class L extends j{constructor(f){super(f);const v=E=>{if(E.statusCode===404){const o=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=o,this._headersCapability.reject(o);return}this._headersCapability.resolve(),this._setReadableStream(E);const P=o=>this._readableStream.headers[o.toLowerCase()],{allowRangeRequests:g,suggestedLength:n}=(0,x.validateRangeRequestCapabilities)({getResponseHeader:P,isHttp:f.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=g,this._contentLength=n||this._contentLength,this._filename=(0,x.extractFilenameFromHeader)(P)};if(this._request=null,this._url.protocol==="http:"){const E=require$$5;this._request=E.request(p(this._url,f.httpHeaders),v)}else{const E=require$$5;this._request=E.request(p(this._url,f.httpHeaders),v)}this._request.on("error",E=>{this._storedError=E,this._headersCapability.reject(E)}),this._request.end()}}class B extends R{constructor(f,v,E){super(f),this._httpHeaders={};for(const g in f.httpHeaders){const n=f.httpHeaders[g];n!==void 0&&(this._httpHeaders[g]=n)}this._httpHeaders.Range=`bytes=${v}-${E-1}`;const P=g=>{if(g.statusCode===404){const n=new c.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=n;return}this._setReadableStream(g)};if(this._request=null,this._url.protocol==="http:"){const g=require$$5;this._request=g.request(p(this._url,this._httpHeaders),P)}else{const g=require$$5;this._request=g.request(p(this._url,this._httpHeaders),P)}this._request.on("error",g=>{this._storedError=g}),this._request.end()}}class w extends j{constructor(f){super(f);let v=decodeURIComponent(this._url.path);et.test(this._url.href)&&(v=v.replace(/^\//,""));const E=require$$5;E.lstat(v,(P,g)=>{if(P){P.code==="ENOENT"&&(P=new c.MissingPDFException(`Missing PDF "${v}".`)),this._storedError=P,this._headersCapability.reject(P);return}this._contentLength=g.size,this._setReadableStream(E.createReadStream(v)),this._headersCapability.resolve()})}}class y extends R{constructor(f,v,E){super(f);let P=decodeURIComponent(this._url.path);et.test(this._url.href)&&(P=P.replace(/^\//,""));const g=require$$5;this._setReadableStream(g.createReadStream(P,{start:v,end:E-1}))}}},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.SVGGraphics=void 0;var c=nt(6),x=nt(1);const et={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},J="http://www.w3.org/XML/1998/namespace",lt="http://www.w3.org/1999/xlink",j=["butt","round","square"],R=["miter","round","bevel"],p=function(g,n="",o=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!o)return URL.createObjectURL(new Blob([g],{type:n}));const F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let b=`data:${n};base64,`;for(let s=0,l=g.length;s<l;s+=3){const r=g[s]&255,I=g[s+1]&255,O=g[s+2]&255,V=r>>2,_=(r&3)<<4|I>>4,G=s+1<l?(I&15)<<2|O>>6:64,M=s+2<l?O&63:64;b+=F[V]+F[_]+F[G]+F[M]}return b},L=function(){const g=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,o=new Int32Array(256);for(let O=0;O<256;O++){let V=O;for(let _=0;_<8;_++)V=V&1?3988292384^V>>1&2147483647:V>>1&2147483647;o[O]=V}function F(O,V,_){let G=-1;for(let M=V;M<_;M++){const k=(G^O[M])&255,$=o[k];G=G>>>8^$}return G^-1}function b(O,V,_,G){let M=G;const k=V.length;_[M]=k>>24&255,_[M+1]=k>>16&255,_[M+2]=k>>8&255,_[M+3]=k&255,M+=4,_[M]=O.charCodeAt(0)&255,_[M+1]=O.charCodeAt(1)&255,_[M+2]=O.charCodeAt(2)&255,_[M+3]=O.charCodeAt(3)&255,M+=4,_.set(V,M),M+=V.length;const $=F(_,G+4,M);_[M]=$>>24&255,_[M+1]=$>>16&255,_[M+2]=$>>8&255,_[M+3]=$&255}function s(O,V,_){let G=1,M=0;for(let k=V;k<_;++k)G=(G+(O[k]&255))%65521,M=(M+G)%65521;return M<<16|G}function l(O){if(!x.isNodeJS)return r(O);try{const V=parseInt(process.versions.node)>=8?O:Buffer.from(O),_=require$$5.deflateSync(V,{level:9});return _ instanceof Uint8Array?_:new Uint8Array(_)}catch(V){(0,x.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+V)}return r(O)}function r(O){let V=O.length;const _=65535,G=Math.ceil(V/_),M=new Uint8Array(2+V+G*5+4);let k=0;M[k++]=120,M[k++]=156;let $=0;for(;V>_;)M[k++]=0,M[k++]=255,M[k++]=255,M[k++]=0,M[k++]=0,M.set(O.subarray($,$+_),k),k+=_,$+=_,V-=_;M[k++]=1,M[k++]=V&255,M[k++]=V>>8&255,M[k++]=~V&65535&255,M[k++]=(~V&65535)>>8&255,M.set(O.subarray($),k),k+=O.length-$;const it=s(O,0,O.length);return M[k++]=it>>24&255,M[k++]=it>>16&255,M[k++]=it>>8&255,M[k++]=it&255,M}function I(O,V,_,G){const M=O.width,k=O.height;let $,it,pt;const _t=O.data;switch(V){case x.ImageKind.GRAYSCALE_1BPP:it=0,$=1,pt=M+7>>3;break;case x.ImageKind.RGB_24BPP:it=2,$=8,pt=M*3;break;case x.ImageKind.RGBA_32BPP:it=6,$=8,pt=M*4;break;default:throw new Error("invalid format")}const D=new Uint8Array((1+pt)*k);let i=0,e=0;for(let Y=0;Y<k;++Y)D[i++]=0,D.set(_t.subarray(e,e+pt),i),e+=pt,i+=pt;if(V===x.ImageKind.GRAYSCALE_1BPP&&G){i=0;for(let Y=0;Y<k;Y++){i++;for(let dt=0;dt<pt;dt++)D[i++]^=255}}const m=new Uint8Array([M>>24&255,M>>16&255,M>>8&255,M&255,k>>24&255,k>>16&255,k>>8&255,k&255,$,it,0,0,0]),N=l(D),T=g.length+n*3+m.length+N.length,H=new Uint8Array(T);let z=0;return H.set(g,z),z+=g.length,b("IHDR",m,H,z),z+=n+m.length,b("IDATA",N,H,z),z+=n+N.length,b("IEND",new Uint8Array(0),H,z),p(H,"image/png",_)}return function(V,_,G){const M=V.kind===void 0?x.ImageKind.GRAYSCALE_1BPP:V.kind;return I(V,M,_,G)}}();class B{constructor(){this.fontSizeScale=1,this.fontWeight=et.fontWeight,this.fontSize=0,this.textMatrix=x.IDENTITY_MATRIX,this.fontMatrix=x.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=x.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=et.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,o){this.x=n,this.y=o}}function w(g){let n=[];const o=[];for(const F of g){if(F.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),o.push(n),n=n.at(-1).items;continue}F.fn==="restore"?n=o.pop():n.push(F)}return n}function y(g){if(Number.isInteger(g))return g.toString();const n=g.toFixed(10);let o=n.length-1;if(n[o]!=="0")return n;do o--;while(n[o]==="0");return n.substring(0,n[o]==="."?o:o+1)}function A(g){if(g[4]===0&&g[5]===0){if(g[1]===0&&g[2]===0)return g[0]===1&&g[3]===1?"":`scale(${y(g[0])} ${y(g[3])})`;if(g[0]===g[3]&&g[1]===-g[2]){const n=Math.acos(g[0])*180/Math.PI;return`rotate(${y(n)})`}}else if(g[0]===1&&g[1]===0&&g[2]===0&&g[3]===1)return`translate(${y(g[4])} ${y(g[5])})`;return`matrix(${y(g[0])} ${y(g[1])} ${y(g[2])} ${y(g[3])} ${y(g[4])} ${y(g[5])})`}let f=0,v=0,E=0;class P{constructor(n,o,F=!1){(0,c.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new c.DOMSVGFactory,this.current=new B,this.transformMatrix=x.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=n,this.objs=o,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!F,this._operatorIdMapping=[];for(const b in x.OPS)this._operatorIdMapping[x.OPS[b]]=b}getObject(n,o=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):o}save(){this.transformStack.push(this.transformMatrix);const n=this.current;this.extraStack.push(n),this.current=n.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(n){this.save(),this.executeOpTree(n),this.restore()}loadDependencies(n){const o=n.fnArray,F=n.argsArray;for(let b=0,s=o.length;b<s;b++)if(o[b]===x.OPS.dependency)for(const l of F[b]){const r=l.startsWith("g_")?this.commonObjs:this.objs,I=new Promise(O=>{r.get(l,O)});this.current.dependencies.push(I)}return Promise.all(this.current.dependencies)}transform(n,o,F,b,s,l){const r=[n,o,F,b,s,l];this.transformMatrix=x.Util.transform(this.transformMatrix,r),this.tgrp=null}getSVG(n,o){this.viewport=o;const F=this._initialize(o);return this.loadDependencies(n).then(()=>(this.transformMatrix=x.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(n)),F))}convertOpList(n){const o=this._operatorIdMapping,F=n.argsArray,b=n.fnArray,s=[];for(let l=0,r=b.length;l<r;l++){const I=b[l];s.push({fnId:I,fn:o[I],args:F[l]})}return w(s)}executeOpTree(n){for(const o of n){const F=o.fn,b=o.fnId,s=o.args;switch(b|0){case x.OPS.beginText:this.beginText();break;case x.OPS.dependency:break;case x.OPS.setLeading:this.setLeading(s);break;case x.OPS.setLeadingMoveText:this.setLeadingMoveText(s[0],s[1]);break;case x.OPS.setFont:this.setFont(s);break;case x.OPS.showText:this.showText(s[0]);break;case x.OPS.showSpacedText:this.showText(s[0]);break;case x.OPS.endText:this.endText();break;case x.OPS.moveText:this.moveText(s[0],s[1]);break;case x.OPS.setCharSpacing:this.setCharSpacing(s[0]);break;case x.OPS.setWordSpacing:this.setWordSpacing(s[0]);break;case x.OPS.setHScale:this.setHScale(s[0]);break;case x.OPS.setTextMatrix:this.setTextMatrix(s[0],s[1],s[2],s[3],s[4],s[5]);break;case x.OPS.setTextRise:this.setTextRise(s[0]);break;case x.OPS.setTextRenderingMode:this.setTextRenderingMode(s[0]);break;case x.OPS.setLineWidth:this.setLineWidth(s[0]);break;case x.OPS.setLineJoin:this.setLineJoin(s[0]);break;case x.OPS.setLineCap:this.setLineCap(s[0]);break;case x.OPS.setMiterLimit:this.setMiterLimit(s[0]);break;case x.OPS.setFillRGBColor:this.setFillRGBColor(s[0],s[1],s[2]);break;case x.OPS.setStrokeRGBColor:this.setStrokeRGBColor(s[0],s[1],s[2]);break;case x.OPS.setStrokeColorN:this.setStrokeColorN(s);break;case x.OPS.setFillColorN:this.setFillColorN(s);break;case x.OPS.shadingFill:this.shadingFill(s[0]);break;case x.OPS.setDash:this.setDash(s[0],s[1]);break;case x.OPS.setRenderingIntent:this.setRenderingIntent(s[0]);break;case x.OPS.setFlatness:this.setFlatness(s[0]);break;case x.OPS.setGState:this.setGState(s[0]);break;case x.OPS.fill:this.fill();break;case x.OPS.eoFill:this.eoFill();break;case x.OPS.stroke:this.stroke();break;case x.OPS.fillStroke:this.fillStroke();break;case x.OPS.eoFillStroke:this.eoFillStroke();break;case x.OPS.clip:this.clip("nonzero");break;case x.OPS.eoClip:this.clip("evenodd");break;case x.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case x.OPS.paintImageXObject:this.paintImageXObject(s[0]);break;case x.OPS.paintInlineImageXObject:this.paintInlineImageXObject(s[0]);break;case x.OPS.paintImageMaskXObject:this.paintImageMaskXObject(s[0]);break;case x.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(s[0],s[1]);break;case x.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case x.OPS.closePath:this.closePath();break;case x.OPS.closeStroke:this.closeStroke();break;case x.OPS.closeFillStroke:this.closeFillStroke();break;case x.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case x.OPS.nextLine:this.nextLine();break;case x.OPS.transform:this.transform(s[0],s[1],s[2],s[3],s[4],s[5]);break;case x.OPS.constructPath:this.constructPath(s[0],s[1]);break;case x.OPS.endPath:this.endPath();break;case 92:this.group(o.items);break;default:(0,x.warn)(`Unimplemented operator ${F}`);break}}}setWordSpacing(n){this.current.wordSpacing=n}setCharSpacing(n){this.current.charSpacing=n}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(n,o,F,b,s,l){const r=this.current;r.textMatrix=r.lineMatrix=[n,o,F,b,s,l],r.textMatrixScale=Math.hypot(n,o),r.x=r.lineX=0,r.y=r.lineY=0,r.xcoords=[],r.ycoords=[],r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${y(r.fontSize)}px`),r.tspan.setAttributeNS(null,"y",y(-r.y)),r.txtElement=this.svgFactory.createElement("svg:text"),r.txtElement.append(r.tspan)}beginText(){const n=this.current;n.x=n.lineX=0,n.y=n.lineY=0,n.textMatrix=x.IDENTITY_MATRIX,n.lineMatrix=x.IDENTITY_MATRIX,n.textMatrixScale=1,n.tspan=this.svgFactory.createElement("svg:tspan"),n.txtElement=this.svgFactory.createElement("svg:text"),n.txtgrp=this.svgFactory.createElement("svg:g"),n.xcoords=[],n.ycoords=[]}moveText(n,o){const F=this.current;F.x=F.lineX+=n,F.y=F.lineY+=o,F.xcoords=[],F.ycoords=[],F.tspan=this.svgFactory.createElement("svg:tspan"),F.tspan.setAttributeNS(null,"font-family",F.fontFamily),F.tspan.setAttributeNS(null,"font-size",`${y(F.fontSize)}px`),F.tspan.setAttributeNS(null,"y",y(-F.y))}showText(n){const o=this.current,F=o.font,b=o.fontSize;if(b===0)return;const s=o.fontSizeScale,l=o.charSpacing,r=o.wordSpacing,I=o.fontDirection,O=o.textHScale*I,V=F.vertical,_=V?1:-1,G=F.defaultVMetrics,M=b*o.fontMatrix[0];let k=0;for(const pt of n){if(pt===null){k+=I*r;continue}else if(typeof pt=="number"){k+=_*pt*b/1e3;continue}const _t=(pt.isSpace?r:0)+l,D=pt.fontChar;let i,e,m=pt.width;if(V){let T;const H=pt.vmetric||G;T=pt.vmetric?H[1]:m*.5,T=-T*M;const z=H[2]*M;m=H?-H[0]:m,i=T/s,e=(k+z)/s}else i=k/s,e=0;(pt.isInFont||F.missingFile)&&(o.xcoords.push(o.x+i),V&&o.ycoords.push(-o.y+e),o.tspan.textContent+=D);const N=V?m*M-_t*I:m*M+_t*I;k+=N}o.tspan.setAttributeNS(null,"x",o.xcoords.map(y).join(" ")),V?o.tspan.setAttributeNS(null,"y",o.ycoords.map(y).join(" ")):o.tspan.setAttributeNS(null,"y",y(-o.y)),V?o.y-=k:o.x+=k*O,o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${y(o.fontSize)}px`),o.fontStyle!==et.fontStyle&&o.tspan.setAttributeNS(null,"font-style",o.fontStyle),o.fontWeight!==et.fontWeight&&o.tspan.setAttributeNS(null,"font-weight",o.fontWeight);const $=o.textRenderingMode&x.TextRenderingMode.FILL_STROKE_MASK;if($===x.TextRenderingMode.FILL||$===x.TextRenderingMode.FILL_STROKE?(o.fillColor!==et.fillColor&&o.tspan.setAttributeNS(null,"fill",o.fillColor),o.fillAlpha<1&&o.tspan.setAttributeNS(null,"fill-opacity",o.fillAlpha)):o.textRenderingMode===x.TextRenderingMode.ADD_TO_PATH?o.tspan.setAttributeNS(null,"fill","transparent"):o.tspan.setAttributeNS(null,"fill","none"),$===x.TextRenderingMode.STROKE||$===x.TextRenderingMode.FILL_STROKE){const pt=1/(o.textMatrixScale||1);this._setStrokeAttributes(o.tspan,pt)}let it=o.textMatrix;o.textRise!==0&&(it=it.slice(),it[5]+=o.textRise),o.txtElement.setAttributeNS(null,"transform",`${A(it)} scale(${y(O)}, -1)`),o.txtElement.setAttributeNS(J,"xml:space","preserve"),o.txtElement.append(o.tspan),o.txtgrp.append(o.txtElement),this._ensureTransformGroup().append(o.txtElement)}setLeadingMoveText(n,o){this.setLeading(-o),this.moveText(n,o)}addFontStyle(n){if(!n.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const o=p(n.data,n.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${n.loadedName}"; src: url(${o}); }
`}setFont(n){const o=this.current,F=this.commonObjs.get(n[0]);let b=n[1];o.font=F,this.embedFonts&&!F.missingFile&&!this.embeddedFonts[F.loadedName]&&(this.addFontStyle(F),this.embeddedFonts[F.loadedName]=F),o.fontMatrix=F.fontMatrix||x.FONT_IDENTITY_MATRIX;let s="normal";F.black?s="900":F.bold&&(s="bold");const l=F.italic?"italic":"normal";b<0?(b=-b,o.fontDirection=-1):o.fontDirection=1,o.fontSize=b,o.fontFamily=F.loadedName,o.fontWeight=s,o.fontStyle=l,o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"y",y(-o.y)),o.xcoords=[],o.ycoords=[]}endText(){var o;const n=this.current;n.textRenderingMode&x.TextRenderingMode.ADD_TO_PATH_FLAG&&((o=n.txtElement)!=null&&o.hasChildNodes())&&(n.element=n.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(n){n>0&&(this.current.lineWidth=n)}setLineCap(n){this.current.lineCap=j[n]}setLineJoin(n){this.current.lineJoin=R[n]}setMiterLimit(n){this.current.miterLimit=n}setStrokeAlpha(n){this.current.strokeAlpha=n}setStrokeRGBColor(n,o,F){this.current.strokeColor=x.Util.makeHexColor(n,o,F)}setFillAlpha(n){this.current.fillAlpha=n}setFillRGBColor(n,o,F){this.current.fillColor=x.Util.makeHexColor(n,o,F),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(n){this.current.strokeColor=this._makeColorN_Pattern(n)}setFillColorN(n){this.current.fillColor=this._makeColorN_Pattern(n)}shadingFill(n){const{width:o,height:F}=this.viewport,b=x.Util.inverseTransform(this.transformMatrix),[s,l,r,I]=x.Util.getAxialAlignedBoundingBox([0,0,o,F],b),O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x",s),O.setAttributeNS(null,"y",l),O.setAttributeNS(null,"width",r-s),O.setAttributeNS(null,"height",I-l),O.setAttributeNS(null,"fill",this._makeShadingPattern(n)),this.current.fillAlpha<1&&O.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(O)}_makeColorN_Pattern(n){return n[0]==="TilingPattern"?this._makeTilingPattern(n):this._makeShadingPattern(n)}_makeTilingPattern(n){const o=n[1],F=n[2],b=n[3]||x.IDENTITY_MATRIX,[s,l,r,I]=n[4],O=n[5],V=n[6],_=n[7],G=`shading${E++}`,[M,k,$,it]=x.Util.normalizeRect([...x.Util.applyTransform([s,l],b),...x.Util.applyTransform([r,I],b)]),[pt,_t]=x.Util.singularValueDecompose2dScale(b),D=O*pt,i=V*_t,e=this.svgFactory.createElement("svg:pattern");e.setAttributeNS(null,"id",G),e.setAttributeNS(null,"patternUnits","userSpaceOnUse"),e.setAttributeNS(null,"width",D),e.setAttributeNS(null,"height",i),e.setAttributeNS(null,"x",`${M}`),e.setAttributeNS(null,"y",`${k}`);const m=this.svg,N=this.transformMatrix,T=this.current.fillColor,H=this.current.strokeColor,z=this.svgFactory.create($-M,it-k);if(this.svg=z,this.transformMatrix=b,_===2){const Y=x.Util.makeHexColor(...o);this.current.fillColor=Y,this.current.strokeColor=Y}return this.executeOpTree(this.convertOpList(F)),this.svg=m,this.transformMatrix=N,this.current.fillColor=T,this.current.strokeColor=H,e.append(z.childNodes[0]),this.defs.append(e),`url(#${G})`}_makeShadingPattern(n){switch(typeof n=="string"&&(n=this.objs.get(n)),n[0]){case"RadialAxial":const o=`shading${E++}`,F=n[3];let b;switch(n[1]){case"axial":const s=n[4],l=n[5];b=this.svgFactory.createElement("svg:linearGradient"),b.setAttributeNS(null,"id",o),b.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),b.setAttributeNS(null,"x1",s[0]),b.setAttributeNS(null,"y1",s[1]),b.setAttributeNS(null,"x2",l[0]),b.setAttributeNS(null,"y2",l[1]);break;case"radial":const r=n[4],I=n[5],O=n[6],V=n[7];b=this.svgFactory.createElement("svg:radialGradient"),b.setAttributeNS(null,"id",o),b.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),b.setAttributeNS(null,"cx",I[0]),b.setAttributeNS(null,"cy",I[1]),b.setAttributeNS(null,"r",V),b.setAttributeNS(null,"fx",r[0]),b.setAttributeNS(null,"fy",r[1]),b.setAttributeNS(null,"fr",O);break;default:throw new Error(`Unknown RadialAxial type: ${n[1]}`)}for(const s of F){const l=this.svgFactory.createElement("svg:stop");l.setAttributeNS(null,"offset",s[0]),l.setAttributeNS(null,"stop-color",s[1]),b.append(l)}return this.defs.append(b),`url(#${o})`;case"Mesh":return(0,x.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${n[0]}`)}}setDash(n,o){this.current.dashArray=n,this.current.dashPhase=o}constructPath(n,o){const F=this.current;let b=F.x,s=F.y,l=[],r=0;for(const I of n)switch(I|0){case x.OPS.rectangle:b=o[r++],s=o[r++];const O=o[r++],V=o[r++],_=b+O,G=s+V;l.push("M",y(b),y(s),"L",y(_),y(s),"L",y(_),y(G),"L",y(b),y(G),"Z");break;case x.OPS.moveTo:b=o[r++],s=o[r++],l.push("M",y(b),y(s));break;case x.OPS.lineTo:b=o[r++],s=o[r++],l.push("L",y(b),y(s));break;case x.OPS.curveTo:b=o[r+4],s=o[r+5],l.push("C",y(o[r]),y(o[r+1]),y(o[r+2]),y(o[r+3]),y(b),y(s)),r+=6;break;case x.OPS.curveTo2:l.push("C",y(b),y(s),y(o[r]),y(o[r+1]),y(o[r+2]),y(o[r+3])),b=o[r+2],s=o[r+3],r+=4;break;case x.OPS.curveTo3:b=o[r+2],s=o[r+3],l.push("C",y(o[r]),y(o[r+1]),y(b),y(s),y(b),y(s)),r+=4;break;case x.OPS.closePath:l.push("Z");break}l=l.join(" "),F.path&&n.length>0&&n[0]!==x.OPS.rectangle&&n[0]!==x.OPS.moveTo?l=F.path.getAttributeNS(null,"d")+l:(F.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(F.path)),F.path.setAttributeNS(null,"d",l),F.path.setAttributeNS(null,"fill","none"),F.element=F.path,F.setCurrentPoint(b,s)}endPath(){const n=this.current;if(n.path=null,!this.pendingClip)return;if(!n.element){this.pendingClip=null;return}const o=`clippath${f++}`,F=this.svgFactory.createElement("svg:clipPath");F.setAttributeNS(null,"id",o),F.setAttributeNS(null,"transform",A(this.transformMatrix));const b=n.element.cloneNode(!0);if(this.pendingClip==="evenodd"?b.setAttributeNS(null,"clip-rule","evenodd"):b.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,F.append(b),this.defs.append(F),n.activeClipUrl){n.clipGroup=null;for(const s of this.extraStack)s.clipGroup=null;F.setAttributeNS(null,"clip-path",n.activeClipUrl)}n.activeClipUrl=`url(#${o})`,this.tgrp=null}clip(n){this.pendingClip=n}closePath(){const n=this.current;if(n.path){const o=`${n.path.getAttributeNS(null,"d")}Z`;n.path.setAttributeNS(null,"d",o)}}setLeading(n){this.current.leading=-n}setTextRise(n){this.current.textRise=n}setTextRenderingMode(n){this.current.textRenderingMode=n}setHScale(n){this.current.textHScale=n/100}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[o,F]of n)switch(o){case"LW":this.setLineWidth(F);break;case"LC":this.setLineCap(F);break;case"LJ":this.setLineJoin(F);break;case"ML":this.setMiterLimit(F);break;case"D":this.setDash(F[0],F[1]);break;case"RI":this.setRenderingIntent(F);break;case"FL":this.setFlatness(F);break;case"Font":this.setFont(F);break;case"CA":this.setStrokeAlpha(F);break;case"ca":this.setFillAlpha(F);break;default:(0,x.warn)(`Unimplemented graphic state operator ${o}`);break}}fill(){const n=this.current;n.element&&(n.element.setAttributeNS(null,"fill",n.fillColor),n.element.setAttributeNS(null,"fill-opacity",n.fillAlpha),this.endPath())}stroke(){const n=this.current;n.element&&(this._setStrokeAttributes(n.element),n.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(n,o=1){const F=this.current;let b=F.dashArray;o!==1&&b.length>0&&(b=b.map(function(s){return o*s})),n.setAttributeNS(null,"stroke",F.strokeColor),n.setAttributeNS(null,"stroke-opacity",F.strokeAlpha),n.setAttributeNS(null,"stroke-miterlimit",y(F.miterLimit)),n.setAttributeNS(null,"stroke-linecap",F.lineCap),n.setAttributeNS(null,"stroke-linejoin",F.lineJoin),n.setAttributeNS(null,"stroke-width",y(o*F.lineWidth)+"px"),n.setAttributeNS(null,"stroke-dasharray",b.map(y).join(" ")),n.setAttributeNS(null,"stroke-dashoffset",y(o*F.dashPhase)+"px")}eoFill(){var n;(n=this.current.element)==null||n.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var n;(n=this.current.element)==null||n.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const n=this.svgFactory.createElement("svg:rect");n.setAttributeNS(null,"x","0"),n.setAttributeNS(null,"y","0"),n.setAttributeNS(null,"width","1px"),n.setAttributeNS(null,"height","1px"),n.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(n)}paintImageXObject(n){const o=this.getObject(n);if(!o){(0,x.warn)(`Dependent image with object ID ${n} is not ready yet`);return}this.paintInlineImageXObject(o)}paintInlineImageXObject(n,o){const F=n.width,b=n.height,s=L(n,this.forceDataSchema,!!o),l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width",y(F)),l.setAttributeNS(null,"height",y(b)),this.current.element=l,this.clip("nonzero");const r=this.svgFactory.createElement("svg:image");r.setAttributeNS(lt,"xlink:href",s),r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y",y(-b)),r.setAttributeNS(null,"width",y(F)+"px"),r.setAttributeNS(null,"height",y(b)+"px"),r.setAttributeNS(null,"transform",`scale(${y(1/F)} ${y(-1/b)})`),o?o.append(r):this._ensureTransformGroup().append(r)}paintImageMaskXObject(n){const o=this.getObject(n.data,n);if(o.bitmap){(0,x.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const F=this.current,b=o.width,s=o.height,l=F.fillColor;F.maskId=`mask${v++}`;const r=this.svgFactory.createElement("svg:mask");r.setAttributeNS(null,"id",F.maskId);const I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width",y(b)),I.setAttributeNS(null,"height",y(s)),I.setAttributeNS(null,"fill",l),I.setAttributeNS(null,"mask",`url(#${F.maskId})`),this.defs.append(r),this._ensureTransformGroup().append(I),this.paintInlineImageXObject(o,r)}paintFormXObjectBegin(n,o){if(Array.isArray(n)&&n.length===6&&this.transform(n[0],n[1],n[2],n[3],n[4],n[5]),o){const F=o[2]-o[0],b=o[3]-o[1],s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x",o[0]),s.setAttributeNS(null,"y",o[1]),s.setAttributeNS(null,"width",y(F)),s.setAttributeNS(null,"height",y(b)),this.current.element=s,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(n){const o=this.svgFactory.create(n.width,n.height),F=this.svgFactory.createElement("svg:defs");o.append(F),this.defs=F;const b=this.svgFactory.createElement("svg:g");return b.setAttributeNS(null,"transform",A(n.transform)),o.append(b),this.svg=b,o}_ensureClipGroup(){if(!this.current.clipGroup){const n=this.svgFactory.createElement("svg:g");n.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(n),this.current.clipGroup=n}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",A(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}d.SVGGraphics=P},(bt,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.XfaText=void 0;class nt{static textContent(x){const et=[],J={items:et,styles:Object.create(null)};function lt(j){var L;if(!j)return;let R=null;const p=j.name;if(p==="#text")R=j.value;else if(nt.shouldBuildText(p))(L=j==null?void 0:j.attributes)!=null&&L.textContent?R=j.attributes.textContent:j.value&&(R=j.value);else return;if(R!==null&&et.push({str:R}),!!j.children)for(const B of j.children)lt(B)}return lt(x),J}static shouldBuildText(x){return!(x==="textarea"||x==="input"||x==="option"||x==="select")}}d.XfaText=nt},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.TextLayerRenderTask=void 0,d.renderTextLayer=A,d.updateTextLayer=f;var c=nt(1),x=nt(6);const et=1e5,J=30,lt=.8,j=new Map;function R(v,E){let P;if(E&&c.FeatureTest.isOffscreenCanvasSupported)P=new OffscreenCanvas(v,v).getContext("2d",{alpha:!1});else{const g=document.createElement("canvas");g.width=g.height=v,P=g.getContext("2d",{alpha:!1})}return P}function p(v,E){const P=j.get(v);if(P)return P;const g=R(J,E);g.font=`${J}px ${v}`;const n=g.measureText("");let o=n.fontBoundingBoxAscent,F=Math.abs(n.fontBoundingBoxDescent);if(o){const s=o/(o+F);return j.set(v,s),g.canvas.width=g.canvas.height=0,s}g.strokeStyle="red",g.clearRect(0,0,J,J),g.strokeText("g",0,0);let b=g.getImageData(0,0,J,J).data;F=0;for(let s=b.length-1-3;s>=0;s-=4)if(b[s]>0){F=Math.ceil(s/4/J);break}g.clearRect(0,0,J,J),g.strokeText("A",0,J),b=g.getImageData(0,0,J,J).data,o=0;for(let s=0,l=b.length;s<l;s+=4)if(b[s]>0){o=J-Math.floor(s/4/J);break}if(g.canvas.width=g.canvas.height=0,o){const s=o/(o+F);return j.set(v,s),s}return j.set(v,lt),lt}function L(v,E,P){const g=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:E.str!=="",hasEOL:E.hasEOL,fontSize:0};v._textDivs.push(g);const o=c.Util.transform(v._transform,E.transform);let F=Math.atan2(o[1],o[0]);const b=P[E.fontName];b.vertical&&(F+=Math.PI/2);const s=Math.hypot(o[2],o[3]),l=s*p(b.fontFamily,v._isOffscreenCanvasSupported);let r,I;F===0?(r=o[4],I=o[5]-l):(r=o[4]+l*Math.sin(F),I=o[5]-l*Math.cos(F));const O="calc(var(--scale-factor)*",V=g.style;v._container===v._rootContainer?(V.left=`${(100*r/v._pageWidth).toFixed(2)}%`,V.top=`${(100*I/v._pageHeight).toFixed(2)}%`):(V.left=`${O}${r.toFixed(2)}px)`,V.top=`${O}${I.toFixed(2)}px)`),V.fontSize=`${O}${s.toFixed(2)}px)`,V.fontFamily=b.fontFamily,n.fontSize=s,g.setAttribute("role","presentation"),g.textContent=E.str,g.dir=E.dir,v._fontInspectorEnabled&&(g.dataset.fontName=E.fontName),F!==0&&(n.angle=F*(180/Math.PI));let _=!1;if(E.str.length>1)_=!0;else if(E.str!==" "&&E.transform[0]!==E.transform[3]){const G=Math.abs(E.transform[0]),M=Math.abs(E.transform[3]);G!==M&&Math.max(G,M)/Math.min(G,M)>1.5&&(_=!0)}_&&(n.canvasWidth=b.vertical?E.height:E.width),v._textDivProperties.set(g,n),v._isReadableStream&&v._layoutText(g)}function B(v){const{div:E,scale:P,properties:g,ctx:n,prevFontSize:o,prevFontFamily:F}=v,{style:b}=E;let s="";if(g.canvasWidth!==0&&g.hasText){const{fontFamily:l}=b,{canvasWidth:r,fontSize:I}=g;(o!==I||F!==l)&&(n.font=`${I*P}px ${l}`,v.prevFontSize=I,v.prevFontFamily=l);const{width:O}=n.measureText(E.textContent);O>0&&(s=`scaleX(${r*P/O})`)}g.angle!==0&&(s=`rotate(${g.angle}deg) ${s}`),s.length>0&&(b.transform=s)}function w(v){if(v._canceled)return;const E=v._textDivs,P=v._capability;if(E.length>et){P.resolve();return}if(!v._isReadableStream)for(const n of E)v._layoutText(n);P.resolve()}class y{constructor({textContentSource:E,container:P,viewport:g,textDivs:n,textDivProperties:o,textContentItemsStr:F,isOffscreenCanvasSupported:b}){var O;this._textContentSource=E,this._isReadableStream=E instanceof ReadableStream,this._container=this._rootContainer=P,this._textDivs=n||[],this._textContentItemsStr=F||[],this._isOffscreenCanvasSupported=b,this._fontInspectorEnabled=!!((O=globalThis.FontInspector)!=null&&O.enabled),this._reader=null,this._textDivProperties=o||new WeakMap,this._canceled=!1,this._capability=new c.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:g.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:R(0,b)};const{pageWidth:s,pageHeight:l,pageX:r,pageY:I}=g.rawDims;this._transform=[1,0,0,-1,-r,I+l],this._pageWidth=s,this._pageHeight=l,(0,x.setLayerDimensions)(P,g),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new c.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new c.AbortException("TextLayer task cancelled."))}_processItems(E,P){for(const g of E){if(g.str===void 0){if(g.type==="beginMarkedContentProps"||g.type==="beginMarkedContent"){const n=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),g.id!==null&&this._container.setAttribute("id",`${g.id}`),n.append(this._container)}else g.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(g.str),L(this,g,P)}}_layoutText(E){const P=this._layoutTextParams.properties=this._textDivProperties.get(E);if(this._layoutTextParams.div=E,B(this._layoutTextParams),P.hasText&&this._container.append(E),P.hasEOL){const g=document.createElement("br");g.setAttribute("role","presentation"),this._container.append(g)}}_render(){const E=new c.PromiseCapability;let P=Object.create(null);if(this._isReadableStream){const g=()=>{this._reader.read().then(({value:n,done:o})=>{if(o){E.resolve();return}Object.assign(P,n.styles),this._processItems(n.items,P),g()},E.reject)};this._reader=this._textContentSource.getReader(),g()}else if(this._textContentSource){const{items:g,styles:n}=this._textContentSource;this._processItems(g,n),E.resolve()}else throw new Error('No "textContentSource" parameter specified.');E.promise.then(()=>{P=null,w(this)},this._capability.reject)}}d.TextLayerRenderTask=y;function A(v){!v.textContentSource&&(v.textContent||v.textContentStream)&&((0,x.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),v.textContentSource=v.textContent||v.textContentStream);const{container:E,viewport:P}=v,g=getComputedStyle(E),n=g.getPropertyValue("visibility"),o=parseFloat(g.getPropertyValue("--scale-factor"));n==="visible"&&(!o||Math.abs(o-P.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const F=new y(v);return F._render(),F}function f({container:v,viewport:E,textDivs:P,textDivProperties:g,isOffscreenCanvasSupported:n,mustRotate:o=!0,mustRescale:F=!0}){if(o&&(0,x.setLayerDimensions)(v,{rotation:E.rotation}),F){const b=R(0,n),l={prevFontSize:null,prevFontFamily:null,div:null,scale:E.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:b};for(const r of P)l.properties=g.get(r),l.div=r,B(l)}}},(bt,d,nt)=>{var L,B,w,y,A,f,v,E,P,g,n,Be,F,gi,s,Ue,r,je;Object.defineProperty(d,"__esModule",{value:!0}),d.AnnotationEditorLayer=void 0;var c=nt(1),x=nt(4),et=nt(5),J=nt(28),lt=nt(33),j=nt(6),R=nt(34);const O=class{constructor({uiManager:_,pageIndex:G,div:M,accessibilityManager:k,annotationLayer:$,viewport:it,l10n:pt}){W(this,n);W(this,F);W(this,s);W(this,r);W(this,L,void 0);W(this,B,!1);W(this,w,null);W(this,y,this.pointerup.bind(this));W(this,A,this.pointerdown.bind(this));W(this,f,new Map);W(this,v,!1);W(this,E,!1);W(this,P,!1);W(this,g,void 0);const _t=[J.FreeTextEditor,lt.InkEditor,R.StampEditor];if(!O._initialized){O._initialized=!0;for(const D of _t)D.initialize(pt)}_.registerEditorTypes(_t),rt(this,g,_),this.pageIndex=G,this.div=M,rt(this,L,k),rt(this,w,$),this.viewport=it,t(this,g).addLayer(this)}get isEmpty(){return t(this,f).size===0}updateToolbar(_){t(this,g).updateToolbar(_)}updateMode(_=t(this,g).getMode()){Q(this,r,je).call(this),_===c.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),t(this,g).unselectAll(),_!==c.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",_===c.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",_===c.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",_===c.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(_){if(!_&&t(this,g).getMode()!==c.AnnotationEditorType.INK)return;if(!_){for(const M of t(this,f).values())if(M.isEmpty()){M.setInBackground();return}}Q(this,s,Ue).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(_){t(this,g).setEditingState(_)}addCommands(_){t(this,g).addCommands(_)}enable(){this.div.style.pointerEvents="auto";const _=new Set;for(const M of t(this,f).values())M.enableEditing(),M.annotationElementId&&_.add(M.annotationElementId);if(!t(this,w))return;const G=t(this,w).getEditableAnnotations();for(const M of G){if(M.hide(),t(this,g).isDeletedAnnotationElement(M.data.id)||_.has(M.data.id))continue;const k=this.deserialize(M);k&&(this.addOrRebuild(k),k.enableEditing())}}disable(){var G;rt(this,P,!0),this.div.style.pointerEvents="none";const _=new Set;for(const M of t(this,f).values()){if(M.disableEditing(),!M.annotationElementId||M.serialize()!==null){_.add(M.annotationElementId);continue}(G=this.getEditableAnnotation(M.annotationElementId))==null||G.show(),M.remove()}if(t(this,w)){const M=t(this,w).getEditableAnnotations();for(const k of M){const{id:$}=k.data;_.has($)||t(this,g).isDeletedAnnotationElement($)||k.show()}}Q(this,r,je).call(this),this.isEmpty&&(this.div.hidden=!0),rt(this,P,!1)}getEditableAnnotation(_){var G;return((G=t(this,w))==null?void 0:G.getEditableAnnotation(_))||null}setActiveEditor(_){t(this,g).getActive()!==_&&t(this,g).setActiveEditor(_)}enableClick(){this.div.addEventListener("pointerdown",t(this,A)),this.div.addEventListener("pointerup",t(this,y))}disableClick(){this.div.removeEventListener("pointerdown",t(this,A)),this.div.removeEventListener("pointerup",t(this,y))}attach(_){t(this,f).set(_.id,_);const{annotationElementId:G}=_;G&&t(this,g).isDeletedAnnotationElement(G)&&t(this,g).removeDeletedAnnotationElement(_)}detach(_){var G;t(this,f).delete(_.id),(G=t(this,L))==null||G.removePointerInTextLayer(_.contentDiv),!t(this,P)&&_.annotationElementId&&t(this,g).addDeletedAnnotationElement(_)}remove(_){this.detach(_),t(this,g).removeEditor(_),_.div.style.display="none",setTimeout(()=>{_.div.style.display="",_.div.remove(),_.isAttachedToDOM=!1,document.activeElement===document.body&&t(this,g).focusMainContainer()},0),t(this,E)||this.addInkEditorIfNeeded(!1)}add(_){if(Q(this,n,Be).call(this,_),t(this,g).addEditor(_),this.attach(_),!_.isAttachedToDOM){const G=_.render();this.div.append(G),_.isAttachedToDOM=!0}this.moveEditorInDOM(_),_.onceAdded(),t(this,g).addToAnnotationStorage(_)}moveEditorInDOM(_){var G;(G=t(this,L))==null||G.moveElementInDOM(this.div,_.div,_.contentDiv,!0)}addOrRebuild(_){_.needsToBeRebuilt()?_.rebuild():this.add(_)}addUndoableEditor(_){const G=()=>{this.addOrRebuild(_)},M=()=>{_.remove()};this.addCommands({cmd:G,undo:M,mustExec:!1})}getNextId(){return t(this,g).getId()}deserialize(_){switch(_.annotationType??_.annotationEditorType){case c.AnnotationEditorType.FREETEXT:return J.FreeTextEditor.deserialize(_,this,t(this,g));case c.AnnotationEditorType.INK:return lt.InkEditor.deserialize(_,this,t(this,g));case c.AnnotationEditorType.STAMP:return R.StampEditor.deserialize(_,this,t(this,g))}return null}setSelected(_){t(this,g).setSelected(_)}toggleSelected(_){t(this,g).toggleSelected(_)}isSelected(_){return t(this,g).isSelected(_)}unselect(_){t(this,g).unselect(_)}pointerup(_){const{isMac:G}=c.FeatureTest.platform;if(!(_.button!==0||_.ctrlKey&&G)&&_.target===this.div&&t(this,v)){if(rt(this,v,!1),!t(this,B)){rt(this,B,!0);return}Q(this,s,Ue).call(this,_)}}pointerdown(_){if(t(this,v)){rt(this,v,!1);return}const{isMac:G}=c.FeatureTest.platform;if(_.button!==0||_.ctrlKey&&G||_.target!==this.div)return;rt(this,v,!0);const M=t(this,g).getActive();rt(this,B,!M||M.isEmpty())}drop(_){const G=_.dataTransfer.getData("text/plain"),M=t(this,g).getEditor(G);if(!M)return;_.preventDefault(),_.dataTransfer.dropEffect="move",Q(this,n,Be).call(this,M);const k=this.div.getBoundingClientRect(),$=_.clientX-k.x,it=_.clientY-k.y;M.translate($-M.startX,it-M.startY),this.moveEditorInDOM(M),M.div.focus()}dragover(_){_.preventDefault()}destroy(){var _,G;((_=t(this,g).getActive())==null?void 0:_.parent)===this&&t(this,g).setActiveEditor(null);for(const M of t(this,f).values())(G=t(this,L))==null||G.removePointerInTextLayer(M.contentDiv),M.setParent(null),M.isAttachedToDOM=!1,M.div.remove();this.div=null,t(this,f).clear(),t(this,g).removeLayer(this)}render({viewport:_}){this.viewport=_,(0,j.setLayerDimensions)(this.div,_),(0,et.bindEvents)(this,this.div,["dragover","drop"]);for(const G of t(this,g).getEditors(this.pageIndex))this.add(G);this.updateMode()}update({viewport:_}){t(this,g).commitOrRemove(),this.viewport=_,(0,j.setLayerDimensions)(this.div,{rotation:_.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:_,pageHeight:G}=this.viewport.rawDims;return[_,G]}};let p=O;L=new WeakMap,B=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakMap,f=new WeakMap,v=new WeakMap,E=new WeakMap,P=new WeakMap,g=new WeakMap,n=new WeakSet,Be=function(_){var G;_.parent!==this&&(_.annotationElementId&&(t(this,g).addDeletedAnnotationElement(_.annotationElementId),x.AnnotationEditor.deleteAnnotationElement(_),_.annotationElementId=null),this.attach(_),(G=_.parent)==null||G.detach(_),_.setParent(this),_.div&&_.isAttachedToDOM&&(_.div.remove(),this.div.append(_.div)))},F=new WeakSet,gi=function(_){switch(t(this,g).getMode()){case c.AnnotationEditorType.FREETEXT:return new J.FreeTextEditor(_);case c.AnnotationEditorType.INK:return new lt.InkEditor(_);case c.AnnotationEditorType.STAMP:return new R.StampEditor(_)}return null},s=new WeakSet,Ue=function(_){const G=this.getNextId(),M=Q(this,F,gi).call(this,{parent:this,id:G,x:_.offsetX,y:_.offsetY,uiManager:t(this,g)});return M&&this.add(M),M},r=new WeakSet,je=function(){rt(this,E,!0);for(const _ of t(this,f).values())_.isEmpty()&&_.remove();rt(this,E,!1)},Yt(p,"_initialized",!1),d.AnnotationEditorLayer=p},(bt,d,nt)=>{var j,R,p,L,B,w,y,A,f,v,mi,P,bi,n,_i,F,ge,s,He,r,Ai,O,We;Object.defineProperty(d,"__esModule",{value:!0}),d.FreeTextEditor=void 0;var c=nt(1),x=nt(5),et=nt(4),J=nt(29);const _=class extends et.AnnotationEditor{constructor(k){super({...k,name:"freeTextEditor"});W(this,v);W(this,P);W(this,n);W(this,F);W(this,s);W(this,r);W(this,O);W(this,j,this.editorDivBlur.bind(this));W(this,R,this.editorDivFocus.bind(this));W(this,p,this.editorDivInput.bind(this));W(this,L,this.editorDivKeydown.bind(this));W(this,B,void 0);W(this,w,"");W(this,y,`${this.id}-editor`);W(this,A,void 0);W(this,f,null);rt(this,B,k.color||_._defaultColor||et.AnnotationEditor._defaultLineColor),rt(this,A,k.fontSize||_._defaultFontSize)}static get _keyboardManager(){const k=_.prototype,$=_t=>_t.isEmpty(),it=x.AnnotationEditorUIManager.TRANSLATE_SMALL,pt=x.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,c.shadow)(this,"_keyboardManager",new x.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],k.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],k.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],k._translateEmpty,{args:[-it,0],checker:$}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],k._translateEmpty,{args:[-pt,0],checker:$}],[["ArrowRight","mac+ArrowRight"],k._translateEmpty,{args:[it,0],checker:$}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],k._translateEmpty,{args:[pt,0],checker:$}],[["ArrowUp","mac+ArrowUp"],k._translateEmpty,{args:[0,-it],checker:$}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],k._translateEmpty,{args:[0,-pt],checker:$}],[["ArrowDown","mac+ArrowDown"],k._translateEmpty,{args:[0,it],checker:$}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],k._translateEmpty,{args:[0,pt],checker:$}]]))}static initialize(k){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(it=>[it,k.get(it)]));const $=getComputedStyle(document.documentElement);this._internalPadding=parseFloat($.getPropertyValue("--freetext-padding"))}static updateDefaultParams(k,$){switch(k){case c.AnnotationEditorParamsType.FREETEXT_SIZE:_._defaultFontSize=$;break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:_._defaultColor=$;break}}updateParams(k,$){switch(k){case c.AnnotationEditorParamsType.FREETEXT_SIZE:Q(this,v,mi).call(this,$);break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:Q(this,P,bi).call(this,$);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,_._defaultFontSize],[c.AnnotationEditorParamsType.FREETEXT_COLOR,_._defaultColor||et.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,A)],[c.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,B)]]}_translateEmpty(k,$){this._uiManager.translateSelectedEditors(k,$,!0)}getInitialTranslation(){const k=this.parentScale;return[-_._internalPadding*k,-(_._internalPadding+t(this,A))*k]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(c.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,L)),this.editorDiv.addEventListener("focus",t(this,R)),this.editorDiv.addEventListener("blur",t(this,j)),this.editorDiv.addEventListener("input",t(this,p)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,y)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",t(this,L)),this.editorDiv.removeEventListener("focus",t(this,R)),this.editorDiv.removeEventListener("blur",t(this,j)),this.editorDiv.removeEventListener("input",t(this,p)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(k){super.focusin(k),k.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){if(this.width){Q(this,O,We).call(this);return}this.enableEditMode(),this.editorDiv.focus()}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const k=t(this,w),$=rt(this,w,Q(this,n,_i).call(this).trimEnd());if(k===$)return;const it=pt=>{if(rt(this,w,pt),!pt){this.remove();return}Q(this,s,He).call(this),this.rebuild(),Q(this,F,ge).call(this)};this.addCommands({cmd:()=>{it($)},undo:()=>{it(k)},mustExec:!1}),Q(this,F,ge).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(k){this.enterInEditMode()}keydown(k){k.target===this.div&&k.key==="Enter"&&this.enterInEditMode()}editorDivKeydown(k){_._keyboardManager.exec(this,k)}editorDivFocus(k){this.isEditing=!0}editorDivBlur(k){this.isEditing=!1}editorDivInput(k){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let k,$;this.width&&(k=this.x,$=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,y)),this.enableEditing(),_._l10nPromise.get("editor_free_text2_aria_label").then(pt=>{var _t;return(_t=this.editorDiv)==null?void 0:_t.setAttribute("aria-label",pt)}),_._l10nPromise.get("free_text2_default_content").then(pt=>{var _t;return(_t=this.editorDiv)==null?void 0:_t.setAttribute("default-content",pt)}),this.editorDiv.contentEditable=!0;const{style:it}=this.editorDiv;if(it.fontSize=`calc(${t(this,A)}px * var(--scale-factor))`,it.color=t(this,B),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,x.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[pt,_t]=this.parentDimensions;if(this.annotationElementId){const{position:D}=t(this,f);let[i,e]=this.getInitialTranslation();[i,e]=this.pageTranslationToScreen(i,e);const[m,N]=this.pageDimensions,[T,H]=this.pageTranslation;let z,Y;switch(this.rotation){case 0:z=k+(D[0]-T)/m,Y=$+this.height-(D[1]-H)/N;break;case 90:z=k+(D[0]-T)/m,Y=$-(D[1]-H)/N,[i,e]=[e,-i];break;case 180:z=k-this.width+(D[0]-T)/m,Y=$-(D[1]-H)/N,[i,e]=[-i,-e];break;case 270:z=k+(D[0]-T-this.height*N)/m,Y=$+(D[1]-H-this.width*m)/N,[i,e]=[-e,i];break}this.setAt(z*pt,Y*_t,i,e)}else this.setAt(k*pt,$*_t,this.width*pt,this.height*_t);Q(this,s,He).call(this),this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(k,$,it){let pt=null;if(k instanceof J.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:D,fontColor:i},rect:e,rotation:m,id:N},textContent:T,textPosition:H,parent:{page:{pageNumber:z}}}=k;if(!T||T.length===0)return null;pt=k={annotationType:c.AnnotationEditorType.FREETEXT,color:Array.from(i),fontSize:D,value:T.join(`
`),position:H,pageIndex:z-1,rect:e,rotation:m,id:N,deleted:!1}}const _t=super.deserialize(k,$,it);return rt(_t,A,k.fontSize),rt(_t,B,c.Util.makeHexColor(...k.color)),rt(_t,w,k.value),_t.annotationElementId=k.id||null,rt(_t,f,pt),_t}serialize(k=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const $=_._internalPadding*this.parentScale,it=this.getRect($,$),pt=et.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,B)),_t={annotationType:c.AnnotationEditorType.FREETEXT,color:pt,fontSize:t(this,A),value:t(this,w),pageIndex:this.pageIndex,rect:it,rotation:this.rotation};return k?_t:this.annotationElementId&&!Q(this,r,Ai).call(this,_t)?null:(_t.id=this.annotationElementId,_t)}};let lt=_;j=new WeakMap,R=new WeakMap,p=new WeakMap,L=new WeakMap,B=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakMap,f=new WeakMap,v=new WeakSet,mi=function(k){const $=pt=>{this.editorDiv.style.fontSize=`calc(${pt}px * var(--scale-factor))`,this.translate(0,-(pt-t(this,A))*this.parentScale),rt(this,A,pt),Q(this,F,ge).call(this)},it=t(this,A);this.addCommands({cmd:()=>{$(k)},undo:()=>{$(it)},mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},P=new WeakSet,bi=function(k){const $=t(this,B);this.addCommands({cmd:()=>{rt(this,B,this.editorDiv.style.color=k)},undo:()=>{rt(this,B,this.editorDiv.style.color=$)},mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},n=new WeakSet,_i=function(){const k=this.editorDiv.getElementsByTagName("div");if(k.length===0)return this.editorDiv.innerText;const $=[];for(const it of k)$.push(it.innerText.replace(/\r\n?|\n/,""));return $.join(`
`)},F=new WeakSet,ge=function(){const[k,$]=this.parentDimensions;let it;if(this.isAttachedToDOM)it=this.div.getBoundingClientRect();else{const{currentLayer:pt,div:_t}=this,D=_t.style.display;_t.style.display="hidden",pt.div.append(this.div),it=_t.getBoundingClientRect(),_t.remove(),_t.style.display=D}this.rotation%180===this.parentRotation%180?(this.width=it.width/k,this.height=it.height/$):(this.width=it.height/k,this.height=it.width/$),this.fixAndSetPosition()},s=new WeakSet,He=function(){if(this.editorDiv.replaceChildren(),!!t(this,w))for(const k of t(this,w).split(`
`)){const $=document.createElement("div");$.append(k?document.createTextNode(k):document.createElement("br")),this.editorDiv.append($)}},r=new WeakSet,Ai=function(k){const{value:$,fontSize:it,color:pt,rect:_t,pageIndex:D}=t(this,f);return k.value!==$||k.fontSize!==it||k.rect.some((i,e)=>Math.abs(i-_t[e])>=1)||k.color.some((i,e)=>i!==pt[e])||k.pageIndex!==D},O=new WeakSet,We=function(k=!1){if(!this.annotationElementId)return;if(Q(this,F,ge).call(this),!k&&(this.width===0||this.height===0)){setTimeout(()=>Q(this,O,We).call(this,!0),0);return}const $=_._internalPadding*this.parentScale;t(this,f).rect=this.getRect($,$)},Yt(lt,"_freeTextDefaultContent",""),Yt(lt,"_l10nPromise"),Yt(lt,"_internalPadding",0),Yt(lt,"_defaultColor",null),Yt(lt,"_defaultFontSize",10),Yt(lt,"_type","freetext"),d.FreeTextEditor=lt},(bt,d,nt)=>{var e,m,re,T,yi,z,Y,dt,at,ht,ft,Ct,At,Rt,Ht,St,Nt,vt,st,tt,gt,yt,ze,Mt,Ge,It,Xe,Wt,Ut,ct,q,K,wt,jt,Lt,$t,Kt,vi,X,Ve;Object.defineProperty(d,"__esModule",{value:!0}),d.StampAnnotationElement=d.InkAnnotationElement=d.FreeTextAnnotationElement=d.AnnotationLayer=void 0;var c=nt(1),x=nt(6),et=nt(3),J=nt(30),lt=nt(31),j=nt(32);const R=1e3,p=9,L=new WeakSet;function B(ot){return{width:ot[2]-ot[0],height:ot[3]-ot[1]}}class w{static create(u){switch(u.data.annotationType){case c.AnnotationType.LINK:return new A(u);case c.AnnotationType.TEXT:return new f(u);case c.AnnotationType.WIDGET:switch(u.data.fieldType){case"Tx":return new E(u);case"Btn":return u.data.radioButton?new n(u):u.data.checkBox?new g(u):new o(u);case"Ch":return new F(u);case"Sig":return new P(u)}return new v(u);case c.AnnotationType.POPUP:return new b(u);case c.AnnotationType.FREETEXT:return new l(u);case c.AnnotationType.LINE:return new r(u);case c.AnnotationType.SQUARE:return new I(u);case c.AnnotationType.CIRCLE:return new O(u);case c.AnnotationType.POLYLINE:return new V(u);case c.AnnotationType.CARET:return new G(u);case c.AnnotationType.INK:return new M(u);case c.AnnotationType.POLYGON:return new _(u);case c.AnnotationType.HIGHLIGHT:return new k(u);case c.AnnotationType.UNDERLINE:return new $(u);case c.AnnotationType.SQUIGGLY:return new it(u);case c.AnnotationType.STRIKEOUT:return new pt(u);case c.AnnotationType.STAMP:return new _t(u);case c.AnnotationType.FILEATTACHMENT:return new D(u);default:return new y(u)}}}class y{constructor(u,{isRenderable:a=!1,ignoreBorder:C=!1,createQuadrilaterals:S=!1}={}){W(this,e,!1);this.isRenderable=a,this.data=u.data,this.layer=u.layer,this.linkService=u.linkService,this.downloadManager=u.downloadManager,this.imageResourcesPath=u.imageResourcesPath,this.renderForms=u.renderForms,this.svgFactory=u.svgFactory,this.annotationStorage=u.annotationStorage,this.enableScripting=u.enableScripting,this.hasJSActions=u.hasJSActions,this._fieldObjects=u.fieldObjects,this.parent=u.parent,a&&(this.container=this._createContainer(C)),S&&this._createQuadrilaterals()}_createContainer(u){const{data:a,parent:{page:C,viewport:S}}=this,U=document.createElement("section");U.setAttribute("data-annotation-id",a.id),U.style.zIndex=this.parent.zIndex++,this.data.popupRef&&U.setAttribute("aria-haspopup","dialog"),a.noRotate&&U.classList.add("norotate");const{pageWidth:Z,pageHeight:mt,pageX:Pt,pageY:kt}=S.rawDims;if(!a.rect||this instanceof b){const{rotation:Dt}=a;return!a.hasOwnCanvas&&Dt!==0&&this.setRotation(Dt,U),U}const{width:Et,height:Ot}=B(a.rect),Tt=c.Util.normalizeRect([a.rect[0],C.view[3]-a.rect[1]+C.view[1],a.rect[2],C.view[3]-a.rect[3]+C.view[1]]);if(!u&&a.borderStyle.width>0){U.style.borderWidth=`${a.borderStyle.width}px`;const Dt=a.borderStyle.horizontalCornerRadius,Bt=a.borderStyle.verticalCornerRadius;if(Dt>0||Bt>0){const Vt=`calc(${Dt}px * var(--scale-factor)) / calc(${Bt}px * var(--scale-factor))`;U.style.borderRadius=Vt}else if(this instanceof n){const Vt=`calc(${Et}px * var(--scale-factor)) / calc(${Ot}px * var(--scale-factor))`;U.style.borderRadius=Vt}switch(a.borderStyle.style){case c.AnnotationBorderStyleType.SOLID:U.style.borderStyle="solid";break;case c.AnnotationBorderStyleType.DASHED:U.style.borderStyle="dashed";break;case c.AnnotationBorderStyleType.BEVELED:(0,c.warn)("Unimplemented border style: beveled");break;case c.AnnotationBorderStyleType.INSET:(0,c.warn)("Unimplemented border style: inset");break;case c.AnnotationBorderStyleType.UNDERLINE:U.style.borderBottomStyle="solid";break}const Gt=a.borderColor||null;Gt?(rt(this,e,!0),U.style.borderColor=c.Util.makeHexColor(Gt[0]|0,Gt[1]|0,Gt[2]|0)):U.style.borderWidth=0}U.style.left=`${100*(Tt[0]-Pt)/Z}%`,U.style.top=`${100*(Tt[1]-kt)/mt}%`;const{rotation:xt}=a;return a.hasOwnCanvas||xt===0?(U.style.width=`${100*Et/Z}%`,U.style.height=`${100*Ot/mt}%`):this.setRotation(xt,U),U}setRotation(u,a=this.container){if(!this.data.rect)return;const{pageWidth:C,pageHeight:S}=this.parent.viewport.rawDims,{width:U,height:Z}=B(this.data.rect);let mt,Pt;u%180===0?(mt=100*U/C,Pt=100*Z/S):(mt=100*Z/C,Pt=100*U/S),a.style.width=`${mt}%`,a.style.height=`${Pt}%`,a.setAttribute("data-main-rotation",(360-u)%360)}get _commonActions(){const u=(a,C,S)=>{const U=S.detail[a];S.target.style[C]=J.ColorConverters[`${U[0]}_HTML`](U.slice(1))};return(0,c.shadow)(this,"_commonActions",{display:a=>{const C=a.detail.display%2===1;this.container.style.visibility=C?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:C,print:a.detail.display===0||a.detail.display===3})},print:a=>{this.annotationStorage.setValue(this.data.id,{print:a.detail.print})},hidden:a=>{this.container.style.visibility=a.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:a.detail.hidden})},focus:a=>{setTimeout(()=>a.target.focus({preventScroll:!1}),0)},userName:a=>{a.target.title=a.detail.userName},readonly:a=>{a.detail.readonly?a.target.setAttribute("readonly",""):a.target.removeAttribute("readonly")},required:a=>{this._setRequired(a.target,a.detail.required)},bgColor:a=>{u("bgColor","backgroundColor",a)},fillColor:a=>{u("fillColor","backgroundColor",a)},fgColor:a=>{u("fgColor","color",a)},textColor:a=>{u("textColor","color",a)},borderColor:a=>{u("borderColor","borderColor",a)},strokeColor:a=>{u("strokeColor","borderColor",a)},rotation:a=>{const C=a.detail.rotation;this.setRotation(C),this.annotationStorage.setValue(this.data.id,{rotation:C})}})}_dispatchEventFromSandbox(u,a){const C=this._commonActions;for(const S of Object.keys(a.detail)){const U=u[S]||C[S];U==null||U(a)}}_setDefaultPropertiesFromJS(u){if(!this.enableScripting)return;const a=this.annotationStorage.getRawValue(this.data.id);if(!a)return;const C=this._commonActions;for(const[S,U]of Object.entries(a)){const Z=C[S];if(Z){const mt={detail:{[S]:U},target:u};Z(mt),delete a[S]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:u}=this.data;if(!u)return;const[a,C,S,U]=this.data.rect;if(u.length===1){const[,{x:Bt,y:Gt},{x:Vt,y:Jt}]=u[0];if(S===Bt&&U===Gt&&a===Vt&&C===Jt)return}const{style:Z}=this.container;let mt;if(t(this,e)){const{borderColor:Bt,borderWidth:Gt}=Z;Z.borderWidth=0,mt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Bt}" stroke-width="${Gt}">`],this.container.classList.add("hasBorder")}const Pt=S-a,kt=U-C,{svgFactory:Et}=this,Ot=Et.createElement("svg");Ot.classList.add("quadrilateralsContainer"),Ot.setAttribute("width",0),Ot.setAttribute("height",0);const Tt=Et.createElement("defs");Ot.append(Tt);const xt=Et.createElement("clipPath"),Dt=`clippath_${this.data.id}`;xt.setAttribute("id",Dt),xt.setAttribute("clipPathUnits","objectBoundingBox"),Tt.append(xt);for(const[,{x:Bt,y:Gt},{x:Vt,y:Jt}]of u){const qt=Et.createElement("rect"),Qt=(Vt-a)/Pt,te=(U-Gt)/kt,Zt=(Bt-Vt)/Pt,ne=(Gt-Jt)/kt;qt.setAttribute("x",Qt),qt.setAttribute("y",te),qt.setAttribute("width",Zt),qt.setAttribute("height",ne),xt.append(qt),mt==null||mt.push(`<rect vector-effect="non-scaling-stroke" x="${Qt}" y="${te}" width="${Zt}" height="${ne}"/>`)}t(this,e)&&(mt.push("</g></svg>')"),Z.backgroundImage=mt.join("")),this.container.append(Ot),this.container.style.clipPath=`url(#${Dt})`}_createPopup(){const{container:u,data:a}=this;u.setAttribute("aria-haspopup","dialog");const C=new b({data:{color:a.color,titleObj:a.titleObj,modificationDate:a.modificationDate,contentsObj:a.contentsObj,richText:a.richText,parentRect:a.rect,borderStyle:0,id:`popup_${a.id}`,rotation:a.rotation},parent:this.parent,elements:[this]});this.parent.div.append(C.render())}render(){(0,c.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(u,a=null){const C=[];if(this._fieldObjects){const S=this._fieldObjects[u];if(S)for(const{page:U,id:Z,exportValues:mt}of S){if(U===-1||Z===a)continue;const Pt=typeof mt=="string"?mt:null,kt=document.querySelector(`[data-element-id="${Z}"]`);if(kt&&!L.has(kt)){(0,c.warn)(`_getElementsByName - element not allowed: ${Z}`);continue}C.push({id:Z,exportValue:Pt,domElement:kt})}return C}for(const S of document.getElementsByName(u)){const{exportValue:U}=S,Z=S.getAttribute("data-element-id");Z!==a&&L.has(S)&&C.push({id:Z,exportValue:U,domElement:S})}return C}show(){var u;this.container&&(this.container.hidden=!1),(u=this.popup)==null||u.maybeShow()}hide(){var u;this.container&&(this.container.hidden=!0),(u=this.popup)==null||u.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const u=this.getElementsToTriggerPopup();if(Array.isArray(u))for(const a of u)a.classList.add("highlightArea");else u.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:u,data:{id:a}}=this;this.container.addEventListener("dblclick",()=>{var C;(C=this.linkService.eventBus)==null||C.dispatch("switchannotationeditormode",{source:this,mode:u,editId:a})})}}e=new WeakMap;class A extends y{constructor(a,C=null){super(a,{isRenderable:!0,ignoreBorder:!!(C!=null&&C.ignoreBorder),createQuadrilaterals:!0});W(this,m);W(this,T);this.isTooltipOnly=a.data.isTooltipOnly}render(){const{data:a,linkService:C}=this,S=document.createElement("a");S.setAttribute("data-element-id",a.id);let U=!1;return a.url?(C.addLinkAttributes(S,a.url,a.newWindow),U=!0):a.action?(this._bindNamedAction(S,a.action),U=!0):a.attachment?(this._bindAttachment(S,a.attachment),U=!0):a.setOCGState?(Q(this,T,yi).call(this,S,a.setOCGState),U=!0):a.dest?(this._bindLink(S,a.dest),U=!0):(a.actions&&(a.actions.Action||a.actions["Mouse Up"]||a.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(S,a),U=!0),a.resetForm?(this._bindResetFormAction(S,a.resetForm),U=!0):this.isTooltipOnly&&!U&&(this._bindLink(S,""),U=!0)),this.container.classList.add("linkAnnotation"),U&&this.container.append(S),this.container}_bindLink(a,C){a.href=this.linkService.getDestinationHash(C),a.onclick=()=>(C&&this.linkService.goToDestination(C),!1),(C||C==="")&&Q(this,m,re).call(this)}_bindNamedAction(a,C){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeNamedAction(C),!1),Q(this,m,re).call(this)}_bindAttachment(a,C){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>{var S;return(S=this.downloadManager)==null||S.openOrDownloadData(this.container,C.content,C.filename),!1},Q(this,m,re).call(this)}_bindJSAction(a,C){a.href=this.linkService.getAnchorUrl("");const S=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const U of Object.keys(C.actions)){const Z=S.get(U);Z&&(a[Z]=()=>{var mt;return(mt=this.linkService.eventBus)==null||mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:C.id,name:U}}),!1})}a.onclick||(a.onclick=()=>!1),Q(this,m,re).call(this)}_bindResetFormAction(a,C){const S=a.onclick;if(S||(a.href=this.linkService.getAnchorUrl("")),Q(this,m,re).call(this),!this._fieldObjects){(0,c.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),S||(a.onclick=()=>!1);return}a.onclick=()=>{var Ot;S==null||S();const{fields:U,refs:Z,include:mt}=C,Pt=[];if(U.length!==0||Z.length!==0){const Tt=new Set(Z);for(const xt of U){const Dt=this._fieldObjects[xt]||[];for(const{id:Bt}of Dt)Tt.add(Bt)}for(const xt of Object.values(this._fieldObjects))for(const Dt of xt)Tt.has(Dt.id)===mt&&Pt.push(Dt)}else for(const Tt of Object.values(this._fieldObjects))Pt.push(...Tt);const kt=this.annotationStorage,Et=[];for(const Tt of Pt){const{id:xt}=Tt;switch(Et.push(xt),Tt.type){case"text":{const Bt=Tt.defaultValue||"";kt.setValue(xt,{value:Bt});break}case"checkbox":case"radiobutton":{const Bt=Tt.defaultValue===Tt.exportValues;kt.setValue(xt,{value:Bt});break}case"combobox":case"listbox":{const Bt=Tt.defaultValue||"";kt.setValue(xt,{value:Bt});break}default:continue}const Dt=document.querySelector(`[data-element-id="${xt}"]`);if(Dt){if(!L.has(Dt)){(0,c.warn)(`_bindResetFormAction - element not allowed: ${xt}`);continue}}else continue;Dt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ot=this.linkService.eventBus)==null||Ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Et,name:"ResetForm"}})),!1}}}m=new WeakSet,re=function(){this.container.setAttribute("data-internal-link","")},T=new WeakSet,yi=function(a,C){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeSetOCGState(C),!1),Q(this,m,re).call(this)};class f extends y{constructor(u){var C,S,U;const a=!!(u.data.popupRef||(C=u.data.titleObj)!=null&&C.str||(S=u.data.contentsObj)!=null&&S.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:a})}render(){this.container.classList.add("textAnnotation");const u=document.createElement("img");return u.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",u.alt="[{{type}} Annotation]",u.dataset.l10nId="text_annotation_type",u.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.popupRef||this._createPopup(),this.container.append(u),this.container}}class v extends y{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(u){var a;this.data.hasOwnCanvas&&(((a=u.previousSibling)==null?void 0:a.nodeName)==="CANVAS"&&(u.previousSibling.hidden=!0),u.hidden=!1)}_getKeyModifier(u){const{isWin:a,isMac:C}=c.FeatureTest.platform;return a&&u.ctrlKey||C&&u.metaKey}_setEventListener(u,a,C,S){a.includes("mouse")?u.addEventListener(a,U=>{var Z;(Z=this.linkService.eventBus)==null||Z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:C,value:S(U),shift:U.shiftKey,modifier:this._getKeyModifier(U)}})}):u.addEventListener(a,U=>{var Z;(Z=this.linkService.eventBus)==null||Z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:C,value:S(U)}})})}_setEventListeners(u,a,C){var S;for(const[U,Z]of a)(Z==="Action"||(S=this.data.actions)!=null&&S[Z])&&this._setEventListener(u,U,Z,C)}_setBackgroundColor(u){const a=this.data.backgroundColor||null;u.style.backgroundColor=a===null?"transparent":c.Util.makeHexColor(a[0],a[1],a[2])}_setTextStyle(u){const a=["left","center","right"],{fontColor:C}=this.data.defaultAppearanceData,S=this.data.defaultAppearanceData.fontSize||p,U=u.style;let Z;const mt=2,Pt=kt=>Math.round(10*kt)/10;if(this.data.multiLine){const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-mt),Et=Math.round(kt/(c.LINE_FACTOR*S))||1,Ot=kt/Et;Z=Math.min(S,Pt(Ot/c.LINE_FACTOR))}else{const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-mt);Z=Math.min(S,Pt(kt/c.LINE_FACTOR))}U.fontSize=`calc(${Z}px * var(--scale-factor))`,U.color=c.Util.makeHexColor(C[0],C[1],C[2]),this.data.textAlignment!==null&&(U.textAlign=a[this.data.textAlignment])}_setRequired(u,a){a?u.setAttribute("required",!0):u.removeAttribute("required"),u.setAttribute("aria-required",a)}}class E extends v{constructor(u){const a=u.renderForms||!u.data.hasAppearance&&!!u.data.fieldValue;super(u,{isRenderable:a})}setPropertyOnSiblings(u,a,C,S){const U=this.annotationStorage;for(const Z of this._getElementsByName(u.name,u.id))Z.domElement&&(Z.domElement[a]=C),U.setValue(Z.id,{[S]:C})}render(){var S,U;const u=this.annotationStorage,a=this.data.id;this.container.classList.add("textWidgetAnnotation");let C=null;if(this.renderForms){const Z=u.getValue(a,{value:this.data.fieldValue});let mt=Z.value||"";const Pt=u.getValue(a,{charLimit:this.data.maxLen}).charLimit;Pt&&mt.length>Pt&&(mt=mt.slice(0,Pt));let kt=Z.formattedValue||((S=this.data.textContent)==null?void 0:S.join(`
`))||null;kt&&this.data.comb&&(kt=kt.replaceAll(/\s+/g,""));const Et={userValue:mt,formattedValue:kt,lastCommittedValue:null,commitKey:1};this.data.multiLine?(C=document.createElement("textarea"),C.textContent=kt??mt,this.data.doNotScroll&&(C.style.overflowY="hidden")):(C=document.createElement("input"),C.type="text",C.setAttribute("value",kt??mt),this.data.doNotScroll&&(C.style.overflowX="hidden")),this.data.hasOwnCanvas&&(C.hidden=!0),L.add(C),C.setAttribute("data-element-id",a),C.disabled=this.data.readOnly,C.name=this.data.baseFieldName||this.data.fieldName,C.tabIndex=R,this._setRequired(C,this.data.required),Pt&&(C.maxLength=Pt),C.addEventListener("input",Tt=>{u.setValue(a,{value:Tt.target.value}),this.setPropertyOnSiblings(C,"value",Tt.target.value,"value"),Et.formattedValue=null}),C.addEventListener("resetform",Tt=>{const xt=this.data.defaultFieldValue??"";C.value=Et.userValue=xt,Et.formattedValue=null});let Ot=Tt=>{const{formattedValue:xt}=Et;xt!=null&&(Tt.target.value=xt),Tt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){C.addEventListener("focus",xt=>{const{target:Dt}=xt;Et.userValue&&(Dt.value=Et.userValue),Et.lastCommittedValue=Dt.value,Et.commitKey=1}),C.addEventListener("updatefromsandbox",xt=>{this.showElementAndHideCanvas(xt.target);const Dt={value(Bt){Et.userValue=Bt.detail.value??"",u.setValue(a,{value:Et.userValue.toString()}),Bt.target.value=Et.userValue},formattedValue(Bt){const{formattedValue:Gt}=Bt.detail;Et.formattedValue=Gt,Gt!=null&&Bt.target!==document.activeElement&&(Bt.target.value=Gt),u.setValue(a,{formattedValue:Gt})},selRange(Bt){Bt.target.setSelectionRange(...Bt.detail.selRange)},charLimit:Bt=>{var qt;const{charLimit:Gt}=Bt.detail,{target:Vt}=Bt;if(Gt===0){Vt.removeAttribute("maxLength");return}Vt.setAttribute("maxLength",Gt);let Jt=Et.userValue;!Jt||Jt.length<=Gt||(Jt=Jt.slice(0,Gt),Vt.value=Et.userValue=Jt,u.setValue(a,{value:Jt}),(qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Jt,willCommit:!0,commitKey:1,selStart:Vt.selectionStart,selEnd:Vt.selectionEnd}}))}};this._dispatchEventFromSandbox(Dt,xt)}),C.addEventListener("keydown",xt=>{var Gt;Et.commitKey=1;let Dt=-1;if(xt.key==="Escape"?Dt=0:xt.key==="Enter"&&!this.data.multiLine?Dt=2:xt.key==="Tab"&&(Et.commitKey=3),Dt===-1)return;const{value:Bt}=xt.target;Et.lastCommittedValue!==Bt&&(Et.lastCommittedValue=Bt,Et.userValue=Bt,(Gt=this.linkService.eventBus)==null||Gt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Bt,willCommit:!0,commitKey:Dt,selStart:xt.target.selectionStart,selEnd:xt.target.selectionEnd}}))});const Tt=Ot;Ot=null,C.addEventListener("blur",xt=>{var Bt;if(!xt.relatedTarget)return;const{value:Dt}=xt.target;Et.userValue=Dt,Et.lastCommittedValue!==Dt&&((Bt=this.linkService.eventBus)==null||Bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Dt,willCommit:!0,commitKey:Et.commitKey,selStart:xt.target.selectionStart,selEnd:xt.target.selectionEnd}})),Tt(xt)}),(U=this.data.actions)!=null&&U.Keystroke&&C.addEventListener("beforeinput",xt=>{var te;Et.lastCommittedValue=null;const{data:Dt,target:Bt}=xt,{value:Gt,selectionStart:Vt,selectionEnd:Jt}=Bt;let qt=Vt,Qt=Jt;switch(xt.inputType){case"deleteWordBackward":{const Zt=Gt.substring(0,Vt).match(/\w*[^\w]*$/);Zt&&(qt-=Zt[0].length);break}case"deleteWordForward":{const Zt=Gt.substring(Vt).match(/^[^\w]*\w*/);Zt&&(Qt+=Zt[0].length);break}case"deleteContentBackward":Vt===Jt&&(qt-=1);break;case"deleteContentForward":Vt===Jt&&(Qt+=1);break}xt.preventDefault(),(te=this.linkService.eventBus)==null||te.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Gt,change:Dt||"",willCommit:!1,selStart:qt,selEnd:Qt}})}),this._setEventListeners(C,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],xt=>xt.target.value)}if(Ot&&C.addEventListener("blur",Ot),this.data.comb){const xt=(this.data.rect[2]-this.data.rect[0])/Pt;C.classList.add("comb"),C.style.letterSpacing=`calc(${xt}px * var(--scale-factor) - 1ch)`}}else C=document.createElement("div"),C.textContent=this.data.fieldValue,C.style.verticalAlign="middle",C.style.display="table-cell";return this._setTextStyle(C),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class P extends v{constructor(u){super(u,{isRenderable:!!u.data.hasOwnCanvas})}}class g extends v{constructor(u){super(u,{isRenderable:u.renderForms})}render(){const u=this.annotationStorage,a=this.data,C=a.id;let S=u.getValue(C,{value:a.exportValue===a.fieldValue}).value;typeof S=="string"&&(S=S!=="Off",u.setValue(C,{value:S})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const U=document.createElement("input");return L.add(U),U.setAttribute("data-element-id",C),U.disabled=a.readOnly,this._setRequired(U,this.data.required),U.type="checkbox",U.name=a.baseFieldName||a.fieldName,S&&U.setAttribute("checked",!0),U.setAttribute("exportValue",a.exportValue),U.tabIndex=R,U.addEventListener("change",Z=>{const{name:mt,checked:Pt}=Z.target;for(const kt of this._getElementsByName(mt,C)){const Et=Pt&&kt.exportValue===a.exportValue;kt.domElement&&(kt.domElement.checked=Et),u.setValue(kt.id,{value:Et})}u.setValue(C,{value:Pt})}),U.addEventListener("resetform",Z=>{const mt=a.defaultFieldValue||"Off";Z.target.checked=mt===a.exportValue}),this.enableScripting&&this.hasJSActions&&(U.addEventListener("updatefromsandbox",Z=>{const mt={value(Pt){Pt.target.checked=Pt.detail.value!=="Off",u.setValue(C,{value:Pt.target.checked})}};this._dispatchEventFromSandbox(mt,Z)}),this._setEventListeners(U,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Z=>Z.target.checked)),this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}class n extends v{constructor(u){super(u,{isRenderable:u.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const u=this.annotationStorage,a=this.data,C=a.id;let S=u.getValue(C,{value:a.fieldValue===a.buttonValue}).value;typeof S=="string"&&(S=S!==a.buttonValue,u.setValue(C,{value:S}));const U=document.createElement("input");if(L.add(U),U.setAttribute("data-element-id",C),U.disabled=a.readOnly,this._setRequired(U,this.data.required),U.type="radio",U.name=a.baseFieldName||a.fieldName,S&&U.setAttribute("checked",!0),U.tabIndex=R,U.addEventListener("change",Z=>{const{name:mt,checked:Pt}=Z.target;for(const kt of this._getElementsByName(mt,C))u.setValue(kt.id,{value:!1});u.setValue(C,{value:Pt})}),U.addEventListener("resetform",Z=>{const mt=a.defaultFieldValue;Z.target.checked=mt!=null&&mt===a.buttonValue}),this.enableScripting&&this.hasJSActions){const Z=a.buttonValue;U.addEventListener("updatefromsandbox",mt=>{const Pt={value:kt=>{const Et=Z===kt.detail.value;for(const Ot of this._getElementsByName(kt.target.name)){const Tt=Et&&Ot.id===C;Ot.domElement&&(Ot.domElement.checked=Tt),u.setValue(Ot.id,{value:Tt})}}};this._dispatchEventFromSandbox(Pt,mt)}),this._setEventListeners(U,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],mt=>mt.target.checked)}return this._setBackgroundColor(U),this._setDefaultPropertiesFromJS(U),this.container.append(U),this.container}}class o extends A{constructor(u){super(u,{ignoreBorder:u.data.hasAppearance})}render(){const u=super.render();u.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(u.title=this.data.alternativeText);const a=u.lastChild;return this.enableScripting&&this.hasJSActions&&a&&(this._setDefaultPropertiesFromJS(a),a.addEventListener("updatefromsandbox",C=>{this._dispatchEventFromSandbox({},C)})),u}}class F extends v{constructor(u){super(u,{isRenderable:u.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const u=this.annotationStorage,a=this.data.id,C=u.getValue(a,{value:this.data.fieldValue}),S=document.createElement("select");L.add(S),S.setAttribute("data-element-id",a),S.disabled=this.data.readOnly,this._setRequired(S,this.data.required),S.name=this.data.baseFieldName||this.data.fieldName,S.tabIndex=R;let U=this.data.combo&&this.data.options.length>0;this.data.combo||(S.size=this.data.options.length,this.data.multiSelect&&(S.multiple=!0)),S.addEventListener("resetform",Et=>{const Ot=this.data.defaultFieldValue;for(const Tt of S.options)Tt.selected=Tt.value===Ot});for(const Et of this.data.options){const Ot=document.createElement("option");Ot.textContent=Et.displayValue,Ot.value=Et.exportValue,C.value.includes(Et.exportValue)&&(Ot.setAttribute("selected",!0),U=!1),S.append(Ot)}let Z=null;if(U){const Et=document.createElement("option");Et.value=" ",Et.setAttribute("hidden",!0),Et.setAttribute("selected",!0),S.prepend(Et),Z=()=>{Et.remove(),S.removeEventListener("input",Z),Z=null},S.addEventListener("input",Z)}const mt=Et=>{const Ot=Et?"value":"textContent",{options:Tt,multiple:xt}=S;return xt?Array.prototype.filter.call(Tt,Dt=>Dt.selected).map(Dt=>Dt[Ot]):Tt.selectedIndex===-1?null:Tt[Tt.selectedIndex][Ot]};let Pt=mt(!1);const kt=Et=>{const Ot=Et.target.options;return Array.prototype.map.call(Ot,Tt=>({displayValue:Tt.textContent,exportValue:Tt.value}))};return this.enableScripting&&this.hasJSActions?(S.addEventListener("updatefromsandbox",Et=>{const Ot={value(Tt){Z==null||Z();const xt=Tt.detail.value,Dt=new Set(Array.isArray(xt)?xt:[xt]);for(const Bt of S.options)Bt.selected=Dt.has(Bt.value);u.setValue(a,{value:mt(!0)}),Pt=mt(!1)},multipleSelection(Tt){S.multiple=!0},remove(Tt){const xt=S.options,Dt=Tt.detail.remove;xt[Dt].selected=!1,S.remove(Dt),xt.length>0&&Array.prototype.findIndex.call(xt,Gt=>Gt.selected)===-1&&(xt[0].selected=!0),u.setValue(a,{value:mt(!0),items:kt(Tt)}),Pt=mt(!1)},clear(Tt){for(;S.length!==0;)S.remove(0);u.setValue(a,{value:null,items:[]}),Pt=mt(!1)},insert(Tt){const{index:xt,displayValue:Dt,exportValue:Bt}=Tt.detail.insert,Gt=S.children[xt],Vt=document.createElement("option");Vt.textContent=Dt,Vt.value=Bt,Gt?Gt.before(Vt):S.append(Vt),u.setValue(a,{value:mt(!0),items:kt(Tt)}),Pt=mt(!1)},items(Tt){const{items:xt}=Tt.detail;for(;S.length!==0;)S.remove(0);for(const Dt of xt){const{displayValue:Bt,exportValue:Gt}=Dt,Vt=document.createElement("option");Vt.textContent=Bt,Vt.value=Gt,S.append(Vt)}S.options.length>0&&(S.options[0].selected=!0),u.setValue(a,{value:mt(!0),items:kt(Tt)}),Pt=mt(!1)},indices(Tt){const xt=new Set(Tt.detail.indices);for(const Dt of Tt.target.options)Dt.selected=xt.has(Dt.index);u.setValue(a,{value:mt(!0)}),Pt=mt(!1)},editable(Tt){Tt.target.disabled=!Tt.detail.editable}};this._dispatchEventFromSandbox(Ot,Et)}),S.addEventListener("input",Et=>{var Tt;const Ot=mt(!0);u.setValue(a,{value:Ot}),Et.preventDefault(),(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Pt,changeEx:Ot,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(S,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Et=>Et.target.value)):S.addEventListener("input",function(Et){u.setValue(a,{value:mt(!0)})}),this.data.combo&&this._setTextStyle(S),this._setBackgroundColor(S),this._setDefaultPropertiesFromJS(S),this.container.append(S),this.container}}class b extends y{constructor(u){var U,Z,mt;const{data:a,elements:C}=u,S=!!((U=a.titleObj)!=null&&U.str||(Z=a.contentsObj)!=null&&Z.str||(mt=a.richText)!=null&&mt.str);super(u,{isRenderable:S}),this.elements=C}render(){this.container.classList.add("popupAnnotation");const u=new s({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),a=[];for(const C of this.elements)C.popup=u,a.push(C.data.id),C.addHighlightArea();return this.container.setAttribute("aria-controls",a.join(",")),this.container}}class s{constructor({container:u,color:a,elements:C,titleObj:S,modificationDate:U,contentsObj:Z,richText:mt,parent:Pt,rect:kt,parentRect:Et,open:Ot}){W(this,yt);W(this,Mt);W(this,It);W(this,z,null);W(this,Y,Q(this,It,Xe).bind(this));W(this,dt,Q(this,Mt,Ge).bind(this));W(this,at,Q(this,yt,ze).bind(this));W(this,ht,null);W(this,ft,null);W(this,Ct,null);W(this,At,null);W(this,Rt,null);W(this,Ht,null);W(this,St,!1);W(this,Nt,null);W(this,vt,null);W(this,st,null);W(this,tt,null);W(this,gt,!1);rt(this,ft,u),rt(this,tt,S),rt(this,Ct,Z),rt(this,st,mt),rt(this,Rt,Pt),rt(this,ht,a),rt(this,vt,kt),rt(this,Ht,Et),rt(this,At,C);const Tt=x.PDFDateString.toDateObject(U);Tt&&rt(this,z,Pt.l10n.get("annotation_date_string",{date:Tt.toLocaleDateString(),time:Tt.toLocaleTimeString()})),this.trigger=C.flatMap(xt=>xt.getElementsToTriggerPopup());for(const xt of this.trigger)xt.addEventListener("click",t(this,at)),xt.addEventListener("mouseenter",t(this,dt)),xt.addEventListener("mouseleave",t(this,Y));t(this,ft).hidden=!0,Ot&&Q(this,yt,ze).call(this)}render(){if(t(this,Nt))return;const{page:{view:u},viewport:{rawDims:{pageWidth:a,pageHeight:C,pageX:S,pageY:U}}}=t(this,Rt),Z=rt(this,Nt,document.createElement("div"));if(Z.className="popup",t(this,ht)){const qt=Z.style.outlineColor=c.Util.makeHexColor(...t(this,ht));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Z.style.backgroundColor=`color-mix(in srgb, ${qt} 30%, white)`:Z.style.backgroundColor=c.Util.makeHexColor(...t(this,ht).map(te=>Math.floor(.7*(255-te)+te)))}const mt=document.createElement("span");mt.className="header";const Pt=document.createElement("h1");if(mt.append(Pt),{dir:Pt.dir,str:Pt.textContent}=t(this,tt),Z.append(mt),t(this,z)){const qt=document.createElement("span");qt.classList.add("popupDate"),t(this,z).then(Qt=>{qt.textContent=Qt}),mt.append(qt)}const kt=t(this,Ct),Et=t(this,st);if(Et!=null&&Et.str&&(!(kt!=null&&kt.str)||kt.str===Et.str))j.XfaLayer.render({xfaHtml:Et.html,intent:"richText",div:Z}),Z.lastChild.classList.add("richText","popupContent");else{const qt=this._formatContents(kt);Z.append(qt)}let Ot=!!t(this,Ht),Tt=Ot?t(this,Ht):t(this,vt);for(const qt of t(this,At))if(!Tt||c.Util.intersect(qt.data.rect,Tt)!==null){Tt=qt.data.rect,Ot=!0;break}const xt=c.Util.normalizeRect([Tt[0],u[3]-Tt[1]+u[1],Tt[2],u[3]-Tt[3]+u[1]]),Dt=5,Bt=Ot?Tt[2]-Tt[0]+Dt:0,Gt=xt[0]+Bt,Vt=xt[1],{style:Jt}=t(this,ft);Jt.left=`${100*(Gt-S)/a}%`,Jt.top=`${100*(Vt-U)/C}%`,t(this,ft).append(Z)}_formatContents({str:u,dir:a}){const C=document.createElement("p");C.classList.add("popupContent"),C.dir=a;const S=u.split(/(?:\r\n?|\n)/);for(let U=0,Z=S.length;U<Z;++U){const mt=S[U];C.append(document.createTextNode(mt)),U<Z-1&&C.append(document.createElement("br"))}return C}forceHide(){rt(this,gt,this.isVisible),t(this,gt)&&(t(this,ft).hidden=!0)}maybeShow(){t(this,gt)&&(rt(this,gt,!1),t(this,ft).hidden=!1)}get isVisible(){return t(this,ft).hidden===!1}}z=new WeakMap,Y=new WeakMap,dt=new WeakMap,at=new WeakMap,ht=new WeakMap,ft=new WeakMap,Ct=new WeakMap,At=new WeakMap,Rt=new WeakMap,Ht=new WeakMap,St=new WeakMap,Nt=new WeakMap,vt=new WeakMap,st=new WeakMap,tt=new WeakMap,gt=new WeakMap,yt=new WeakSet,ze=function(){rt(this,St,!t(this,St)),t(this,St)?(Q(this,Mt,Ge).call(this),t(this,ft).addEventListener("click",t(this,at))):(Q(this,It,Xe).call(this),t(this,ft).removeEventListener("click",t(this,at)))},Mt=new WeakSet,Ge=function(){t(this,Nt)||this.render(),this.isVisible?t(this,St)&&t(this,ft).classList.add("focused"):(t(this,ft).hidden=!1,t(this,ft).style.zIndex=parseInt(t(this,ft).style.zIndex)+1e3)},It=new WeakSet,Xe=function(){t(this,ft).classList.remove("focused"),!(t(this,St)||!this.isVisible)&&(t(this,ft).hidden=!0,t(this,ft).style.zIndex=parseInt(t(this,ft).style.zIndex)-1e3)};class l extends y{constructor(u){var C,S,U;const a=!!(u.data.popupRef||(C=u.data.titleObj)!=null&&C.str||(S=u.data.contentsObj)!=null&&S.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:a,ignoreBorder:!0}),this.textContent=u.data.textContent,this.textPosition=u.data.textPosition,this.annotationEditorType=c.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const u=document.createElement("div");u.classList.add("annotationTextContent"),u.setAttribute("role","comment");for(const a of this.textContent){const C=document.createElement("span");C.textContent=a,u.append(C)}this.container.append(u)}return this.data.popupRef||this._createPopup(),this._editOnDoubleClick(),this.container}}d.FreeTextAnnotationElement=l;class r extends y{constructor(a){var S,U,Z;const C=!!(a.data.popupRef||(S=a.data.titleObj)!=null&&S.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:C,ignoreBorder:!0});W(this,Wt,null)}render(){this.container.classList.add("lineAnnotation");const a=this.data,{width:C,height:S}=B(a.rect),U=this.svgFactory.create(C,S,!0),Z=rt(this,Wt,this.svgFactory.createElement("svg:line"));return Z.setAttribute("x1",a.rect[2]-a.lineCoordinates[0]),Z.setAttribute("y1",a.rect[3]-a.lineCoordinates[1]),Z.setAttribute("x2",a.rect[2]-a.lineCoordinates[2]),Z.setAttribute("y2",a.rect[3]-a.lineCoordinates[3]),Z.setAttribute("stroke-width",a.borderStyle.width||1),Z.setAttribute("stroke","transparent"),Z.setAttribute("fill","transparent"),U.append(Z),this.container.append(U),a.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Wt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wt=new WeakMap;class I extends y{constructor(a){var S,U,Z;const C=!!(a.data.popupRef||(S=a.data.titleObj)!=null&&S.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:C,ignoreBorder:!0});W(this,Ut,null)}render(){this.container.classList.add("squareAnnotation");const a=this.data,{width:C,height:S}=B(a.rect),U=this.svgFactory.create(C,S,!0),Z=a.borderStyle.width,mt=rt(this,Ut,this.svgFactory.createElement("svg:rect"));return mt.setAttribute("x",Z/2),mt.setAttribute("y",Z/2),mt.setAttribute("width",C-Z),mt.setAttribute("height",S-Z),mt.setAttribute("stroke-width",Z||1),mt.setAttribute("stroke","transparent"),mt.setAttribute("fill","transparent"),U.append(mt),this.container.append(U),a.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Ut)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ut=new WeakMap;class O extends y{constructor(a){var S,U,Z;const C=!!(a.data.popupRef||(S=a.data.titleObj)!=null&&S.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:C,ignoreBorder:!0});W(this,ct,null)}render(){this.container.classList.add("circleAnnotation");const a=this.data,{width:C,height:S}=B(a.rect),U=this.svgFactory.create(C,S,!0),Z=a.borderStyle.width,mt=rt(this,ct,this.svgFactory.createElement("svg:ellipse"));return mt.setAttribute("cx",C/2),mt.setAttribute("cy",S/2),mt.setAttribute("rx",C/2-Z/2),mt.setAttribute("ry",S/2-Z/2),mt.setAttribute("stroke-width",Z||1),mt.setAttribute("stroke","transparent"),mt.setAttribute("fill","transparent"),U.append(mt),this.container.append(U),a.popupRef||this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,ct)}addHighlightArea(){this.container.classList.add("highlightArea")}}ct=new WeakMap;class V extends y{constructor(a){var S,U,Z;const C=!!(a.data.popupRef||(S=a.data.titleObj)!=null&&S.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:C,ignoreBorder:!0});W(this,q,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:C,height:S}=B(a.rect),U=this.svgFactory.create(C,S,!0);let Z=[];for(const Pt of a.vertices){const kt=Pt.x-a.rect[0],Et=a.rect[3]-Pt.y;Z.push(kt+","+Et)}Z=Z.join(" ");const mt=rt(this,q,this.svgFactory.createElement(this.svgElementName));return mt.setAttribute("points",Z),mt.setAttribute("stroke-width",a.borderStyle.width||1),mt.setAttribute("stroke","transparent"),mt.setAttribute("fill","transparent"),U.append(mt),this.container.append(U),a.popupRef||this._createPopup(mt,a),this.container}getElementsToTriggerPopup(){return t(this,q)}addHighlightArea(){this.container.classList.add("highlightArea")}}q=new WeakMap;class _ extends V{constructor(u){super(u),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class G extends y{constructor(u){var C,S,U;const a=!!(u.data.popupRef||(C=u.data.titleObj)!=null&&C.str||(S=u.data.contentsObj)!=null&&S.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.popupRef||this._createPopup(),this.container}}class M extends y{constructor(a){var S,U,Z;const C=!!(a.data.popupRef||(S=a.data.titleObj)!=null&&S.str||(U=a.data.contentsObj)!=null&&U.str||(Z=a.data.richText)!=null&&Z.str);super(a,{isRenderable:C,ignoreBorder:!0});W(this,K,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=c.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:C,height:S}=B(a.rect),U=this.svgFactory.create(C,S,!0);for(const Z of a.inkLists){let mt=[];for(const kt of Z){const Et=kt.x-a.rect[0],Ot=a.rect[3]-kt.y;mt.push(`${Et},${Ot}`)}mt=mt.join(" ");const Pt=this.svgFactory.createElement(this.svgElementName);t(this,K).push(Pt),Pt.setAttribute("points",mt),Pt.setAttribute("stroke-width",a.borderStyle.width||1),Pt.setAttribute("stroke","transparent"),Pt.setAttribute("fill","transparent"),a.popupRef||this._createPopup(Pt,a),U.append(Pt)}return this.container.append(U),this.container}getElementsToTriggerPopup(){return t(this,K)}addHighlightArea(){this.container.classList.add("highlightArea")}}K=new WeakMap,d.InkAnnotationElement=M;class k extends y{constructor(u){var C,S,U;const a=!!(u.data.popupRef||(C=u.data.titleObj)!=null&&C.str||(S=u.data.contentsObj)!=null&&S.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class $ extends y{constructor(u){var C,S,U;const a=!!(u.data.popupRef||(C=u.data.titleObj)!=null&&C.str||(S=u.data.contentsObj)!=null&&S.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class it extends y{constructor(u){var C,S,U;const a=!!(u.data.popupRef||(C=u.data.titleObj)!=null&&C.str||(S=u.data.contentsObj)!=null&&S.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class pt extends y{constructor(u){var C,S,U;const a=!!(u.data.popupRef||(C=u.data.titleObj)!=null&&C.str||(S=u.data.contentsObj)!=null&&S.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:a,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.popupRef||this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class _t extends y{constructor(u){var C,S,U;const a=!!(u.data.popupRef||(C=u.data.titleObj)!=null&&C.str||(S=u.data.contentsObj)!=null&&S.str||(U=u.data.richText)!=null&&U.str);super(u,{isRenderable:a,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.popupRef||this._createPopup(),this.container}}d.StampAnnotationElement=_t;class D extends y{constructor(a){var U;super(a,{isRenderable:!0});W(this,wt,null);const{filename:C,content:S}=this.data.file;this.filename=(0,x.getFilenameFromUrl)(C,!0),this.content=S,(U=this.linkService.eventBus)==null||U.dispatch("fileattachmentannotation",{source:this,filename:C,content:S})}render(){var C,S;this.container.classList.add("fileAttachmentAnnotation");let a;return this.data.hasAppearance?a=document.createElement("div"):(a=document.createElement("img"),a.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),a.classList.add("popupTriggerArea"),a.addEventListener("dblclick",this._download.bind(this)),rt(this,wt,a),!this.data.popupRef&&((C=this.data.titleObj)!=null&&C.str||(S=this.data.contentsObj)!=null&&S.str||this.data.richText)&&this._createPopup(),this.container.append(a),this.container}getElementsToTriggerPopup(){return t(this,wt)}addHighlightArea(){this.container.classList.add("highlightArea")}_download(){var a;(a=this.downloadManager)==null||a.openOrDownloadData(this.container,this.content,this.filename)}}wt=new WeakMap;class i{constructor({div:u,accessibilityManager:a,annotationCanvasMap:C,l10n:S,page:U,viewport:Z}){W(this,Kt);W(this,X);W(this,jt,null);W(this,Lt,null);W(this,$t,new Map);this.div=u,rt(this,jt,a),rt(this,Lt,C),this.l10n=S,this.page=U,this.viewport=Z,this.zIndex=0,this.l10n||(this.l10n=lt.NullL10n)}async render(u){const{annotations:a}=u,C=this.div;(0,x.setLayerDimensions)(C,this.viewport);const S=new Map,U={data:null,layer:C,linkService:u.linkService,downloadManager:u.downloadManager,imageResourcesPath:u.imageResourcesPath||"",renderForms:u.renderForms!==!1,svgFactory:new x.DOMSVGFactory,annotationStorage:u.annotationStorage||new et.AnnotationStorage,enableScripting:u.enableScripting===!0,hasJSActions:u.hasJSActions,fieldObjects:u.fieldObjects,parent:this,elements:null};for(const Z of a){if(Z.noHTML)continue;const mt=Z.annotationType===c.AnnotationType.POPUP;if(mt){const Et=S.get(Z.id);if(!Et)continue;U.elements=Et}else{const{width:Et,height:Ot}=B(Z.rect);if(Et<=0||Ot<=0)continue}U.data=Z;const Pt=w.create(U);if(!Pt.isRenderable)continue;if(!mt&&Z.popupRef){const Et=S.get(Z.popupRef);Et?Et.push(Pt):S.set(Z.popupRef,[Pt])}Pt.annotationEditorType>0&&t(this,$t).set(Pt.data.id,Pt);const kt=Pt.render();Z.hidden&&(kt.style.visibility="hidden"),Q(this,Kt,vi).call(this,kt,Z.id)}Q(this,X,Ve).call(this),await this.l10n.translate(C)}update({viewport:u}){const a=this.div;this.viewport=u,(0,x.setLayerDimensions)(a,{rotation:u.rotation}),Q(this,X,Ve).call(this),a.hidden=!1}getEditableAnnotations(){return Array.from(t(this,$t).values())}getEditableAnnotation(u){return t(this,$t).get(u)}}jt=new WeakMap,Lt=new WeakMap,$t=new WeakMap,Kt=new WeakSet,vi=function(u,a){var S;const C=u.firstChild||u;C.id=`${x.AnnotationPrefix}${a}`,this.div.append(u),(S=t(this,jt))==null||S.moveElementInDOM(this.div,u,C,!1)},X=new WeakSet,Ve=function(){if(!t(this,Lt))return;const u=this.div;for(const[a,C]of t(this,Lt)){const S=u.querySelector(`[data-annotation-id="${a}"]`);if(!S)continue;const{firstChild:U}=S;U?U.nodeName==="CANVAS"?U.replaceWith(C):U.before(C):S.append(C)}t(this,Lt).clear()},d.AnnotationLayer=i},(bt,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.ColorConverters=void 0;function nt(x){return Math.floor(Math.max(0,Math.min(1,x))*255).toString(16).padStart(2,"0")}class c{static CMYK_G([et,J,lt,j]){return["G",1-Math.min(1,.3*et+.59*lt+.11*J+j)]}static G_CMYK([et]){return["CMYK",0,0,0,1-et]}static G_RGB([et]){return["RGB",et,et,et]}static G_HTML([et]){const J=nt(et);return`#${J}${J}${J}`}static RGB_G([et,J,lt]){return["G",.3*et+.59*J+.11*lt]}static RGB_HTML([et,J,lt]){const j=nt(et),R=nt(J),p=nt(lt);return`#${j}${R}${p}`}static T_HTML(){return"#00000000"}static CMYK_RGB([et,J,lt,j]){return["RGB",1-Math.min(1,et+j),1-Math.min(1,lt+j),1-Math.min(1,J+j)]}static CMYK_HTML(et){const J=this.CMYK_RGB(et).slice(1);return this.RGB_HTML(J)}static RGB_CMYK([et,J,lt]){const j=1-et,R=1-J,p=1-lt,L=Math.min(j,R,p);return["CMYK",j,R,p,L]}}d.ColorConverters=c},(bt,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NullL10n=void 0,d.getL10nFallback=c;const nt={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};nt.print_progress_percent="{{progress}}%";function c(J,lt){switch(J){case"find_match_count":J=`find_match_count[${lt.total===1?"one":"other"}]`;break;case"find_match_count_limit":J=`find_match_count_limit[${lt.limit===1?"one":"other"}]`;break}return nt[J]||""}function x(J,lt){return lt?J.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(j,R)=>R in lt?lt[R]:"{{"+R+"}}"):J}const et={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(J,lt=null,j=c(J,lt)){return x(j,lt)},async translate(J){}};d.NullL10n=et},(bt,d,nt)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.XfaLayer=void 0;var c=nt(25);class x{static setupStorage(J,lt,j,R,p){const L=R.getValue(lt,{value:null});switch(j.name){case"textarea":if(L.value!==null&&(J.textContent=L.value),p==="print")break;J.addEventListener("input",B=>{R.setValue(lt,{value:B.target.value})});break;case"input":if(j.attributes.type==="radio"||j.attributes.type==="checkbox"){if(L.value===j.attributes.xfaOn?J.setAttribute("checked",!0):L.value===j.attributes.xfaOff&&J.removeAttribute("checked"),p==="print")break;J.addEventListener("change",B=>{R.setValue(lt,{value:B.target.checked?B.target.getAttribute("xfaOn"):B.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&J.setAttribute("value",L.value),p==="print")break;J.addEventListener("input",B=>{R.setValue(lt,{value:B.target.value})})}break;case"select":if(L.value!==null){J.setAttribute("value",L.value);for(const B of j.children)B.attributes.value===L.value?B.attributes.selected=!0:B.attributes.hasOwnProperty("selected")&&delete B.attributes.selected}J.addEventListener("input",B=>{const w=B.target.options,y=w.selectedIndex===-1?"":w[w.selectedIndex].value;R.setValue(lt,{value:y})});break}}static setAttributes({html:J,element:lt,storage:j=null,intent:R,linkService:p}){const{attributes:L}=lt,B=J instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${R}`);for(const[w,y]of Object.entries(L))if(y!=null)switch(w){case"class":y.length&&J.setAttribute(w,y.join(" "));break;case"dataId":break;case"id":J.setAttribute("data-element-id",y);break;case"style":Object.assign(J.style,y);break;case"textContent":J.textContent=y;break;default:(!B||w!=="href"&&w!=="newWindow")&&J.setAttribute(w,y)}B&&p.addLinkAttributes(J,L.href,L.newWindow),j&&L.dataId&&this.setupStorage(J,L.dataId,lt,j)}static render(J){var A;const lt=J.annotationStorage,j=J.linkService,R=J.xfaHtml,p=J.intent||"display",L=document.createElement(R.name);R.attributes&&this.setAttributes({html:L,element:R,intent:p,linkService:j});const B=[[R,-1,L]],w=J.div;if(w.append(L),J.viewport){const f=`matrix(${J.viewport.transform.join(",")})`;w.style.transform=f}p!=="richText"&&w.setAttribute("class","xfaLayer xfaFont");const y=[];for(;B.length>0;){const[f,v,E]=B.at(-1);if(v+1===f.children.length){B.pop();continue}const P=f.children[++B.at(-1)[1]];if(P===null)continue;const{name:g}=P;if(g==="#text"){const o=document.createTextNode(P.value);y.push(o),E.append(o);continue}const n=(A=P==null?void 0:P.attributes)!=null&&A.xmlns?document.createElementNS(P.attributes.xmlns,g):document.createElement(g);if(E.append(n),P.attributes&&this.setAttributes({html:n,element:P,storage:lt,intent:p,linkService:j}),P.children&&P.children.length>0)B.push([P,-1,n]);else if(P.value){const o=document.createTextNode(P.value);c.XfaText.shouldBuildText(g)&&y.push(o),n.append(o)}}for(const f of w.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:y}}static update(J){const lt=`matrix(${J.viewport.transform.join(",")})`;J.div.style.transform=lt,J.div.hidden=!1}}d.XfaLayer=x},(bt,d,nt)=>{var j,R,p,L,B,w,y,A,f,v,E,P,g,n,o,F,Si,s,Ei,r,Ci,O,wi,_,$e,M,Ti,$,qe,pt,xi,D,Pi,e,ki,N,Fi,H,Ri,Y,se,at,Ye,ft,ve,At,Se,Ht,ce,Nt,Ke,st,Ee,gt,Mi,Ft,Je,zt,Di,Xt,Ii,Ut,Qe,q,Ce,wt,he;Object.defineProperty(d,"__esModule",{value:!0}),d.InkEditor=void 0;var c=nt(1),x=nt(4),et=nt(29),J=nt(5);const Lt=class extends x.AnnotationEditor{constructor(h){super({...h,name:"inkEditor"});W(this,F);W(this,s);W(this,r);W(this,O);W(this,_);W(this,M);W(this,$);W(this,pt);W(this,D);W(this,e);W(this,N);W(this,H);W(this,Y);W(this,at);W(this,ft);W(this,At);W(this,Ht);W(this,Nt);W(this,st);W(this,Xt);W(this,Ut);W(this,q);W(this,wt);W(this,j,0);W(this,R,0);W(this,p,this.canvasContextMenu.bind(this));W(this,L,this.canvasPointermove.bind(this));W(this,B,this.canvasPointerleave.bind(this));W(this,w,this.canvasPointerup.bind(this));W(this,y,this.canvasPointerdown.bind(this));W(this,A,new Path2D);W(this,f,!1);W(this,v,!1);W(this,E,!1);W(this,P,null);W(this,g,0);W(this,n,0);W(this,o,null);this.color=h.color||null,this.thickness=h.thickness||null,this.opacity=h.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(h){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(X=>[X,h.get(X)]))}static updateDefaultParams(h,X){switch(h){case c.AnnotationEditorParamsType.INK_THICKNESS:Lt._defaultThickness=X;break;case c.AnnotationEditorParamsType.INK_COLOR:Lt._defaultColor=X;break;case c.AnnotationEditorParamsType.INK_OPACITY:Lt._defaultOpacity=X/100;break}}updateParams(h,X){switch(h){case c.AnnotationEditorParamsType.INK_THICKNESS:Q(this,F,Si).call(this,X);break;case c.AnnotationEditorParamsType.INK_COLOR:Q(this,s,Ei).call(this,X);break;case c.AnnotationEditorParamsType.INK_OPACITY:Q(this,r,Ci).call(this,X);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.INK_THICKNESS,Lt._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,Lt._defaultColor||x.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(Lt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Lt._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,this.color||Lt._defaultColor||x.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Lt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(Q(this,ft,ve).call(this),Q(this,At,Se).call(this)),this.isAttachedToDOM||(this.parent.add(this),Q(this,Ht,ce).call(this)),Q(this,wt,he).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,P).disconnect(),rt(this,P,null),super.remove())}setParent(h){!this.parent&&h?this._uiManager.removeShouldRescale(this):this.parent&&h===null&&this._uiManager.addShouldRescale(this),super.setParent(h)}onScaleChanging(){const[h,X]=this.parentDimensions,ut=this.width*h,ot=this.height*X;this.setDimensions(ut,ot)}enableEditMode(){t(this,f)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",t(this,y)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,y)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,f)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),rt(this,f,!0),this.div.classList.add("disabled"),Q(this,wt,he).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(h){super.focusin(h),this.enableEditMode()}canvasPointerdown(h){h.button!==0||!this.isInEditMode()||t(this,f)||(this.setInForeground(),h.preventDefault(),h.type!=="mouse"&&this.div.focus(),Q(this,M,Ti).call(this,h.offsetX,h.offsetY))}canvasContextMenu(h){h.preventDefault()}canvasPointermove(h){h.preventDefault(),Q(this,$,qe).call(this,h.offsetX,h.offsetY)}canvasPointerup(h){h.preventDefault(),Q(this,at,Ye).call(this,h)}canvasPointerleave(h){Q(this,at,Ye).call(this,h)}get isResizable(){return!this.isEmpty()&&t(this,f)}render(){if(this.div)return this.div;let h,X;this.width&&(h=this.x,X=this.y),super.render(),Lt._l10nPromise.get("editor_ink2_aria_label").then(C=>{var S;return(S=this.div)==null?void 0:S.setAttribute("aria-label",C)});const[ut,ot,u,a]=Q(this,O,wi).call(this);if(this.setAt(ut,ot,0,0),this.setDims(u,a),Q(this,ft,ve).call(this),this.width){const[C,S]=this.parentDimensions;this.setAspectRatio(this.width*C,this.height*S),this.setAt(h*C,X*S,this.width*C,this.height*S),rt(this,E,!0),Q(this,Ht,ce).call(this),this.setDims(this.width*C,this.height*S),Q(this,Y,se).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Q(this,At,Se).call(this),this.div}setDimensions(h,X){const ut=Math.round(h),ot=Math.round(X);if(t(this,g)===ut&&t(this,n)===ot)return;rt(this,g,ut),rt(this,n,ot),this.canvas.style.visibility="hidden";const[u,a]=this.parentDimensions;this.width=h/u,this.height=X/a,this.fixAndSetPosition(),t(this,f)&&Q(this,Nt,Ke).call(this,h,X),Q(this,Ht,ce).call(this),Q(this,Y,se).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(h,X,ut){var Ot,Tt,xt;if(h instanceof et.InkAnnotationElement)return null;const ot=super.deserialize(h,X,ut);ot.thickness=h.thickness,ot.color=c.Util.makeHexColor(...h.color),ot.opacity=h.opacity;const[u,a]=ot.pageDimensions,C=ot.width*u,S=ot.height*a,U=ot.parentScale,Z=h.thickness/2;rt(ot,f,!0),rt(ot,g,Math.round(C)),rt(ot,n,Math.round(S));const{paths:mt,rect:Pt,rotation:kt}=h;for(let{bezier:Dt}of mt){Dt=Q(Ot=Lt,zt,Di).call(Ot,Dt,Pt,kt);const Bt=[];ot.paths.push(Bt);let Gt=U*(Dt[0]-Z),Vt=U*(Dt[1]-Z);for(let qt=2,Qt=Dt.length;qt<Qt;qt+=6){const te=U*(Dt[qt]-Z),Zt=U*(Dt[qt+1]-Z),ne=U*(Dt[qt+2]-Z),Bi=U*(Dt[qt+3]-Z),ei=U*(Dt[qt+4]-Z),ii=U*(Dt[qt+5]-Z);Bt.push([[Gt,Vt],[te,Zt],[ne,Bi],[ei,ii]]),Gt=ei,Vt=ii}const Jt=Q(this,gt,Mi).call(this,Bt);ot.bezierPath2D.push(Jt)}const Et=Q(Tt=ot,Ut,Qe).call(Tt);return rt(ot,R,Math.max(x.AnnotationEditor.MIN_SIZE,Et[2]-Et[0])),rt(ot,j,Math.max(x.AnnotationEditor.MIN_SIZE,Et[3]-Et[1])),Q(xt=ot,Nt,Ke).call(xt,C,S),ot}serialize(){if(this.isEmpty())return null;const h=this.getRect(0,0),X=x.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:c.AnnotationEditorType.INK,color:X,thickness:this.thickness,opacity:this.opacity,paths:Q(this,Xt,Ii).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,h),pageIndex:this.pageIndex,rect:h,rotation:this.rotation}}};let lt=Lt;j=new WeakMap,R=new WeakMap,p=new WeakMap,L=new WeakMap,B=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakMap,f=new WeakMap,v=new WeakMap,E=new WeakMap,P=new WeakMap,g=new WeakMap,n=new WeakMap,o=new WeakMap,F=new WeakSet,Si=function(h){const X=this.thickness;this.addCommands({cmd:()=>{this.thickness=h,Q(this,wt,he).call(this)},undo:()=>{this.thickness=X,Q(this,wt,he).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},s=new WeakSet,Ei=function(h){const X=this.color;this.addCommands({cmd:()=>{this.color=h,Q(this,Y,se).call(this)},undo:()=>{this.color=X,Q(this,Y,se).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},r=new WeakSet,Ci=function(h){h/=100;const X=this.opacity;this.addCommands({cmd:()=>{this.opacity=h,Q(this,Y,se).call(this)},undo:()=>{this.opacity=X,Q(this,Y,se).call(this)},mustExec:!0,type:c.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},O=new WeakSet,wi=function(){const{parentRotation:h,parentDimensions:[X,ut]}=this;switch(h){case 90:return[0,ut,ut,X];case 180:return[X,ut,X,ut];case 270:return[X,0,ut,X];default:return[0,0,X,ut]}},_=new WeakSet,$e=function(){const{ctx:h,color:X,opacity:ut,thickness:ot,parentScale:u,scaleFactor:a}=this;h.lineWidth=ot*u/a,h.lineCap="round",h.lineJoin="round",h.miterLimit=10,h.strokeStyle=`${X}${(0,J.opacityToHex)(ut)}`},M=new WeakSet,Ti=function(h,X){this.canvas.addEventListener("contextmenu",t(this,p)),this.canvas.addEventListener("pointerleave",t(this,B)),this.canvas.addEventListener("pointermove",t(this,L)),this.canvas.addEventListener("pointerup",t(this,w)),this.canvas.removeEventListener("pointerdown",t(this,y)),this.isEditing=!0,t(this,E)||(rt(this,E,!0),Q(this,Ht,ce).call(this),this.thickness||(this.thickness=Lt._defaultThickness),this.color||(this.color=Lt._defaultColor||x.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Lt._defaultOpacity)),this.currentPath.push([h,X]),rt(this,v,!1),Q(this,_,$e).call(this),rt(this,o,()=>{Q(this,e,ki).call(this),t(this,o)&&window.requestAnimationFrame(t(this,o))}),window.requestAnimationFrame(t(this,o))},$=new WeakSet,qe=function(h,X){const[ut,ot]=this.currentPath.at(-1);if(this.currentPath.length>1&&h===ut&&X===ot)return;const u=this.currentPath;let a=t(this,A);if(u.push([h,X]),rt(this,v,!0),u.length<=2){a.moveTo(...u[0]),a.lineTo(h,X);return}u.length===3&&(rt(this,A,a=new Path2D),a.moveTo(...u[0])),Q(this,N,Fi).call(this,a,...u.at(-3),...u.at(-2),h,X)},pt=new WeakSet,xi=function(){if(this.currentPath.length===0)return;const h=this.currentPath.at(-1);t(this,A).lineTo(...h)},D=new WeakSet,Pi=function(h,X){rt(this,o,null),h=Math.min(Math.max(h,0),this.canvas.width),X=Math.min(Math.max(X,0),this.canvas.height),Q(this,$,qe).call(this,h,X),Q(this,pt,xi).call(this);let ut;if(this.currentPath.length!==1)ut=Q(this,H,Ri).call(this);else{const S=[h,X];ut=[[S,S.slice(),S.slice(),S]]}const ot=t(this,A),u=this.currentPath;this.currentPath=[],rt(this,A,new Path2D);const a=()=>{this.allRawPaths.push(u),this.paths.push(ut),this.bezierPath2D.push(ot),this.rebuild()},C=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Q(this,ft,ve).call(this),Q(this,At,Se).call(this)),Q(this,wt,he).call(this))};this.addCommands({cmd:a,undo:C,mustExec:!0})},e=new WeakSet,ki=function(){if(!t(this,v))return;rt(this,v,!1);const h=Math.ceil(this.thickness*this.parentScale),X=this.currentPath.slice(-3),ut=X.map(a=>a[0]),ot=X.map(a=>a[1]);Math.min(...ut)-h,Math.max(...ut)+h,Math.min(...ot)-h,Math.max(...ot)+h;const{ctx:u}=this;u.save(),u.clearRect(0,0,this.canvas.width,this.canvas.height);for(const a of this.bezierPath2D)u.stroke(a);u.stroke(t(this,A)),u.restore()},N=new WeakSet,Fi=function(h,X,ut,ot,u,a,C){const S=(X+ot)/2,U=(ut+u)/2,Z=(ot+a)/2,mt=(u+C)/2;h.bezierCurveTo(S+2*(ot-S)/3,U+2*(u-U)/3,Z+2*(ot-Z)/3,mt+2*(u-mt)/3,Z,mt)},H=new WeakSet,Ri=function(){const h=this.currentPath;if(h.length<=2)return[[h[0],h[0],h.at(-1),h.at(-1)]];const X=[];let ut,[ot,u]=h[0];for(ut=1;ut<h.length-2;ut++){const[Pt,kt]=h[ut],[Et,Ot]=h[ut+1],Tt=(Pt+Et)/2,xt=(kt+Ot)/2,Dt=[ot+2*(Pt-ot)/3,u+2*(kt-u)/3],Bt=[Tt+2*(Pt-Tt)/3,xt+2*(kt-xt)/3];X.push([[ot,u],Dt,Bt,[Tt,xt]]),[ot,u]=[Tt,xt]}const[a,C]=h[ut],[S,U]=h[ut+1],Z=[ot+2*(a-ot)/3,u+2*(C-u)/3],mt=[S+2*(a-S)/3,U+2*(C-U)/3];return X.push([[ot,u],Z,mt,[S,U]]),X},Y=new WeakSet,se=function(){if(this.isEmpty()){Q(this,st,Ee).call(this);return}Q(this,_,$e).call(this);const{canvas:h,ctx:X}=this;X.setTransform(1,0,0,1,0,0),X.clearRect(0,0,h.width,h.height),Q(this,st,Ee).call(this);for(const ut of this.bezierPath2D)X.stroke(ut)},at=new WeakSet,Ye=function(h){this.canvas.removeEventListener("pointerleave",t(this,B)),this.canvas.removeEventListener("pointermove",t(this,L)),this.canvas.removeEventListener("pointerup",t(this,w)),this.canvas.addEventListener("pointerdown",t(this,y)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",t(this,p))},10),Q(this,D,Pi).call(this,h.offsetX,h.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ft=new WeakSet,ve=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Lt._l10nPromise.get("editor_ink_canvas_aria_label").then(h=>{var X;return(X=this.canvas)==null?void 0:X.setAttribute("aria-label",h)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},At=new WeakSet,Se=function(){rt(this,P,new ResizeObserver(h=>{const X=h[0].contentRect;X.width&&X.height&&this.setDimensions(X.width,X.height)})),t(this,P).observe(this.div)},Ht=new WeakSet,ce=function(){if(!t(this,E))return;const[h,X]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*h),this.canvas.height=Math.ceil(this.height*X),Q(this,st,Ee).call(this)},Nt=new WeakSet,Ke=function(h,X){const ut=Q(this,q,Ce).call(this),ot=(h-ut)/t(this,R),u=(X-ut)/t(this,j);this.scaleFactor=Math.min(ot,u)},st=new WeakSet,Ee=function(){const h=Q(this,q,Ce).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+h,this.translationY*this.scaleFactor+h)},gt=new WeakSet,Mi=function(h){const X=new Path2D;for(let ut=0,ot=h.length;ut<ot;ut++){const[u,a,C,S]=h[ut];ut===0&&X.moveTo(...u),X.bezierCurveTo(a[0],a[1],C[0],C[1],S[0],S[1])}return X},Ft=new WeakSet,Je=function(h,X,ut){const[ot,u,a,C]=X;switch(ut){case 0:for(let S=0,U=h.length;S<U;S+=2)h[S]+=ot,h[S+1]=C-h[S+1];break;case 90:for(let S=0,U=h.length;S<U;S+=2){const Z=h[S];h[S]=h[S+1]+ot,h[S+1]=Z+u}break;case 180:for(let S=0,U=h.length;S<U;S+=2)h[S]=a-h[S],h[S+1]+=u;break;case 270:for(let S=0,U=h.length;S<U;S+=2){const Z=h[S];h[S]=a-h[S+1],h[S+1]=C-Z}break;default:throw new Error("Invalid rotation")}return h},zt=new WeakSet,Di=function(h,X,ut){const[ot,u,a,C]=X;switch(ut){case 0:for(let S=0,U=h.length;S<U;S+=2)h[S]-=ot,h[S+1]=C-h[S+1];break;case 90:for(let S=0,U=h.length;S<U;S+=2){const Z=h[S];h[S]=h[S+1]-u,h[S+1]=Z-ot}break;case 180:for(let S=0,U=h.length;S<U;S+=2)h[S]=a-h[S],h[S+1]-=u;break;case 270:for(let S=0,U=h.length;S<U;S+=2){const Z=h[S];h[S]=C-h[S+1],h[S+1]=a-Z}break;default:throw new Error("Invalid rotation")}return h},Xt=new WeakSet,Ii=function(h,X,ut,ot){var U,Z;const u=[],a=this.thickness/2,C=h*X+a,S=h*ut+a;for(const mt of this.paths){const Pt=[],kt=[];for(let Et=0,Ot=mt.length;Et<Ot;Et++){const[Tt,xt,Dt,Bt]=mt[Et],Gt=h*Tt[0]+C,Vt=h*Tt[1]+S,Jt=h*xt[0]+C,qt=h*xt[1]+S,Qt=h*Dt[0]+C,te=h*Dt[1]+S,Zt=h*Bt[0]+C,ne=h*Bt[1]+S;Et===0&&(Pt.push(Gt,Vt),kt.push(Gt,Vt)),Pt.push(Jt,qt,Qt,te,Zt,ne),kt.push(Jt,qt),Et===Ot-1&&kt.push(Zt,ne)}u.push({bezier:Q(U=Lt,Ft,Je).call(U,Pt,ot,this.rotation),points:Q(Z=Lt,Ft,Je).call(Z,kt,ot,this.rotation)})}return u},Ut=new WeakSet,Qe=function(){let h=1/0,X=-1/0,ut=1/0,ot=-1/0;for(const u of this.paths)for(const[a,C,S,U]of u){const Z=c.Util.bezierBoundingBox(...a,...C,...S,...U);h=Math.min(h,Z[0]),ut=Math.min(ut,Z[1]),X=Math.max(X,Z[2]),ot=Math.max(ot,Z[3])}return[h,ut,X,ot]},q=new WeakSet,Ce=function(){return t(this,f)?Math.ceil(this.thickness*this.parentScale):0},wt=new WeakSet,he=function(h=!1){if(this.isEmpty())return;if(!t(this,f)){Q(this,Y,se).call(this);return}const X=Q(this,Ut,Qe).call(this),ut=Q(this,q,Ce).call(this);rt(this,R,Math.max(x.AnnotationEditor.MIN_SIZE,X[2]-X[0])),rt(this,j,Math.max(x.AnnotationEditor.MIN_SIZE,X[3]-X[1]));const ot=Math.ceil(ut+t(this,R)*this.scaleFactor),u=Math.ceil(ut+t(this,j)*this.scaleFactor),[a,C]=this.parentDimensions;this.width=ot/a,this.height=u/C,this.setAspectRatio(ot,u);const S=this.translationX,U=this.translationY;this.translationX=-X[0],this.translationY=-X[1],Q(this,Ht,ce).call(this),Q(this,Y,se).call(this),rt(this,g,ot),rt(this,n,u),this.setDims(ot,u);const Z=h?ut/this.scaleFactor/2:0;this.translate(S-this.translationX-Z,U-this.translationY-Z)},W(lt,gt),W(lt,Ft),W(lt,zt),Yt(lt,"_defaultColor",null),Yt(lt,"_defaultOpacity",1),Yt(lt,"_defaultThickness",1),Yt(lt,"_l10nPromise"),Yt(lt,"_type","ink"),d.InkEditor=lt},(bt,d,nt)=>{var j,R,p,L,B,w,y,A,f,Ze,E,me,g,Oi,o,Li,b,ti,l,we,I,Ni;Object.defineProperty(d,"__esModule",{value:!0}),d.StampEditor=void 0;var c=nt(4),x=nt(1),et=nt(6),J=nt(29);class lt extends c.AnnotationEditor{constructor(G){super({...G,name:"stampEditor"});W(this,f);W(this,E);W(this,g);W(this,o);W(this,b);W(this,l);W(this,I);W(this,j,null);W(this,R,null);W(this,p,null);W(this,L,null);W(this,B,null);W(this,w,null);W(this,y,null);W(this,A,!1);rt(this,L,G.bitmapUrl)}remove(){var G,M;t(this,R)&&(rt(this,j,null),this._uiManager.imageManager.deleteId(t(this,R)),(G=t(this,B))==null||G.remove(),rt(this,B,null),(M=t(this,w))==null||M.disconnect(),rt(this,w,null)),super.remove()}rebuild(){super.rebuild(),this.div!==null&&(t(this,R)&&Q(this,f,Ze).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this.div.draggable=!0,this.parent.addUndoableEditor(this),this.div.focus()}isEmpty(){return t(this,p)===null&&t(this,j)===null&&t(this,L)===null}get isResizable(){return!0}render(){if(this.div)return this.div;let G,M;if(this.width&&(G=this.x,M=this.y),super.render(),t(this,j)?Q(this,E,me).call(this):(this.div.classList.add("loading"),Q(this,f,Ze).call(this)),this.width){const[k,$]=this.parentDimensions;this.setAt(G*k,M*$,this.width*k,this.height*$)}return this.div}static deserialize(G,M,k){if(G instanceof J.StampAnnotationElement)return null;const $=super.deserialize(G,M,k),{rect:it,bitmapUrl:pt,bitmapId:_t,isSvg:D}=G;_t&&k.imageManager.isValidId(_t)?rt($,R,_t):rt($,L,pt),rt($,A,D);const[i,e]=$.pageDimensions;return $.width=(it[2]-it[0])/i,$.height=(it[3]-it[1])/e,$}serialize(G=!1,M=null){if(this.isEmpty())return null;const k={annotationType:x.AnnotationEditorType.STAMP,bitmapId:t(this,R),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,A)};if(G)return k.bitmapUrl=Q(this,l,we).call(this,!0),k;if(M===null)return k;M.stamps||(M.stamps=new Map);const $=t(this,A)?(k.rect[2]-k.rect[0])*(k.rect[3]-k.rect[1]):null;if(!M.stamps.has(t(this,R)))M.stamps.set(t(this,R),{area:$,serialized:k}),k.bitmap=Q(this,l,we).call(this,!1);else if(t(this,A)){const it=M.stamps.get(t(this,R));$>it.area&&(it.area=$,it.serialized.bitmap.close(),it.serialized.bitmap=Q(this,l,we).call(this,!1))}return k}}j=new WeakMap,R=new WeakMap,p=new WeakMap,L=new WeakMap,B=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakMap,f=new WeakSet,Ze=function(){if(t(this,R)){this._uiManager.imageManager.getFromId(t(this,R)).then(M=>{if(!M){this.remove();return}rt(this,j,M.bitmap),Q(this,E,me).call(this)});return}if(t(this,L)){const M=t(this,L);rt(this,L,null),rt(this,p,this._uiManager.imageManager.getFromUrl(M).then(k=>{if(rt(this,p,null),!k){this.remove();return}({bitmap:ie(this,j)._,id:ie(this,R)._,isSvg:ie(this,A)._}=k),Q(this,E,me).call(this)}));return}const G=document.createElement("input");G.type="file",G.accept="image/*",rt(this,p,new Promise(M=>{G.addEventListener("change",async()=>{if(rt(this,p,null),!G.files||G.files.length===0)this.remove();else{const k=await this._uiManager.imageManager.getFromFile(G.files[0]);if(!k){this.remove();return}({bitmap:ie(this,j)._,id:ie(this,R)._,isSvg:ie(this,A)._}=k),Q(this,E,me).call(this)}M()}),G.addEventListener("cancel",()=>{rt(this,p,null),this.remove(),M()})})),G.click()},E=new WeakSet,me=function(){const{div:G}=this;let{width:M,height:k}=t(this,j);const[$,it]=this.pageDimensions,pt=.75;if(this.width)M=this.width*$,k=this.height*it;else if(M>pt*$||k>pt*it){const e=Math.min(pt*$/M,pt*it/k);M*=e,k*=e}const[_t,D]=this.parentDimensions;this.setDims(M*_t/$,k*D/it);const i=rt(this,B,document.createElement("canvas"));G.append(i),Q(this,b,ti).call(this,M,k),Q(this,I,Ni).call(this),G.classList.remove("loading")},g=new WeakSet,Oi=function(G,M){const[k,$]=this.parentDimensions;this.width=G/k,this.height=M/$,this.setDims(G,M),this.fixAndSetPosition(),t(this,y)!==null&&clearTimeout(t(this,y)),rt(this,y,setTimeout(()=>{rt(this,y,null),Q(this,b,ti).call(this,G,M)},200))},o=new WeakSet,Li=function(G,M){const{width:k,height:$}=t(this,j);let it=k,pt=$,_t=t(this,j);for(;it>2*G||pt>2*M;){const D=it,i=pt;it>2*G&&(it=it>=16384?Math.floor(it/2)-1:Math.ceil(it/2)),pt>2*M&&(pt=pt>=16384?Math.floor(pt/2)-1:Math.ceil(pt/2));const e=new OffscreenCanvas(it,pt);e.getContext("2d").drawImage(_t,0,0,D,i,0,0,it,pt),_t=e.transferToImageBitmap()}return _t},b=new WeakSet,ti=function(G,M){const k=t(this,B);if(!k||k.width===G&&k.height===M)return;k.width=G,k.height=M;const $=t(this,A)?t(this,j):Q(this,o,Li).call(this,G,M),it=k.getContext("2d");it.filter=this._uiManager.hcmFilter,it.drawImage($,0,0,$.width,$.height,0,0,G,M)},l=new WeakSet,we=function(G){if(G){if(t(this,A)){const $=this._uiManager.imageManager.getSvgUrl(t(this,R));if($)return $}const M=document.createElement("canvas");return{width:M.width,height:M.height}=t(this,j),M.getContext("2d").drawImage(t(this,j),0,0),M.toDataURL()}if(t(this,A)){const[M,k]=this.pageDimensions,$=Math.round(this.width*M*et.PixelsPerInch.PDF_TO_CSS_UNITS),it=Math.round(this.height*k*et.PixelsPerInch.PDF_TO_CSS_UNITS),pt=new OffscreenCanvas($,it);return pt.getContext("2d").drawImage(t(this,j),0,0,t(this,j).width,t(this,j).height,0,0,$,it),pt.transferToImageBitmap()}return structuredClone(t(this,j))},I=new WeakSet,Ni=function(){rt(this,w,new ResizeObserver(G=>{const M=G[0].contentRect;M.width&&M.height&&Q(this,g,Oi).call(this,M.width,M.height)})),t(this,w).observe(this.div)},Yt(lt,"_type","stamp"),d.StampEditor=lt}],__webpack_module_cache__={};function __w_pdfjs_require__(bt){var d=__webpack_module_cache__[bt];if(d!==void 0)return d.exports;var nt=__webpack_module_cache__[bt]={exports:{}};return __webpack_modules__[bt](nt,nt.exports,__w_pdfjs_require__),nt.exports}var __webpack_exports__={};return(()=>{var bt=__webpack_exports__;Object.defineProperty(bt,"__esModule",{value:!0}),Object.defineProperty(bt,"AbortException",{enumerable:!0,get:function(){return d.AbortException}}),Object.defineProperty(bt,"AnnotationEditorLayer",{enumerable:!0,get:function(){return et.AnnotationEditorLayer}}),Object.defineProperty(bt,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return d.AnnotationEditorParamsType}}),Object.defineProperty(bt,"AnnotationEditorType",{enumerable:!0,get:function(){return d.AnnotationEditorType}}),Object.defineProperty(bt,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return J.AnnotationEditorUIManager}}),Object.defineProperty(bt,"AnnotationLayer",{enumerable:!0,get:function(){return lt.AnnotationLayer}}),Object.defineProperty(bt,"AnnotationMode",{enumerable:!0,get:function(){return d.AnnotationMode}}),Object.defineProperty(bt,"CMapCompressionType",{enumerable:!0,get:function(){return d.CMapCompressionType}}),Object.defineProperty(bt,"FeatureTest",{enumerable:!0,get:function(){return d.FeatureTest}}),Object.defineProperty(bt,"GlobalWorkerOptions",{enumerable:!0,get:function(){return j.GlobalWorkerOptions}}),Object.defineProperty(bt,"ImageKind",{enumerable:!0,get:function(){return d.ImageKind}}),Object.defineProperty(bt,"InvalidPDFException",{enumerable:!0,get:function(){return d.InvalidPDFException}}),Object.defineProperty(bt,"MissingPDFException",{enumerable:!0,get:function(){return d.MissingPDFException}}),Object.defineProperty(bt,"OPS",{enumerable:!0,get:function(){return d.OPS}}),Object.defineProperty(bt,"PDFDataRangeTransport",{enumerable:!0,get:function(){return nt.PDFDataRangeTransport}}),Object.defineProperty(bt,"PDFDateString",{enumerable:!0,get:function(){return c.PDFDateString}}),Object.defineProperty(bt,"PDFWorker",{enumerable:!0,get:function(){return nt.PDFWorker}}),Object.defineProperty(bt,"PasswordResponses",{enumerable:!0,get:function(){return d.PasswordResponses}}),Object.defineProperty(bt,"PermissionFlag",{enumerable:!0,get:function(){return d.PermissionFlag}}),Object.defineProperty(bt,"PixelsPerInch",{enumerable:!0,get:function(){return c.PixelsPerInch}}),Object.defineProperty(bt,"PromiseCapability",{enumerable:!0,get:function(){return d.PromiseCapability}}),Object.defineProperty(bt,"RenderingCancelledException",{enumerable:!0,get:function(){return c.RenderingCancelledException}}),Object.defineProperty(bt,"SVGGraphics",{enumerable:!0,get:function(){return nt.SVGGraphics}}),Object.defineProperty(bt,"UnexpectedResponseException",{enumerable:!0,get:function(){return d.UnexpectedResponseException}}),Object.defineProperty(bt,"Util",{enumerable:!0,get:function(){return d.Util}}),Object.defineProperty(bt,"VerbosityLevel",{enumerable:!0,get:function(){return d.VerbosityLevel}}),Object.defineProperty(bt,"XfaLayer",{enumerable:!0,get:function(){return R.XfaLayer}}),Object.defineProperty(bt,"build",{enumerable:!0,get:function(){return nt.build}}),Object.defineProperty(bt,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return d.createValidAbsoluteUrl}}),Object.defineProperty(bt,"getDocument",{enumerable:!0,get:function(){return nt.getDocument}}),Object.defineProperty(bt,"getFilenameFromUrl",{enumerable:!0,get:function(){return c.getFilenameFromUrl}}),Object.defineProperty(bt,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return c.getPdfFilenameFromUrl}}),Object.defineProperty(bt,"getXfaPageViewport",{enumerable:!0,get:function(){return c.getXfaPageViewport}}),Object.defineProperty(bt,"isDataScheme",{enumerable:!0,get:function(){return c.isDataScheme}}),Object.defineProperty(bt,"isPdfFile",{enumerable:!0,get:function(){return c.isPdfFile}}),Object.defineProperty(bt,"loadScript",{enumerable:!0,get:function(){return c.loadScript}}),Object.defineProperty(bt,"normalizeUnicode",{enumerable:!0,get:function(){return d.normalizeUnicode}}),Object.defineProperty(bt,"renderTextLayer",{enumerable:!0,get:function(){return x.renderTextLayer}}),Object.defineProperty(bt,"setLayerDimensions",{enumerable:!0,get:function(){return c.setLayerDimensions}}),Object.defineProperty(bt,"shadow",{enumerable:!0,get:function(){return d.shadow}}),Object.defineProperty(bt,"updateTextLayer",{enumerable:!0,get:function(){return x.updateTextLayer}}),Object.defineProperty(bt,"version",{enumerable:!0,get:function(){return nt.version}});var d=__w_pdfjs_require__(1),nt=__w_pdfjs_require__(2),c=__w_pdfjs_require__(6),x=__w_pdfjs_require__(26),et=__w_pdfjs_require__(27),J=__w_pdfjs_require__(5),lt=__w_pdfjs_require__(29),j=__w_pdfjs_require__(14),R=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;const pdf_viewer="",_imports_0="/assets/upload-4db6a5e7.svg",Area_vue_vue_type_style_index_0_lang="";pdfExports.GlobalWorkerOptions.workerSrc=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${pdfExports.version}/build/pdf.worker.min.js`;const _sfc_main$1={components:{},props:{},emits:["update:modelValue"],setup(bt,{emit:d}){const nt=useStore(),c=ref(null),x=ref(!1),et=ref(!1),J=async p=>{let L=await pdfExports.getDocument(p).promise,B=L.numPages,w=[];for(let A=1;A<=B;A++){let E=(await(await L.getPage(A)).getTextContent()).items.map(P=>P.str).join(" ");w.push(E)}return w.join(" ")},lt=p=>new Promise(L=>{const B=new window.FileReader;B.readAsDataURL(p),B.onload=async()=>{let w=B.result;const y=await J(w);L(y)}}),j=async p=>{for(let L=0;L<p.target.files.length;L++){et.value=!0;const B=p.target.files[L];let w=await lt(B);const y=Object.assign({},{file_path:B,text:w});nt.dispatch("addtext",y)}et.value=!1,c.value&&(c.value.value=""),x.value=!1},R=computed(()=>{if(nt.getters.lengthTexts>0)return`Вы загрузили ${nt.getters.lengthTexts} резюме`;if(nt.getters.lengthTexts===0)return"Загрузите резюме"});return{isDragStarted:x,uploadText:R,input:c,uploadFile:j,loader:et,count:computed(()=>nt.state.countId),increment:()=>nt.dispatch("increment")}}},_hoisted_1$1={class:"file-uploader"},_hoisted_2={key:0,class:"loader"},_hoisted_3={src:_imports_0,class:"file-uploader__icon",alt:"Загрузите фото"};function _sfc_render$1(bt,d,nt,c,x,et){return openBlock(),createElementBlock("div",_hoisted_1$1,[c.loader?(openBlock(),createElementBlock("div",_hoisted_2)):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["file-uploader__wrapper",{"file-uploader__wrapper--drag":c.isDragStarted}])},[createBaseVNode("input",{accept:"application/pdf",ref:"input",class:"file-uploader__input",type:"file",multiple:"",title:"",onChange:d[0]||(d[0]=(...J)=>c.uploadFile&&c.uploadFile(...J)),onDragenter:d[1]||(d[1]=J=>c.isDragStarted=!0),onDragleave:d[2]||(d[2]=J=>c.isDragStarted=!1)},null,544),createTextVNode(" "+toDisplayString(c.isDragStarted?"":c.uploadText)+" ",1),withDirectives(createBaseVNode("img",_hoisted_3,null,512),[[vShow,c.isDragStarted]])],2)])}const AreaUploader=_export_sfc(_sfc_main$1,[["render",_sfc_render$1]]),FirstPage_vue_vue_type_style_index_0_scoped_b8cef6d1_lang="",_sfc_main={components:{AreaUploader,TableWithStore,ButtonNextPrev,VuePdfEmbed},setup(){const bt="https://raw.githubusercontent.com/mozilla/pdf.js/ba2edeae/examples/learning/helloworld.pdf",d=useStore(),nt=useRouter(),c=()=>{nt.push({name:"second"})},x=et=>{d.dispatch("del_by_id",et)};return{lengthLoadingTexts:computed(()=>!!d.getters.lengthTexts),allTexts:computed(()=>d.getters.getAllTexts),file1:computed(()=>allTexts[0].file_path.type),next_page:c,del_by_id:x,pdfSource:bt}}},_hoisted_1={class:"button_container"};function _sfc_render(bt,d,nt,c,x,et){const J=resolveComponent("AreaUploader"),lt=resolveComponent("TableWithStore"),j=resolveComponent("ButtonNextPrev");return openBlock(),createElementBlock("div",null,[createVNode(J),createVNode(lt,{onDel_by_id:c.del_by_id,onClear_all:d[0]||(d[0]=R=>bt.$store.dispatch("clear")),texts:c.allTexts,show_del_buttons:!0},null,8,["onDel_by_id","texts"]),createBaseVNode("div",_hoisted_1,[createVNode(j,{onClicks:c.next_page,active:c.lengthLoadingTexts,right:!0},{default:withCtx(()=>[createTextVNode(" Шаг №2 ")]),_:1},8,["onClicks","active"])])])}const FirstPage=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-b8cef6d1"]]);export{FirstPage as default};
